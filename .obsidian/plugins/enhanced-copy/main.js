/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin: undefined
*/

"use strict";var __create=Object.create;var __defProp=Object.defineProperty;var __getOwnPropDesc=Object.getOwnPropertyDescriptor;var __getOwnPropNames=Object.getOwnPropertyNames;var __getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty;var __commonJS=(cb,mod)=>function(){return mod||(0,cb[__getOwnPropNames(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports};var __export=(target,all)=>{for(var name in all)__defProp(target,name,{get:all[name],enumerable:!0})},__copyProps=(to,from,except,desc)=>{if(from&&typeof from=="object"||typeof from=="function")for(let key of __getOwnPropNames(from))!__hasOwnProp.call(to,key)&&key!==except&&__defProp(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc(from,key))||desc.enumerable});return to};var __toESM=(mod,isNodeMode,target)=>(target=mod!=null?__create(__getProtoOf(mod)):{},__copyProps(isNodeMode||!mod||!mod.__esModule?__defProp(target,"default",{value:mod,enumerable:!0}):target,mod)),__toCommonJS=mod=>__copyProps(__defProp({},"__esModule",{value:!0}),mod);var require_lib=__commonJS({"node_modules/@enveloppe/obsidian-dataview/lib/index.js"(exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});require("obsidian");var LuxonError=class extends Error{},InvalidDateTimeError=class extends LuxonError{constructor(reason){super(`Invalid DateTime: ${reason.toMessage()}`)}},InvalidIntervalError=class extends LuxonError{constructor(reason){super(`Invalid Interval: ${reason.toMessage()}`)}},InvalidDurationError=class extends LuxonError{constructor(reason){super(`Invalid Duration: ${reason.toMessage()}`)}},ConflictingSpecificationError=class extends LuxonError{},InvalidUnitError=class extends LuxonError{constructor(unit){super(`Invalid unit ${unit}`)}},InvalidArgumentError=class extends LuxonError{},ZoneIsAbstractError=class extends LuxonError{constructor(){super("Zone is an abstract class")}},n="numeric",s="short",l="long",DATE_SHORT={year:n,month:n,day:n},DATE_MED={year:n,month:s,day:n},DATE_MED_WITH_WEEKDAY={year:n,month:s,day:n,weekday:s},DATE_FULL={year:n,month:l,day:n},DATE_HUGE={year:n,month:l,day:n,weekday:l},TIME_SIMPLE={hour:n,minute:n},TIME_WITH_SECONDS={hour:n,minute:n,second:n},TIME_WITH_SHORT_OFFSET={hour:n,minute:n,second:n,timeZoneName:s},TIME_WITH_LONG_OFFSET={hour:n,minute:n,second:n,timeZoneName:l},TIME_24_SIMPLE={hour:n,minute:n,hourCycle:"h23"},TIME_24_WITH_SECONDS={hour:n,minute:n,second:n,hourCycle:"h23"},TIME_24_WITH_SHORT_OFFSET={hour:n,minute:n,second:n,hourCycle:"h23",timeZoneName:s},TIME_24_WITH_LONG_OFFSET={hour:n,minute:n,second:n,hourCycle:"h23",timeZoneName:l},DATETIME_SHORT={year:n,month:n,day:n,hour:n,minute:n},DATETIME_SHORT_WITH_SECONDS={year:n,month:n,day:n,hour:n,minute:n,second:n},DATETIME_MED={year:n,month:s,day:n,hour:n,minute:n},DATETIME_MED_WITH_SECONDS={year:n,month:s,day:n,hour:n,minute:n,second:n},DATETIME_MED_WITH_WEEKDAY={year:n,month:s,day:n,weekday:s,hour:n,minute:n},DATETIME_FULL={year:n,month:l,day:n,hour:n,minute:n,timeZoneName:s},DATETIME_FULL_WITH_SECONDS={year:n,month:l,day:n,hour:n,minute:n,second:n,timeZoneName:s},DATETIME_HUGE={year:n,month:l,day:n,weekday:l,hour:n,minute:n,timeZoneName:l},DATETIME_HUGE_WITH_SECONDS={year:n,month:l,day:n,weekday:l,hour:n,minute:n,second:n,timeZoneName:l},Zone=class{get type(){throw new ZoneIsAbstractError}get name(){throw new ZoneIsAbstractError}get ianaName(){return this.name}get isUniversal(){throw new ZoneIsAbstractError}offsetName(ts,opts){throw new ZoneIsAbstractError}formatOffset(ts,format){throw new ZoneIsAbstractError}offset(ts){throw new ZoneIsAbstractError}equals(otherZone){throw new ZoneIsAbstractError}get isValid(){throw new ZoneIsAbstractError}},singleton$1=null,SystemZone=class _SystemZone extends Zone{static get instance(){return singleton$1===null&&(singleton$1=new _SystemZone),singleton$1}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(ts,{format,locale}){return parseZoneInfo(ts,format,locale)}formatOffset(ts,format){return formatOffset(this.offset(ts),format)}offset(ts){return-new Date(ts).getTimezoneOffset()}equals(otherZone){return otherZone.type==="system"}get isValid(){return!0}},dtfCache={};function makeDTF(zone){return dtfCache[zone]||(dtfCache[zone]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:zone,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),dtfCache[zone]}var typeToPos={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function hackyOffset(dtf,date){let formatted=dtf.format(date).replace(/\u200E/g,""),parsed=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(formatted),[,fMonth,fDay,fYear,fadOrBc,fHour,fMinute,fSecond]=parsed;return[fYear,fMonth,fDay,fadOrBc,fHour,fMinute,fSecond]}function partsOffset(dtf,date){let formatted=dtf.formatToParts(date),filled=[];for(let i=0;i<formatted.length;i++){let{type,value}=formatted[i],pos=typeToPos[type];type==="era"?filled[pos]=value:isUndefined(pos)||(filled[pos]=parseInt(value,10))}return filled}var ianaZoneCache={},IANAZone=class _IANAZone extends Zone{static create(name){return ianaZoneCache[name]||(ianaZoneCache[name]=new _IANAZone(name)),ianaZoneCache[name]}static resetCache(){ianaZoneCache={},dtfCache={}}static isValidSpecifier(s2){return this.isValidZone(s2)}static isValidZone(zone){if(!zone)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:zone}).format(),!0}catch{return!1}}constructor(name){super(),this.zoneName=name,this.valid=_IANAZone.isValidZone(name)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(ts,{format,locale}){return parseZoneInfo(ts,format,locale,this.name)}formatOffset(ts,format){return formatOffset(this.offset(ts),format)}offset(ts){let date=new Date(ts);if(isNaN(date))return NaN;let dtf=makeDTF(this.name),[year,month,day,adOrBc,hour,minute,second]=dtf.formatToParts?partsOffset(dtf,date):hackyOffset(dtf,date);adOrBc==="BC"&&(year=-Math.abs(year)+1);let asUTC=objToLocalTS({year,month,day,hour:hour===24?0:hour,minute,second,millisecond:0}),asTS=+date,over=asTS%1e3;return asTS-=over>=0?over:1e3+over,(asUTC-asTS)/(60*1e3)}equals(otherZone){return otherZone.type==="iana"&&otherZone.name===this.name}get isValid(){return this.valid}},intlLFCache={};function getCachedLF(locString,opts={}){let key=JSON.stringify([locString,opts]),dtf=intlLFCache[key];return dtf||(dtf=new Intl.ListFormat(locString,opts),intlLFCache[key]=dtf),dtf}var intlDTCache={};function getCachedDTF(locString,opts={}){let key=JSON.stringify([locString,opts]),dtf=intlDTCache[key];return dtf||(dtf=new Intl.DateTimeFormat(locString,opts),intlDTCache[key]=dtf),dtf}var intlNumCache={};function getCachedINF(locString,opts={}){let key=JSON.stringify([locString,opts]),inf=intlNumCache[key];return inf||(inf=new Intl.NumberFormat(locString,opts),intlNumCache[key]=inf),inf}var intlRelCache={};function getCachedRTF(locString,opts={}){let{base,...cacheKeyOpts}=opts,key=JSON.stringify([locString,cacheKeyOpts]),inf=intlRelCache[key];return inf||(inf=new Intl.RelativeTimeFormat(locString,opts),intlRelCache[key]=inf),inf}var sysLocaleCache=null;function systemLocale(){return sysLocaleCache||(sysLocaleCache=new Intl.DateTimeFormat().resolvedOptions().locale,sysLocaleCache)}function parseLocaleString(localeStr){let xIndex=localeStr.indexOf("-x-");xIndex!==-1&&(localeStr=localeStr.substring(0,xIndex));let uIndex=localeStr.indexOf("-u-");if(uIndex===-1)return[localeStr];{let options,selectedStr;try{options=getCachedDTF(localeStr).resolvedOptions(),selectedStr=localeStr}catch{let smaller=localeStr.substring(0,uIndex);options=getCachedDTF(smaller).resolvedOptions(),selectedStr=smaller}let{numberingSystem,calendar}=options;return[selectedStr,numberingSystem,calendar]}}function intlConfigString(localeStr,numberingSystem,outputCalendar){return(outputCalendar||numberingSystem)&&(localeStr.includes("-u-")||(localeStr+="-u"),outputCalendar&&(localeStr+=`-ca-${outputCalendar}`),numberingSystem&&(localeStr+=`-nu-${numberingSystem}`)),localeStr}function mapMonths(f){let ms=[];for(let i=1;i<=12;i++){let dt=DateTime.utc(2009,i,1);ms.push(f(dt))}return ms}function mapWeekdays(f){let ms=[];for(let i=1;i<=7;i++){let dt=DateTime.utc(2016,11,13+i);ms.push(f(dt))}return ms}function listStuff(loc,length,englishFn,intlFn){let mode=loc.listingMode();return mode==="error"?null:mode==="en"?englishFn(length):intlFn(length)}function supportsFastNumbers(loc){return loc.numberingSystem&&loc.numberingSystem!=="latn"?!1:loc.numberingSystem==="latn"||!loc.locale||loc.locale.startsWith("en")||new Intl.DateTimeFormat(loc.intl).resolvedOptions().numberingSystem==="latn"}var PolyNumberFormatter=class{constructor(intl,forceSimple,opts){this.padTo=opts.padTo||0,this.floor=opts.floor||!1;let{padTo,floor,...otherOpts}=opts;if(!forceSimple||Object.keys(otherOpts).length>0){let intlOpts={useGrouping:!1,...opts};opts.padTo>0&&(intlOpts.minimumIntegerDigits=opts.padTo),this.inf=getCachedINF(intl,intlOpts)}}format(i){if(this.inf){let fixed=this.floor?Math.floor(i):i;return this.inf.format(fixed)}else{let fixed=this.floor?Math.floor(i):roundTo(i,3);return padStart(fixed,this.padTo)}}},PolyDateFormatter=class{constructor(dt,intl,opts){this.opts=opts,this.originalZone=void 0;let z;if(this.opts.timeZone)this.dt=dt;else if(dt.zone.type==="fixed"){let gmtOffset=-1*(dt.offset/60),offsetZ=gmtOffset>=0?`Etc/GMT+${gmtOffset}`:`Etc/GMT${gmtOffset}`;dt.offset!==0&&IANAZone.create(offsetZ).valid?(z=offsetZ,this.dt=dt):(z="UTC",this.dt=dt.offset===0?dt:dt.setZone("UTC").plus({minutes:dt.offset}),this.originalZone=dt.zone)}else dt.zone.type==="system"?this.dt=dt:dt.zone.type==="iana"?(this.dt=dt,z=dt.zone.name):(z="UTC",this.dt=dt.setZone("UTC").plus({minutes:dt.offset}),this.originalZone=dt.zone);let intlOpts={...this.opts};intlOpts.timeZone=intlOpts.timeZone||z,this.dtf=getCachedDTF(intl,intlOpts)}format(){return this.originalZone?this.formatToParts().map(({value})=>value).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){let parts=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?parts.map(part=>{if(part.type==="timeZoneName"){let offsetName=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...part,value:offsetName}}else return part}):parts}resolvedOptions(){return this.dtf.resolvedOptions()}},PolyRelFormatter=class{constructor(intl,isEnglish,opts){this.opts={style:"long",...opts},!isEnglish&&hasRelative()&&(this.rtf=getCachedRTF(intl,opts))}format(count,unit){return this.rtf?this.rtf.format(count,unit):formatRelativeTime(unit,count,this.opts.numeric,this.opts.style!=="long")}formatToParts(count,unit){return this.rtf?this.rtf.formatToParts(count,unit):[]}},Locale=class _Locale{static fromOpts(opts){return _Locale.create(opts.locale,opts.numberingSystem,opts.outputCalendar,opts.defaultToEN)}static create(locale,numberingSystem,outputCalendar,defaultToEN=!1){let specifiedLocale=locale||Settings.defaultLocale,localeR=specifiedLocale||(defaultToEN?"en-US":systemLocale()),numberingSystemR=numberingSystem||Settings.defaultNumberingSystem,outputCalendarR=outputCalendar||Settings.defaultOutputCalendar;return new _Locale(localeR,numberingSystemR,outputCalendarR,specifiedLocale)}static resetCache(){sysLocaleCache=null,intlDTCache={},intlNumCache={},intlRelCache={}}static fromObject({locale,numberingSystem,outputCalendar}={}){return _Locale.create(locale,numberingSystem,outputCalendar)}constructor(locale,numbering,outputCalendar,specifiedLocale){let[parsedLocale,parsedNumberingSystem,parsedOutputCalendar]=parseLocaleString(locale);this.locale=parsedLocale,this.numberingSystem=numbering||parsedNumberingSystem||null,this.outputCalendar=outputCalendar||parsedOutputCalendar||null,this.intl=intlConfigString(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=specifiedLocale,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=supportsFastNumbers(this)),this.fastNumbersCached}listingMode(){let isActuallyEn=this.isEnglish(),hasNoWeirdness=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return isActuallyEn&&hasNoWeirdness?"en":"intl"}clone(alts){return!alts||Object.getOwnPropertyNames(alts).length===0?this:_Locale.create(alts.locale||this.specifiedLocale,alts.numberingSystem||this.numberingSystem,alts.outputCalendar||this.outputCalendar,alts.defaultToEN||!1)}redefaultToEN(alts={}){return this.clone({...alts,defaultToEN:!0})}redefaultToSystem(alts={}){return this.clone({...alts,defaultToEN:!1})}months(length,format=!1){return listStuff(this,length,months,()=>{let intl=format?{month:length,day:"numeric"}:{month:length},formatStr=format?"format":"standalone";return this.monthsCache[formatStr][length]||(this.monthsCache[formatStr][length]=mapMonths(dt=>this.extract(dt,intl,"month"))),this.monthsCache[formatStr][length]})}weekdays(length,format=!1){return listStuff(this,length,weekdays,()=>{let intl=format?{weekday:length,year:"numeric",month:"long",day:"numeric"}:{weekday:length},formatStr=format?"format":"standalone";return this.weekdaysCache[formatStr][length]||(this.weekdaysCache[formatStr][length]=mapWeekdays(dt=>this.extract(dt,intl,"weekday"))),this.weekdaysCache[formatStr][length]})}meridiems(){return listStuff(this,void 0,()=>meridiems,()=>{if(!this.meridiemCache){let intl={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[DateTime.utc(2016,11,13,9),DateTime.utc(2016,11,13,19)].map(dt=>this.extract(dt,intl,"dayperiod"))}return this.meridiemCache})}eras(length){return listStuff(this,length,eras,()=>{let intl={era:length};return this.eraCache[length]||(this.eraCache[length]=[DateTime.utc(-40,1,1),DateTime.utc(2017,1,1)].map(dt=>this.extract(dt,intl,"era"))),this.eraCache[length]})}extract(dt,intlOpts,field){let df=this.dtFormatter(dt,intlOpts),results=df.formatToParts(),matching=results.find(m=>m.type.toLowerCase()===field);return matching?matching.value:null}numberFormatter(opts={}){return new PolyNumberFormatter(this.intl,opts.forceSimple||this.fastNumbers,opts)}dtFormatter(dt,intlOpts={}){return new PolyDateFormatter(dt,this.intl,intlOpts)}relFormatter(opts={}){return new PolyRelFormatter(this.intl,this.isEnglish(),opts)}listFormatter(opts={}){return getCachedLF(this.intl,opts)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}equals(other3){return this.locale===other3.locale&&this.numberingSystem===other3.numberingSystem&&this.outputCalendar===other3.outputCalendar}},singleton=null,FixedOffsetZone=class _FixedOffsetZone extends Zone{static get utcInstance(){return singleton===null&&(singleton=new _FixedOffsetZone(0)),singleton}static instance(offset2){return offset2===0?_FixedOffsetZone.utcInstance:new _FixedOffsetZone(offset2)}static parseSpecifier(s2){if(s2){let r=s2.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(r)return new _FixedOffsetZone(signedOffset(r[1],r[2]))}return null}constructor(offset2){super(),this.fixed=offset2}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${formatOffset(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${formatOffset(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(ts,format){return formatOffset(this.fixed,format)}get isUniversal(){return!0}offset(){return this.fixed}equals(otherZone){return otherZone.type==="fixed"&&otherZone.fixed===this.fixed}get isValid(){return!0}},InvalidZone=class extends Zone{constructor(zoneName){super(),this.zoneName=zoneName}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}};function normalizeZone(input,defaultZone2){if(isUndefined(input)||input===null)return defaultZone2;if(input instanceof Zone)return input;if(isString2(input)){let lowered=input.toLowerCase();return lowered==="default"?defaultZone2:lowered==="local"||lowered==="system"?SystemZone.instance:lowered==="utc"||lowered==="gmt"?FixedOffsetZone.utcInstance:FixedOffsetZone.parseSpecifier(lowered)||IANAZone.create(input)}else return isNumber(input)?FixedOffsetZone.instance(input):typeof input=="object"&&"offset"in input&&typeof input.offset=="function"?input:new InvalidZone(input)}var now=()=>Date.now(),defaultZone="system",defaultLocale=null,defaultNumberingSystem=null,defaultOutputCalendar=null,twoDigitCutoffYear=60,throwOnInvalid,Settings=class{static get now(){return now}static set now(n2){now=n2}static set defaultZone(zone){defaultZone=zone}static get defaultZone(){return normalizeZone(defaultZone,SystemZone.instance)}static get defaultLocale(){return defaultLocale}static set defaultLocale(locale){defaultLocale=locale}static get defaultNumberingSystem(){return defaultNumberingSystem}static set defaultNumberingSystem(numberingSystem){defaultNumberingSystem=numberingSystem}static get defaultOutputCalendar(){return defaultOutputCalendar}static set defaultOutputCalendar(outputCalendar){defaultOutputCalendar=outputCalendar}static get twoDigitCutoffYear(){return twoDigitCutoffYear}static set twoDigitCutoffYear(cutoffYear){twoDigitCutoffYear=cutoffYear%100}static get throwOnInvalid(){return throwOnInvalid}static set throwOnInvalid(t2){throwOnInvalid=t2}static resetCaches(){Locale.resetCache(),IANAZone.resetCache()}};function isUndefined(o){return typeof o>"u"}function isNumber(o){return typeof o=="number"}function isInteger(o){return typeof o=="number"&&o%1===0}function isString2(o){return typeof o=="string"}function isDate(o){return Object.prototype.toString.call(o)==="[object Date]"}function hasRelative(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function maybeArray(thing){return Array.isArray(thing)?thing:[thing]}function bestBy(arr,by,compare){if(arr.length!==0)return arr.reduce((best,next)=>{let pair=[by(next),next];return best&&compare(best[0],pair[0])===best[0]?best:pair},null)[1]}function pick(obj,keys){return keys.reduce((a,k)=>(a[k]=obj[k],a),{})}function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}function integerBetween(thing,bottom,top){return isInteger(thing)&&thing>=bottom&&thing<=top}function floorMod(x,n2){return x-n2*Math.floor(x/n2)}function padStart(input,n2=2){let isNeg=input<0,padded;return isNeg?padded="-"+(""+-input).padStart(n2,"0"):padded=(""+input).padStart(n2,"0"),padded}function parseInteger(string){if(!(isUndefined(string)||string===null||string===""))return parseInt(string,10)}function parseFloating(string){if(!(isUndefined(string)||string===null||string===""))return parseFloat(string)}function parseMillis(fraction){if(!(isUndefined(fraction)||fraction===null||fraction==="")){let f=parseFloat("0."+fraction)*1e3;return Math.floor(f)}}function roundTo(number,digits,towardZero=!1){let factor=10**digits;return(towardZero?Math.trunc:Math.round)(number*factor)/factor}function isLeapYear(year){return year%4===0&&(year%100!==0||year%400===0)}function daysInYear(year){return isLeapYear(year)?366:365}function daysInMonth(year,month){let modMonth=floorMod(month-1,12)+1,modYear=year+(month-modMonth)/12;return modMonth===2?isLeapYear(modYear)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][modMonth-1]}function objToLocalTS(obj){let d=Date.UTC(obj.year,obj.month-1,obj.day,obj.hour,obj.minute,obj.second,obj.millisecond);return obj.year<100&&obj.year>=0&&(d=new Date(d),d.setUTCFullYear(obj.year,obj.month-1,obj.day)),+d}function weeksInWeekYear(weekYear){let p1=(weekYear+Math.floor(weekYear/4)-Math.floor(weekYear/100)+Math.floor(weekYear/400))%7,last=weekYear-1,p2=(last+Math.floor(last/4)-Math.floor(last/100)+Math.floor(last/400))%7;return p1===4||p2===3?53:52}function untruncateYear(year){return year>99?year:year>Settings.twoDigitCutoffYear?1900+year:2e3+year}function parseZoneInfo(ts,offsetFormat,locale,timeZone=null){let date=new Date(ts),intlOpts={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};timeZone&&(intlOpts.timeZone=timeZone);let modified={timeZoneName:offsetFormat,...intlOpts},parsed=new Intl.DateTimeFormat(locale,modified).formatToParts(date).find(m=>m.type.toLowerCase()==="timezonename");return parsed?parsed.value:null}function signedOffset(offHourStr,offMinuteStr){let offHour=parseInt(offHourStr,10);Number.isNaN(offHour)&&(offHour=0);let offMin=parseInt(offMinuteStr,10)||0,offMinSigned=offHour<0||Object.is(offHour,-0)?-offMin:offMin;return offHour*60+offMinSigned}function asNumber(value){let numericValue=Number(value);if(typeof value=="boolean"||value===""||Number.isNaN(numericValue))throw new InvalidArgumentError(`Invalid unit value ${value}`);return numericValue}function normalizeObject(obj,normalizer){let normalized={};for(let u in obj)if(hasOwnProperty(obj,u)){let v=obj[u];if(v==null)continue;normalized[normalizer(u)]=asNumber(v)}return normalized}function formatOffset(offset2,format){let hours=Math.trunc(Math.abs(offset2/60)),minutes=Math.trunc(Math.abs(offset2%60)),sign=offset2>=0?"+":"-";switch(format){case"short":return`${sign}${padStart(hours,2)}:${padStart(minutes,2)}`;case"narrow":return`${sign}${hours}${minutes>0?`:${minutes}`:""}`;case"techie":return`${sign}${padStart(hours,2)}${padStart(minutes,2)}`;default:throw new RangeError(`Value format ${format} is out of range for property format`)}}function timeObject(obj){return pick(obj,["hour","minute","second","millisecond"])}var monthsLong=["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],monthsNarrow=["J","F","M","A","M","J","J","A","S","O","N","D"];function months(length){switch(length){case"narrow":return[...monthsNarrow];case"short":return[...monthsShort];case"long":return[...monthsLong];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}var weekdaysLong=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],weekdaysShort=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],weekdaysNarrow=["M","T","W","T","F","S","S"];function weekdays(length){switch(length){case"narrow":return[...weekdaysNarrow];case"short":return[...weekdaysShort];case"long":return[...weekdaysLong];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}var meridiems=["AM","PM"],erasLong=["Before Christ","Anno Domini"],erasShort=["BC","AD"],erasNarrow=["B","A"];function eras(length){switch(length){case"narrow":return[...erasNarrow];case"short":return[...erasShort];case"long":return[...erasLong];default:return null}}function meridiemForDateTime(dt){return meridiems[dt.hour<12?0:1]}function weekdayForDateTime(dt,length){return weekdays(length)[dt.weekday-1]}function monthForDateTime(dt,length){return months(length)[dt.month-1]}function eraForDateTime(dt,length){return eras(length)[dt.year<0?0:1]}function formatRelativeTime(unit,count,numeric="always",narrow=!1){let units={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},lastable=["hours","minutes","seconds"].indexOf(unit)===-1;if(numeric==="auto"&&lastable){let isDay=unit==="days";switch(count){case 1:return isDay?"tomorrow":`next ${units[unit][0]}`;case-1:return isDay?"yesterday":`last ${units[unit][0]}`;case 0:return isDay?"today":`this ${units[unit][0]}`}}let isInPast=Object.is(count,-0)||count<0,fmtValue=Math.abs(count),singular=fmtValue===1,lilUnits=units[unit],fmtUnit=narrow?singular?lilUnits[1]:lilUnits[2]||lilUnits[1]:singular?units[unit][0]:unit;return isInPast?`${fmtValue} ${fmtUnit} ago`:`in ${fmtValue} ${fmtUnit}`}function stringifyTokens(splits,tokenToString){let s2="";for(let token of splits)token.literal?s2+=token.val:s2+=tokenToString(token.val);return s2}var macroTokenToFormatOpts={D:DATE_SHORT,DD:DATE_MED,DDD:DATE_FULL,DDDD:DATE_HUGE,t:TIME_SIMPLE,tt:TIME_WITH_SECONDS,ttt:TIME_WITH_SHORT_OFFSET,tttt:TIME_WITH_LONG_OFFSET,T:TIME_24_SIMPLE,TT:TIME_24_WITH_SECONDS,TTT:TIME_24_WITH_SHORT_OFFSET,TTTT:TIME_24_WITH_LONG_OFFSET,f:DATETIME_SHORT,ff:DATETIME_MED,fff:DATETIME_FULL,ffff:DATETIME_HUGE,F:DATETIME_SHORT_WITH_SECONDS,FF:DATETIME_MED_WITH_SECONDS,FFF:DATETIME_FULL_WITH_SECONDS,FFFF:DATETIME_HUGE_WITH_SECONDS},Formatter2=class _Formatter{static create(locale,opts={}){return new _Formatter(locale,opts)}static parseFormat(fmt){let current=null,currentFull="",bracketed=!1,splits=[];for(let i=0;i<fmt.length;i++){let c=fmt.charAt(i);c==="'"?(currentFull.length>0&&splits.push({literal:bracketed||/^\s+$/.test(currentFull),val:currentFull}),current=null,currentFull="",bracketed=!bracketed):bracketed||c===current?currentFull+=c:(currentFull.length>0&&splits.push({literal:/^\s+$/.test(currentFull),val:currentFull}),currentFull=c,current=c)}return currentFull.length>0&&splits.push({literal:bracketed||/^\s+$/.test(currentFull),val:currentFull}),splits}static macroTokenToFormatOpts(token){return macroTokenToFormatOpts[token]}constructor(locale,formatOpts){this.opts=formatOpts,this.loc=locale,this.systemLoc=null}formatWithSystemDefault(dt,opts){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(dt,{...this.opts,...opts}).format()}dtFormatter(dt,opts={}){return this.loc.dtFormatter(dt,{...this.opts,...opts})}formatDateTime(dt,opts){return this.dtFormatter(dt,opts).format()}formatDateTimeParts(dt,opts){return this.dtFormatter(dt,opts).formatToParts()}formatInterval(interval,opts){return this.dtFormatter(interval.start,opts).dtf.formatRange(interval.start.toJSDate(),interval.end.toJSDate())}resolvedOptions(dt,opts){return this.dtFormatter(dt,opts).resolvedOptions()}num(n2,p=0){if(this.opts.forceSimple)return padStart(n2,p);let opts={...this.opts};return p>0&&(opts.padTo=p),this.loc.numberFormatter(opts).format(n2)}formatDateTimeFromString(dt,fmt){let knownEnglish=this.loc.listingMode()==="en",useDateTimeFormatter=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",string=(opts,extract)=>this.loc.extract(dt,opts,extract),formatOffset2=opts=>dt.isOffsetFixed&&dt.offset===0&&opts.allowZ?"Z":dt.isValid?dt.zone.formatOffset(dt.ts,opts.format):"",meridiem=()=>knownEnglish?meridiemForDateTime(dt):string({hour:"numeric",hourCycle:"h12"},"dayperiod"),month=(length,standalone)=>knownEnglish?monthForDateTime(dt,length):string(standalone?{month:length}:{month:length,day:"numeric"},"month"),weekday=(length,standalone)=>knownEnglish?weekdayForDateTime(dt,length):string(standalone?{weekday:length}:{weekday:length,month:"long",day:"numeric"},"weekday"),maybeMacro=token=>{let formatOpts=_Formatter.macroTokenToFormatOpts(token);return formatOpts?this.formatWithSystemDefault(dt,formatOpts):token},era=length=>knownEnglish?eraForDateTime(dt,length):string({era:length},"era"),tokenToString=token=>{switch(token){case"S":return this.num(dt.millisecond);case"u":case"SSS":return this.num(dt.millisecond,3);case"s":return this.num(dt.second);case"ss":return this.num(dt.second,2);case"uu":return this.num(Math.floor(dt.millisecond/10),2);case"uuu":return this.num(Math.floor(dt.millisecond/100));case"m":return this.num(dt.minute);case"mm":return this.num(dt.minute,2);case"h":return this.num(dt.hour%12===0?12:dt.hour%12);case"hh":return this.num(dt.hour%12===0?12:dt.hour%12,2);case"H":return this.num(dt.hour);case"HH":return this.num(dt.hour,2);case"Z":return formatOffset2({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return formatOffset2({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return formatOffset2({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return dt.zone.offsetName(dt.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return dt.zone.offsetName(dt.ts,{format:"long",locale:this.loc.locale});case"z":return dt.zoneName;case"a":return meridiem();case"d":return useDateTimeFormatter?string({day:"numeric"},"day"):this.num(dt.day);case"dd":return useDateTimeFormatter?string({day:"2-digit"},"day"):this.num(dt.day,2);case"c":return this.num(dt.weekday);case"ccc":return weekday("short",!0);case"cccc":return weekday("long",!0);case"ccccc":return weekday("narrow",!0);case"E":return this.num(dt.weekday);case"EEE":return weekday("short",!1);case"EEEE":return weekday("long",!1);case"EEEEE":return weekday("narrow",!1);case"L":return useDateTimeFormatter?string({month:"numeric",day:"numeric"},"month"):this.num(dt.month);case"LL":return useDateTimeFormatter?string({month:"2-digit",day:"numeric"},"month"):this.num(dt.month,2);case"LLL":return month("short",!0);case"LLLL":return month("long",!0);case"LLLLL":return month("narrow",!0);case"M":return useDateTimeFormatter?string({month:"numeric"},"month"):this.num(dt.month);case"MM":return useDateTimeFormatter?string({month:"2-digit"},"month"):this.num(dt.month,2);case"MMM":return month("short",!1);case"MMMM":return month("long",!1);case"MMMMM":return month("narrow",!1);case"y":return useDateTimeFormatter?string({year:"numeric"},"year"):this.num(dt.year);case"yy":return useDateTimeFormatter?string({year:"2-digit"},"year"):this.num(dt.year.toString().slice(-2),2);case"yyyy":return useDateTimeFormatter?string({year:"numeric"},"year"):this.num(dt.year,4);case"yyyyyy":return useDateTimeFormatter?string({year:"numeric"},"year"):this.num(dt.year,6);case"G":return era("short");case"GG":return era("long");case"GGGGG":return era("narrow");case"kk":return this.num(dt.weekYear.toString().slice(-2),2);case"kkkk":return this.num(dt.weekYear,4);case"W":return this.num(dt.weekNumber);case"WW":return this.num(dt.weekNumber,2);case"o":return this.num(dt.ordinal);case"ooo":return this.num(dt.ordinal,3);case"q":return this.num(dt.quarter);case"qq":return this.num(dt.quarter,2);case"X":return this.num(Math.floor(dt.ts/1e3));case"x":return this.num(dt.ts);default:return maybeMacro(token)}};return stringifyTokens(_Formatter.parseFormat(fmt),tokenToString)}formatDurationFromString(dur,fmt){let tokenToField=token=>{switch(token[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},tokenToString=lildur=>token=>{let mapped=tokenToField(token);return mapped?this.num(lildur.get(mapped),token.length):token},tokens=_Formatter.parseFormat(fmt),realTokens=tokens.reduce((found,{literal,val})=>literal?found:found.concat(val),[]),collapsed=dur.shiftTo(...realTokens.map(tokenToField).filter(t2=>t2));return stringifyTokens(tokens,tokenToString(collapsed))}},Invalid=class{constructor(reason,explanation){this.reason=reason,this.explanation=explanation}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}},ianaRegex=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function combineRegexes(...regexes){let full=regexes.reduce((f,r)=>f+r.source,"");return RegExp(`^${full}$`)}function combineExtractors(...extractors){return m=>extractors.reduce(([mergedVals,mergedZone,cursor],ex)=>{let[val,zone,next]=ex(m,cursor);return[{...mergedVals,...val},zone||mergedZone,next]},[{},null,1]).slice(0,2)}function parse(s2,...patterns){if(s2==null)return[null,null];for(let[regex,extractor]of patterns){let m=regex.exec(s2);if(m)return extractor(m)}return[null,null]}function simpleParse(...keys){return(match2,cursor)=>{let ret={},i;for(i=0;i<keys.length;i++)ret[keys[i]]=parseInteger(match2[cursor+i]);return[ret,null,cursor+i]}}var offsetRegex=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,isoExtendedZone=`(?:${offsetRegex.source}?(?:\\[(${ianaRegex.source})\\])?)?`,isoTimeBaseRegex=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,isoTimeRegex=RegExp(`${isoTimeBaseRegex.source}${isoExtendedZone}`),isoTimeExtensionRegex=RegExp(`(?:T${isoTimeRegex.source})?`),isoYmdRegex=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,isoWeekRegex=/(\d{4})-?W(\d\d)(?:-?(\d))?/,isoOrdinalRegex=/(\d{4})-?(\d{3})/,extractISOWeekData=simpleParse("weekYear","weekNumber","weekDay"),extractISOOrdinalData=simpleParse("year","ordinal"),sqlYmdRegex=/(\d{4})-(\d\d)-(\d\d)/,sqlTimeRegex=RegExp(`${isoTimeBaseRegex.source} ?(?:${offsetRegex.source}|(${ianaRegex.source}))?`),sqlTimeExtensionRegex=RegExp(`(?: ${sqlTimeRegex.source})?`);function int(match2,pos,fallback){let m=match2[pos];return isUndefined(m)?fallback:parseInteger(m)}function extractISOYmd(match2,cursor){return[{year:int(match2,cursor),month:int(match2,cursor+1,1),day:int(match2,cursor+2,1)},null,cursor+3]}function extractISOTime(match2,cursor){return[{hours:int(match2,cursor,0),minutes:int(match2,cursor+1,0),seconds:int(match2,cursor+2,0),milliseconds:parseMillis(match2[cursor+3])},null,cursor+4]}function extractISOOffset(match2,cursor){let local=!match2[cursor]&&!match2[cursor+1],fullOffset=signedOffset(match2[cursor+1],match2[cursor+2]),zone=local?null:FixedOffsetZone.instance(fullOffset);return[{},zone,cursor+3]}function extractIANAZone(match2,cursor){let zone=match2[cursor]?IANAZone.create(match2[cursor]):null;return[{},zone,cursor+1]}var isoTimeOnly=RegExp(`^T?${isoTimeBaseRegex.source}$`),isoDuration=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function extractISODuration(match2){let[s2,yearStr,monthStr,weekStr,dayStr,hourStr,minuteStr,secondStr,millisecondsStr]=match2,hasNegativePrefix=s2[0]==="-",negativeSeconds=secondStr&&secondStr[0]==="-",maybeNegate=(num,force=!1)=>num!==void 0&&(force||num&&hasNegativePrefix)?-num:num;return[{years:maybeNegate(parseFloating(yearStr)),months:maybeNegate(parseFloating(monthStr)),weeks:maybeNegate(parseFloating(weekStr)),days:maybeNegate(parseFloating(dayStr)),hours:maybeNegate(parseFloating(hourStr)),minutes:maybeNegate(parseFloating(minuteStr)),seconds:maybeNegate(parseFloating(secondStr),secondStr==="-0"),milliseconds:maybeNegate(parseMillis(millisecondsStr),negativeSeconds)}]}var obsOffsets={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function fromStrings(weekdayStr,yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr){let result={year:yearStr.length===2?untruncateYear(parseInteger(yearStr)):parseInteger(yearStr),month:monthsShort.indexOf(monthStr)+1,day:parseInteger(dayStr),hour:parseInteger(hourStr),minute:parseInteger(minuteStr)};return secondStr&&(result.second=parseInteger(secondStr)),weekdayStr&&(result.weekday=weekdayStr.length>3?weekdaysLong.indexOf(weekdayStr)+1:weekdaysShort.indexOf(weekdayStr)+1),result}var rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function extractRFC2822(match2){let[,weekdayStr,dayStr,monthStr,yearStr,hourStr,minuteStr,secondStr,obsOffset,milOffset,offHourStr,offMinuteStr]=match2,result=fromStrings(weekdayStr,yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr),offset2;return obsOffset?offset2=obsOffsets[obsOffset]:milOffset?offset2=0:offset2=signedOffset(offHourStr,offMinuteStr),[result,new FixedOffsetZone(offset2)]}function preprocessRFC2822(s2){return s2.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}var rfc1123=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,rfc850=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,ascii=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function extractRFC1123Or850(match2){let[,weekdayStr,dayStr,monthStr,yearStr,hourStr,minuteStr,secondStr]=match2;return[fromStrings(weekdayStr,yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr),FixedOffsetZone.utcInstance]}function extractASCII(match2){let[,weekdayStr,monthStr,dayStr,hourStr,minuteStr,secondStr,yearStr]=match2;return[fromStrings(weekdayStr,yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr),FixedOffsetZone.utcInstance]}var isoYmdWithTimeExtensionRegex=combineRegexes(isoYmdRegex,isoTimeExtensionRegex),isoWeekWithTimeExtensionRegex=combineRegexes(isoWeekRegex,isoTimeExtensionRegex),isoOrdinalWithTimeExtensionRegex=combineRegexes(isoOrdinalRegex,isoTimeExtensionRegex),isoTimeCombinedRegex=combineRegexes(isoTimeRegex),extractISOYmdTimeAndOffset=combineExtractors(extractISOYmd,extractISOTime,extractISOOffset,extractIANAZone),extractISOWeekTimeAndOffset=combineExtractors(extractISOWeekData,extractISOTime,extractISOOffset,extractIANAZone),extractISOOrdinalDateAndTime=combineExtractors(extractISOOrdinalData,extractISOTime,extractISOOffset,extractIANAZone),extractISOTimeAndOffset=combineExtractors(extractISOTime,extractISOOffset,extractIANAZone);function parseISODate(s2){return parse(s2,[isoYmdWithTimeExtensionRegex,extractISOYmdTimeAndOffset],[isoWeekWithTimeExtensionRegex,extractISOWeekTimeAndOffset],[isoOrdinalWithTimeExtensionRegex,extractISOOrdinalDateAndTime],[isoTimeCombinedRegex,extractISOTimeAndOffset])}function parseRFC2822Date(s2){return parse(preprocessRFC2822(s2),[rfc2822,extractRFC2822])}function parseHTTPDate(s2){return parse(s2,[rfc1123,extractRFC1123Or850],[rfc850,extractRFC1123Or850],[ascii,extractASCII])}function parseISODuration(s2){return parse(s2,[isoDuration,extractISODuration])}var extractISOTimeOnly=combineExtractors(extractISOTime);function parseISOTimeOnly(s2){return parse(s2,[isoTimeOnly,extractISOTimeOnly])}var sqlYmdWithTimeExtensionRegex=combineRegexes(sqlYmdRegex,sqlTimeExtensionRegex),sqlTimeCombinedRegex=combineRegexes(sqlTimeRegex),extractISOTimeOffsetAndIANAZone=combineExtractors(extractISOTime,extractISOOffset,extractIANAZone);function parseSQL(s2){return parse(s2,[sqlYmdWithTimeExtensionRegex,extractISOYmdTimeAndOffset],[sqlTimeCombinedRegex,extractISOTimeOffsetAndIANAZone])}var INVALID$2="Invalid Duration",lowOrderMatrix={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},casualMatrix={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3},...lowOrderMatrix},daysInYearAccurate=146097/400,daysInMonthAccurate=146097/4800,accurateMatrix={years:{quarters:4,months:12,weeks:daysInYearAccurate/7,days:daysInYearAccurate,hours:daysInYearAccurate*24,minutes:daysInYearAccurate*24*60,seconds:daysInYearAccurate*24*60*60,milliseconds:daysInYearAccurate*24*60*60*1e3},quarters:{months:3,weeks:daysInYearAccurate/28,days:daysInYearAccurate/4,hours:daysInYearAccurate*24/4,minutes:daysInYearAccurate*24*60/4,seconds:daysInYearAccurate*24*60*60/4,milliseconds:daysInYearAccurate*24*60*60*1e3/4},months:{weeks:daysInMonthAccurate/7,days:daysInMonthAccurate,hours:daysInMonthAccurate*24,minutes:daysInMonthAccurate*24*60,seconds:daysInMonthAccurate*24*60*60,milliseconds:daysInMonthAccurate*24*60*60*1e3},...lowOrderMatrix},orderedUnits$1=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],reverseUnits=orderedUnits$1.slice(0).reverse();function clone$1(dur,alts,clear=!1){let conf={values:clear?alts.values:{...dur.values,...alts.values||{}},loc:dur.loc.clone(alts.loc),conversionAccuracy:alts.conversionAccuracy||dur.conversionAccuracy,matrix:alts.matrix||dur.matrix};return new Duration(conf)}function durationToMillis(matrix,vals){let sum=vals.milliseconds??0;for(let unit of reverseUnits.slice(1))vals[unit]&&(sum+=vals[unit]*matrix[unit].milliseconds);return sum}function normalizeValues(matrix,vals){let factor=durationToMillis(matrix,vals)<0?-1:1;orderedUnits$1.reduceRight((previous,current)=>{if(isUndefined(vals[current]))return previous;if(previous){let previousVal=vals[previous]*factor,conv=matrix[current][previous],rollUp=Math.floor(previousVal/conv);vals[current]+=rollUp*factor,vals[previous]-=rollUp*conv*factor}return current},null),orderedUnits$1.reduce((previous,current)=>{if(isUndefined(vals[current]))return previous;if(previous){let fraction=vals[previous]%1;vals[previous]-=fraction,vals[current]+=fraction*matrix[previous][current]}return current},null)}function removeZeroes(vals){let newVals={};for(let[key,value]of Object.entries(vals))value!==0&&(newVals[key]=value);return newVals}var Duration=class _Duration{constructor(config){let accurate=config.conversionAccuracy==="longterm"||!1,matrix=accurate?accurateMatrix:casualMatrix;config.matrix&&(matrix=config.matrix),this.values=config.values,this.loc=config.loc||Locale.create(),this.conversionAccuracy=accurate?"longterm":"casual",this.invalid=config.invalid||null,this.matrix=matrix,this.isLuxonDuration=!0}static fromMillis(count,opts){return _Duration.fromObject({milliseconds:count},opts)}static fromObject(obj,opts={}){if(obj==null||typeof obj!="object")throw new InvalidArgumentError(`Duration.fromObject: argument expected to be an object, got ${obj===null?"null":typeof obj}`);return new _Duration({values:normalizeObject(obj,_Duration.normalizeUnit),loc:Locale.fromObject(opts),conversionAccuracy:opts.conversionAccuracy,matrix:opts.matrix})}static fromDurationLike(durationLike){if(isNumber(durationLike))return _Duration.fromMillis(durationLike);if(_Duration.isDuration(durationLike))return durationLike;if(typeof durationLike=="object")return _Duration.fromObject(durationLike);throw new InvalidArgumentError(`Unknown duration argument ${durationLike} of type ${typeof durationLike}`)}static fromISO(text,opts){let[parsed]=parseISODuration(text);return parsed?_Duration.fromObject(parsed,opts):_Duration.invalid("unparsable",`the input "${text}" can't be parsed as ISO 8601`)}static fromISOTime(text,opts){let[parsed]=parseISOTimeOnly(text);return parsed?_Duration.fromObject(parsed,opts):_Duration.invalid("unparsable",`the input "${text}" can't be parsed as ISO 8601`)}static invalid(reason,explanation=null){if(!reason)throw new InvalidArgumentError("need to specify a reason the Duration is invalid");let invalid=reason instanceof Invalid?reason:new Invalid(reason,explanation);if(Settings.throwOnInvalid)throw new InvalidDurationError(invalid);return new _Duration({invalid})}static normalizeUnit(unit){let normalized={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[unit&&unit.toLowerCase()];if(!normalized)throw new InvalidUnitError(unit);return normalized}static isDuration(o){return o&&o.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(fmt,opts={}){let fmtOpts={...opts,floor:opts.round!==!1&&opts.floor!==!1};return this.isValid?Formatter2.create(this.loc,fmtOpts).formatDurationFromString(this,fmt):INVALID$2}toHuman(opts={}){if(!this.isValid)return INVALID$2;let l2=orderedUnits$1.map(unit=>{let val=this.values[unit];return isUndefined(val)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...opts,unit:unit.slice(0,-1)}).format(val)}).filter(n2=>n2);return this.loc.listFormatter({type:"conjunction",style:opts.listStyle||"narrow",...opts}).format(l2)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let s2="P";return this.years!==0&&(s2+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(s2+=this.months+this.quarters*3+"M"),this.weeks!==0&&(s2+=this.weeks+"W"),this.days!==0&&(s2+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(s2+="T"),this.hours!==0&&(s2+=this.hours+"H"),this.minutes!==0&&(s2+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(s2+=roundTo(this.seconds+this.milliseconds/1e3,3)+"S"),s2==="P"&&(s2+="T0S"),s2}toISOTime(opts={}){if(!this.isValid)return null;let millis=this.toMillis();return millis<0||millis>=864e5?null:(opts={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...opts,includeOffset:!1},DateTime.fromMillis(millis,{zone:"UTC"}).toISOTime(opts))}toJSON(){return this.toISO()}toString(){return this.toISO()}toMillis(){return this.isValid?durationToMillis(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(duration){if(!this.isValid)return this;let dur=_Duration.fromDurationLike(duration),result={};for(let k of orderedUnits$1)(hasOwnProperty(dur.values,k)||hasOwnProperty(this.values,k))&&(result[k]=dur.get(k)+this.get(k));return clone$1(this,{values:result},!0)}minus(duration){if(!this.isValid)return this;let dur=_Duration.fromDurationLike(duration);return this.plus(dur.negate())}mapUnits(fn){if(!this.isValid)return this;let result={};for(let k of Object.keys(this.values))result[k]=asNumber(fn(this.values[k],k));return clone$1(this,{values:result},!0)}get(unit){return this[_Duration.normalizeUnit(unit)]}set(values){if(!this.isValid)return this;let mixed={...this.values,...normalizeObject(values,_Duration.normalizeUnit)};return clone$1(this,{values:mixed})}reconfigure({locale,numberingSystem,conversionAccuracy,matrix}={}){let opts={loc:this.loc.clone({locale,numberingSystem}),matrix,conversionAccuracy};return clone$1(this,opts)}as(unit){return this.isValid?this.shiftTo(unit).get(unit):NaN}normalize(){if(!this.isValid)return this;let vals=this.toObject();return normalizeValues(this.matrix,vals),clone$1(this,{values:vals},!0)}rescale(){if(!this.isValid)return this;let vals=removeZeroes(this.normalize().shiftToAll().toObject());return clone$1(this,{values:vals},!0)}shiftTo(...units){if(!this.isValid)return this;if(units.length===0)return this;units=units.map(u=>_Duration.normalizeUnit(u));let built={},accumulated={},vals=this.toObject(),lastUnit;for(let k of orderedUnits$1)if(units.indexOf(k)>=0){lastUnit=k;let own=0;for(let ak in accumulated)own+=this.matrix[ak][k]*accumulated[ak],accumulated[ak]=0;isNumber(vals[k])&&(own+=vals[k]);let i=Math.trunc(own);built[k]=i,accumulated[k]=(own*1e3-i*1e3)/1e3}else isNumber(vals[k])&&(accumulated[k]=vals[k]);for(let key in accumulated)accumulated[key]!==0&&(built[lastUnit]+=key===lastUnit?accumulated[key]:accumulated[key]/this.matrix[lastUnit][key]);return normalizeValues(this.matrix,built),clone$1(this,{values:built},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;let negated={};for(let k of Object.keys(this.values))negated[k]=this.values[k]===0?0:-this.values[k];return clone$1(this,{values:negated},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(other3){if(!this.isValid||!other3.isValid||!this.loc.equals(other3.loc))return!1;function eq(v1,v2){return v1===void 0||v1===0?v2===void 0||v2===0:v1===v2}for(let u of orderedUnits$1)if(!eq(this.values[u],other3.values[u]))return!1;return!0}},INVALID$1="Invalid Interval";function validateStartEnd(start,end){return!start||!start.isValid?Interval.invalid("missing or invalid start"):!end||!end.isValid?Interval.invalid("missing or invalid end"):end<start?Interval.invalid("end before start",`The end of an interval must be after its start, but you had start=${start.toISO()} and end=${end.toISO()}`):null}var Interval=class _Interval{constructor(config){this.s=config.start,this.e=config.end,this.invalid=config.invalid||null,this.isLuxonInterval=!0}static invalid(reason,explanation=null){if(!reason)throw new InvalidArgumentError("need to specify a reason the Interval is invalid");let invalid=reason instanceof Invalid?reason:new Invalid(reason,explanation);if(Settings.throwOnInvalid)throw new InvalidIntervalError(invalid);return new _Interval({invalid})}static fromDateTimes(start,end){let builtStart=friendlyDateTime(start),builtEnd=friendlyDateTime(end),validateError=validateStartEnd(builtStart,builtEnd);return validateError??new _Interval({start:builtStart,end:builtEnd})}static after(start,duration){let dur=Duration.fromDurationLike(duration),dt=friendlyDateTime(start);return _Interval.fromDateTimes(dt,dt.plus(dur))}static before(end,duration){let dur=Duration.fromDurationLike(duration),dt=friendlyDateTime(end);return _Interval.fromDateTimes(dt.minus(dur),dt)}static fromISO(text,opts){let[s2,e]=(text||"").split("/",2);if(s2&&e){let start,startIsValid;try{start=DateTime.fromISO(s2,opts),startIsValid=start.isValid}catch{startIsValid=!1}let end,endIsValid;try{end=DateTime.fromISO(e,opts),endIsValid=end.isValid}catch{endIsValid=!1}if(startIsValid&&endIsValid)return _Interval.fromDateTimes(start,end);if(startIsValid){let dur=Duration.fromISO(e,opts);if(dur.isValid)return _Interval.after(start,dur)}else if(endIsValid){let dur=Duration.fromISO(s2,opts);if(dur.isValid)return _Interval.before(end,dur)}}return _Interval.invalid("unparsable",`the input "${text}" can't be parsed as ISO 8601`)}static isInterval(o){return o&&o.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(unit="milliseconds"){return this.isValid?this.toDuration(unit).get(unit):NaN}count(unit="milliseconds"){if(!this.isValid)return NaN;let start=this.start.startOf(unit),end=this.end.startOf(unit);return Math.floor(end.diff(start,unit).get(unit))+(end.valueOf()!==this.end.valueOf())}hasSame(unit){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,unit):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(dateTime){return this.isValid?this.s>dateTime:!1}isBefore(dateTime){return this.isValid?this.e<=dateTime:!1}contains(dateTime){return this.isValid?this.s<=dateTime&&this.e>dateTime:!1}set({start,end}={}){return this.isValid?_Interval.fromDateTimes(start||this.s,end||this.e):this}splitAt(...dateTimes){if(!this.isValid)return[];let sorted=dateTimes.map(friendlyDateTime).filter(d=>this.contains(d)).sort(),results=[],{s:s2}=this,i=0;for(;s2<this.e;){let added=sorted[i]||this.e,next=+added>+this.e?this.e:added;results.push(_Interval.fromDateTimes(s2,next)),s2=next,i+=1}return results}splitBy(duration){let dur=Duration.fromDurationLike(duration);if(!this.isValid||!dur.isValid||dur.as("milliseconds")===0)return[];let{s:s2}=this,idx=1,next,results=[];for(;s2<this.e;){let added=this.start.plus(dur.mapUnits(x=>x*idx));next=+added>+this.e?this.e:added,results.push(_Interval.fromDateTimes(s2,next)),s2=next,idx+=1}return results}divideEqually(numberOfParts){return this.isValid?this.splitBy(this.length()/numberOfParts).slice(0,numberOfParts):[]}overlaps(other3){return this.e>other3.s&&this.s<other3.e}abutsStart(other3){return this.isValid?+this.e==+other3.s:!1}abutsEnd(other3){return this.isValid?+other3.e==+this.s:!1}engulfs(other3){return this.isValid?this.s<=other3.s&&this.e>=other3.e:!1}equals(other3){return!this.isValid||!other3.isValid?!1:this.s.equals(other3.s)&&this.e.equals(other3.e)}intersection(other3){if(!this.isValid)return this;let s2=this.s>other3.s?this.s:other3.s,e=this.e<other3.e?this.e:other3.e;return s2>=e?null:_Interval.fromDateTimes(s2,e)}union(other3){if(!this.isValid)return this;let s2=this.s<other3.s?this.s:other3.s,e=this.e>other3.e?this.e:other3.e;return _Interval.fromDateTimes(s2,e)}static merge(intervals){let[found,final]=intervals.sort((a,b)=>a.s-b.s).reduce(([sofar,current],item)=>current?current.overlaps(item)||current.abutsStart(item)?[sofar,current.union(item)]:[sofar.concat([current]),item]:[sofar,item],[[],null]);return final&&found.push(final),found}static xor(intervals){let start=null,currentCount=0,results=[],ends=intervals.map(i=>[{time:i.s,type:"s"},{time:i.e,type:"e"}]),flattened=Array.prototype.concat(...ends),arr=flattened.sort((a,b)=>a.time-b.time);for(let i of arr)currentCount+=i.type==="s"?1:-1,currentCount===1?start=i.time:(start&&+start!=+i.time&&results.push(_Interval.fromDateTimes(start,i.time)),start=null);return _Interval.merge(results)}difference(...intervals){return _Interval.xor([this].concat(intervals)).map(i=>this.intersection(i)).filter(i=>i&&!i.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} \u2013 ${this.e.toISO()})`:INVALID$1}toLocaleString(formatOpts=DATE_SHORT,opts={}){return this.isValid?Formatter2.create(this.s.loc.clone(opts),formatOpts).formatInterval(this):INVALID$1}toISO(opts){return this.isValid?`${this.s.toISO(opts)}/${this.e.toISO(opts)}`:INVALID$1}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:INVALID$1}toISOTime(opts){return this.isValid?`${this.s.toISOTime(opts)}/${this.e.toISOTime(opts)}`:INVALID$1}toFormat(dateFormat,{separator=" \u2013 "}={}){return this.isValid?`${this.s.toFormat(dateFormat)}${separator}${this.e.toFormat(dateFormat)}`:INVALID$1}toDuration(unit,opts){return this.isValid?this.e.diff(this.s,unit,opts):Duration.invalid(this.invalidReason)}mapEndpoints(mapFn){return _Interval.fromDateTimes(mapFn(this.s),mapFn(this.e))}},Info=class{static hasDST(zone=Settings.defaultZone){let proto=DateTime.now().setZone(zone).set({month:12});return!zone.isUniversal&&proto.offset!==proto.set({month:6}).offset}static isValidIANAZone(zone){return IANAZone.isValidZone(zone)}static normalizeZone(input){return normalizeZone(input,Settings.defaultZone)}static months(length="long",{locale=null,numberingSystem=null,locObj=null,outputCalendar="gregory"}={}){return(locObj||Locale.create(locale,numberingSystem,outputCalendar)).months(length)}static monthsFormat(length="long",{locale=null,numberingSystem=null,locObj=null,outputCalendar="gregory"}={}){return(locObj||Locale.create(locale,numberingSystem,outputCalendar)).months(length,!0)}static weekdays(length="long",{locale=null,numberingSystem=null,locObj=null}={}){return(locObj||Locale.create(locale,numberingSystem,null)).weekdays(length)}static weekdaysFormat(length="long",{locale=null,numberingSystem=null,locObj=null}={}){return(locObj||Locale.create(locale,numberingSystem,null)).weekdays(length,!0)}static meridiems({locale=null}={}){return Locale.create(locale).meridiems()}static eras(length="short",{locale=null}={}){return Locale.create(locale,null,"gregory").eras(length)}static features(){return{relative:hasRelative()}}};function dayDiff(earlier,later){let utcDayStart=dt=>dt.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),ms=utcDayStart(later)-utcDayStart(earlier);return Math.floor(Duration.fromMillis(ms).as("days"))}function highOrderDiffs(cursor,later,units){let differs=[["years",(a,b)=>b.year-a.year],["quarters",(a,b)=>b.quarter-a.quarter+(b.year-a.year)*4],["months",(a,b)=>b.month-a.month+(b.year-a.year)*12],["weeks",(a,b)=>{let days=dayDiff(a,b);return(days-days%7)/7}],["days",dayDiff]],results={},earlier=cursor,lowestOrder,highWater;for(let[unit,differ]of differs)units.indexOf(unit)>=0&&(lowestOrder=unit,results[unit]=differ(cursor,later),highWater=earlier.plus(results),highWater>later?(results[unit]--,cursor=earlier.plus(results),cursor>later&&(highWater=cursor,results[unit]--,cursor=earlier.plus(results))):cursor=highWater);return[cursor,results,highWater,lowestOrder]}function diff(earlier,later,units,opts){let[cursor,results,highWater,lowestOrder]=highOrderDiffs(earlier,later,units),remainingMillis=later-cursor,lowerOrderUnits=units.filter(u=>["hours","minutes","seconds","milliseconds"].indexOf(u)>=0);lowerOrderUnits.length===0&&(highWater<later&&(highWater=cursor.plus({[lowestOrder]:1})),highWater!==cursor&&(results[lowestOrder]=(results[lowestOrder]||0)+remainingMillis/(highWater-cursor)));let duration=Duration.fromObject(results,opts);return lowerOrderUnits.length>0?Duration.fromMillis(remainingMillis,opts).shiftTo(...lowerOrderUnits).plus(duration):duration}var numberingSystems={arab:"[\u0660-\u0669]",arabext:"[\u06F0-\u06F9]",bali:"[\u1B50-\u1B59]",beng:"[\u09E6-\u09EF]",deva:"[\u0966-\u096F]",fullwide:"[\uFF10-\uFF19]",gujr:"[\u0AE6-\u0AEF]",hanidec:"[\u3007|\u4E00|\u4E8C|\u4E09|\u56DB|\u4E94|\u516D|\u4E03|\u516B|\u4E5D]",khmr:"[\u17E0-\u17E9]",knda:"[\u0CE6-\u0CEF]",laoo:"[\u0ED0-\u0ED9]",limb:"[\u1946-\u194F]",mlym:"[\u0D66-\u0D6F]",mong:"[\u1810-\u1819]",mymr:"[\u1040-\u1049]",orya:"[\u0B66-\u0B6F]",tamldec:"[\u0BE6-\u0BEF]",telu:"[\u0C66-\u0C6F]",thai:"[\u0E50-\u0E59]",tibt:"[\u0F20-\u0F29]",latn:"\\d"},numberingSystemsUTF16={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},hanidecChars=numberingSystems.hanidec.replace(/[\[|\]]/g,"").split("");function parseDigits(str){let value=parseInt(str,10);if(isNaN(value)){value="";for(let i=0;i<str.length;i++){let code=str.charCodeAt(i);if(str[i].search(numberingSystems.hanidec)!==-1)value+=hanidecChars.indexOf(str[i]);else for(let key in numberingSystemsUTF16){let[min,max]=numberingSystemsUTF16[key];code>=min&&code<=max&&(value+=code-min)}}return parseInt(value,10)}else return value}function digitRegex({numberingSystem},append=""){return new RegExp(`${numberingSystems[numberingSystem||"latn"]}${append}`)}var MISSING_FTP="missing Intl.DateTimeFormat.formatToParts support";function intUnit(regex,post=i=>i){return{regex,deser:([s2])=>post(parseDigits(s2))}}var NBSP=String.fromCharCode(160),spaceOrNBSP=`[ ${NBSP}]`,spaceOrNBSPRegExp=new RegExp(spaceOrNBSP,"g");function fixListRegex(s2){return s2.replace(/\./g,"\\.?").replace(spaceOrNBSPRegExp,spaceOrNBSP)}function stripInsensitivities(s2){return s2.replace(/\./g,"").replace(spaceOrNBSPRegExp," ").toLowerCase()}function oneOf(strings,startIndex){return strings===null?null:{regex:RegExp(strings.map(fixListRegex).join("|")),deser:([s2])=>strings.findIndex(i=>stripInsensitivities(s2)===stripInsensitivities(i))+startIndex}}function offset(regex,groups){return{regex,deser:([,h,m])=>signedOffset(h,m),groups}}function simple(regex){return{regex,deser:([s2])=>s2}}function escapeToken(value){return value.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function unitForToken(token,loc){let one=digitRegex(loc),two=digitRegex(loc,"{2}"),three=digitRegex(loc,"{3}"),four=digitRegex(loc,"{4}"),six=digitRegex(loc,"{6}"),oneOrTwo=digitRegex(loc,"{1,2}"),oneToThree=digitRegex(loc,"{1,3}"),oneToSix=digitRegex(loc,"{1,6}"),oneToNine=digitRegex(loc,"{1,9}"),twoToFour=digitRegex(loc,"{2,4}"),fourToSix=digitRegex(loc,"{4,6}"),literal=t2=>({regex:RegExp(escapeToken(t2.val)),deser:([s2])=>s2,literal:!0}),unit=(t2=>{if(token.literal)return literal(t2);switch(t2.val){case"G":return oneOf(loc.eras("short"),0);case"GG":return oneOf(loc.eras("long"),0);case"y":return intUnit(oneToSix);case"yy":return intUnit(twoToFour,untruncateYear);case"yyyy":return intUnit(four);case"yyyyy":return intUnit(fourToSix);case"yyyyyy":return intUnit(six);case"M":return intUnit(oneOrTwo);case"MM":return intUnit(two);case"MMM":return oneOf(loc.months("short",!0),1);case"MMMM":return oneOf(loc.months("long",!0),1);case"L":return intUnit(oneOrTwo);case"LL":return intUnit(two);case"LLL":return oneOf(loc.months("short",!1),1);case"LLLL":return oneOf(loc.months("long",!1),1);case"d":return intUnit(oneOrTwo);case"dd":return intUnit(two);case"o":return intUnit(oneToThree);case"ooo":return intUnit(three);case"HH":return intUnit(two);case"H":return intUnit(oneOrTwo);case"hh":return intUnit(two);case"h":return intUnit(oneOrTwo);case"mm":return intUnit(two);case"m":return intUnit(oneOrTwo);case"q":return intUnit(oneOrTwo);case"qq":return intUnit(two);case"s":return intUnit(oneOrTwo);case"ss":return intUnit(two);case"S":return intUnit(oneToThree);case"SSS":return intUnit(three);case"u":return simple(oneToNine);case"uu":return simple(oneOrTwo);case"uuu":return intUnit(one);case"a":return oneOf(loc.meridiems(),0);case"kkkk":return intUnit(four);case"kk":return intUnit(twoToFour,untruncateYear);case"W":return intUnit(oneOrTwo);case"WW":return intUnit(two);case"E":case"c":return intUnit(one);case"EEE":return oneOf(loc.weekdays("short",!1),1);case"EEEE":return oneOf(loc.weekdays("long",!1),1);case"ccc":return oneOf(loc.weekdays("short",!0),1);case"cccc":return oneOf(loc.weekdays("long",!0),1);case"Z":case"ZZ":return offset(new RegExp(`([+-]${oneOrTwo.source})(?::(${two.source}))?`),2);case"ZZZ":return offset(new RegExp(`([+-]${oneOrTwo.source})(${two.source})?`),2);case"z":return simple(/[a-z_+-/]{1,256}?/i);case" ":return simple(/[^\S\n\r]/);default:return literal(t2)}})(token)||{invalidReason:MISSING_FTP};return unit.token=token,unit}var partTypeStyleToTokenVal={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function tokenForPart(part,formatOpts,resolvedOpts){let{type,value}=part;if(type==="literal"){let isSpace=/^\s+$/.test(value);return{literal:!isSpace,val:isSpace?" ":value}}let style=formatOpts[type],actualType=type;type==="hour"&&(formatOpts.hour12!=null?actualType=formatOpts.hour12?"hour12":"hour24":formatOpts.hourCycle!=null?formatOpts.hourCycle==="h11"||formatOpts.hourCycle==="h12"?actualType="hour12":actualType="hour24":actualType=resolvedOpts.hour12?"hour12":"hour24");let val=partTypeStyleToTokenVal[actualType];if(typeof val=="object"&&(val=val[style]),val)return{literal:!1,val}}function buildRegex(units){return[`^${units.map(u=>u.regex).reduce((f,r)=>`${f}(${r.source})`,"")}$`,units]}function match(input,regex,handlers){let matches=input.match(regex);if(matches){let all={},matchIndex=1;for(let i in handlers)if(hasOwnProperty(handlers,i)){let h=handlers[i],groups=h.groups?h.groups+1:1;!h.literal&&h.token&&(all[h.token.val[0]]=h.deser(matches.slice(matchIndex,matchIndex+groups))),matchIndex+=groups}return[matches,all]}else return[matches,{}]}function dateTimeFromMatches(matches){let toField=token=>{switch(token){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}},zone=null,specificOffset;return isUndefined(matches.z)||(zone=IANAZone.create(matches.z)),isUndefined(matches.Z)||(zone||(zone=new FixedOffsetZone(matches.Z)),specificOffset=matches.Z),isUndefined(matches.q)||(matches.M=(matches.q-1)*3+1),isUndefined(matches.h)||(matches.h<12&&matches.a===1?matches.h+=12:matches.h===12&&matches.a===0&&(matches.h=0)),matches.G===0&&matches.y&&(matches.y=-matches.y),isUndefined(matches.u)||(matches.S=parseMillis(matches.u)),[Object.keys(matches).reduce((r,k)=>{let f=toField(k);return f&&(r[f]=matches[k]),r},{}),zone,specificOffset]}var dummyDateTimeCache=null;function getDummyDateTime(){return dummyDateTimeCache||(dummyDateTimeCache=DateTime.fromMillis(1555555555555)),dummyDateTimeCache}function maybeExpandMacroToken(token,locale){if(token.literal)return token;let formatOpts=Formatter2.macroTokenToFormatOpts(token.val),tokens=formatOptsToTokens(formatOpts,locale);return tokens==null||tokens.includes(void 0)?token:tokens}function expandMacroTokens(tokens,locale){return Array.prototype.concat(...tokens.map(t2=>maybeExpandMacroToken(t2,locale)))}function explainFromTokens(locale,input,format){let tokens=expandMacroTokens(Formatter2.parseFormat(format),locale),units=tokens.map(t2=>unitForToken(t2,locale)),disqualifyingUnit=units.find(t2=>t2.invalidReason);if(disqualifyingUnit)return{input,tokens,invalidReason:disqualifyingUnit.invalidReason};{let[regexString,handlers]=buildRegex(units),regex=RegExp(regexString,"i"),[rawMatches,matches]=match(input,regex,handlers),[result,zone,specificOffset]=matches?dateTimeFromMatches(matches):[null,null,void 0];if(hasOwnProperty(matches,"a")&&hasOwnProperty(matches,"H"))throw new ConflictingSpecificationError("Can't include meridiem when specifying 24-hour format");return{input,tokens,regex,rawMatches,matches,result,zone,specificOffset}}}function parseFromTokens(locale,input,format){let{result,zone,specificOffset,invalidReason}=explainFromTokens(locale,input,format);return[result,zone,specificOffset,invalidReason]}function formatOptsToTokens(formatOpts,locale){if(!formatOpts)return null;let df=Formatter2.create(locale,formatOpts).dtFormatter(getDummyDateTime()),parts=df.formatToParts(),resolvedOpts=df.resolvedOptions();return parts.map(p=>tokenForPart(p,formatOpts,resolvedOpts))}var nonLeapLadder=[0,31,59,90,120,151,181,212,243,273,304,334],leapLadder=[0,31,60,91,121,152,182,213,244,274,305,335];function unitOutOfRange(unit,value){return new Invalid("unit out of range",`you specified ${value} (of type ${typeof value}) as a ${unit}, which is invalid`)}function dayOfWeek(year,month,day){let d=new Date(Date.UTC(year,month-1,day));year<100&&year>=0&&d.setUTCFullYear(d.getUTCFullYear()-1900);let js=d.getUTCDay();return js===0?7:js}function computeOrdinal(year,month,day){return day+(isLeapYear(year)?leapLadder:nonLeapLadder)[month-1]}function uncomputeOrdinal(year,ordinal){let table=isLeapYear(year)?leapLadder:nonLeapLadder,month0=table.findIndex(i=>i<ordinal),day=ordinal-table[month0];return{month:month0+1,day}}function gregorianToWeek(gregObj){let{year,month,day}=gregObj,ordinal=computeOrdinal(year,month,day),weekday=dayOfWeek(year,month,day),weekNumber=Math.floor((ordinal-weekday+10)/7),weekYear;return weekNumber<1?(weekYear=year-1,weekNumber=weeksInWeekYear(weekYear)):weekNumber>weeksInWeekYear(year)?(weekYear=year+1,weekNumber=1):weekYear=year,{weekYear,weekNumber,weekday,...timeObject(gregObj)}}function weekToGregorian(weekData){let{weekYear,weekNumber,weekday}=weekData,weekdayOfJan4=dayOfWeek(weekYear,1,4),yearInDays=daysInYear(weekYear),ordinal=weekNumber*7+weekday-weekdayOfJan4-3,year;ordinal<1?(year=weekYear-1,ordinal+=daysInYear(year)):ordinal>yearInDays?(year=weekYear+1,ordinal-=daysInYear(weekYear)):year=weekYear;let{month,day}=uncomputeOrdinal(year,ordinal);return{year,month,day,...timeObject(weekData)}}function gregorianToOrdinal(gregData){let{year,month,day}=gregData,ordinal=computeOrdinal(year,month,day);return{year,ordinal,...timeObject(gregData)}}function ordinalToGregorian(ordinalData){let{year,ordinal}=ordinalData,{month,day}=uncomputeOrdinal(year,ordinal);return{year,month,day,...timeObject(ordinalData)}}function hasInvalidWeekData(obj){let validYear=isInteger(obj.weekYear),validWeek=integerBetween(obj.weekNumber,1,weeksInWeekYear(obj.weekYear)),validWeekday=integerBetween(obj.weekday,1,7);return validYear?validWeek?validWeekday?!1:unitOutOfRange("weekday",obj.weekday):unitOutOfRange("week",obj.week):unitOutOfRange("weekYear",obj.weekYear)}function hasInvalidOrdinalData(obj){let validYear=isInteger(obj.year),validOrdinal=integerBetween(obj.ordinal,1,daysInYear(obj.year));return validYear?validOrdinal?!1:unitOutOfRange("ordinal",obj.ordinal):unitOutOfRange("year",obj.year)}function hasInvalidGregorianData(obj){let validYear=isInteger(obj.year),validMonth=integerBetween(obj.month,1,12),validDay=integerBetween(obj.day,1,daysInMonth(obj.year,obj.month));return validYear?validMonth?validDay?!1:unitOutOfRange("day",obj.day):unitOutOfRange("month",obj.month):unitOutOfRange("year",obj.year)}function hasInvalidTimeData(obj){let{hour,minute,second,millisecond}=obj,validHour=integerBetween(hour,0,23)||hour===24&&minute===0&&second===0&&millisecond===0,validMinute=integerBetween(minute,0,59),validSecond=integerBetween(second,0,59),validMillisecond=integerBetween(millisecond,0,999);return validHour?validMinute?validSecond?validMillisecond?!1:unitOutOfRange("millisecond",millisecond):unitOutOfRange("second",second):unitOutOfRange("minute",minute):unitOutOfRange("hour",hour)}var INVALID="Invalid DateTime",MAX_DATE=864e13;function unsupportedZone(zone){return new Invalid("unsupported zone",`the zone "${zone.name}" is not supported`)}function possiblyCachedWeekData(dt){return dt.weekData===null&&(dt.weekData=gregorianToWeek(dt.c)),dt.weekData}function clone(inst,alts){let current={ts:inst.ts,zone:inst.zone,c:inst.c,o:inst.o,loc:inst.loc,invalid:inst.invalid};return new DateTime({...current,...alts,old:current})}function fixOffset(localTS,o,tz){let utcGuess=localTS-o*60*1e3,o2=tz.offset(utcGuess);if(o===o2)return[utcGuess,o];utcGuess-=(o2-o)*60*1e3;let o3=tz.offset(utcGuess);return o2===o3?[utcGuess,o2]:[localTS-Math.min(o2,o3)*60*1e3,Math.max(o2,o3)]}function tsToObj(ts,offset2){ts+=offset2*60*1e3;let d=new Date(ts);return{year:d.getUTCFullYear(),month:d.getUTCMonth()+1,day:d.getUTCDate(),hour:d.getUTCHours(),minute:d.getUTCMinutes(),second:d.getUTCSeconds(),millisecond:d.getUTCMilliseconds()}}function objToTS(obj,offset2,zone){return fixOffset(objToLocalTS(obj),offset2,zone)}function adjustTime(inst,dur){let oPre=inst.o,year=inst.c.year+Math.trunc(dur.years),month=inst.c.month+Math.trunc(dur.months)+Math.trunc(dur.quarters)*3,c={...inst.c,year,month,day:Math.min(inst.c.day,daysInMonth(year,month))+Math.trunc(dur.days)+Math.trunc(dur.weeks)*7},millisToAdd=Duration.fromObject({years:dur.years-Math.trunc(dur.years),quarters:dur.quarters-Math.trunc(dur.quarters),months:dur.months-Math.trunc(dur.months),weeks:dur.weeks-Math.trunc(dur.weeks),days:dur.days-Math.trunc(dur.days),hours:dur.hours,minutes:dur.minutes,seconds:dur.seconds,milliseconds:dur.milliseconds}).as("milliseconds"),localTS=objToLocalTS(c),[ts,o]=fixOffset(localTS,oPre,inst.zone);return millisToAdd!==0&&(ts+=millisToAdd,o=inst.zone.offset(ts)),{ts,o}}function parseDataToDateTime(parsed,parsedZone,opts,format,text,specificOffset){let{setZone,zone}=opts;if(parsed&&Object.keys(parsed).length!==0||parsedZone){let interpretationZone=parsedZone||zone,inst=DateTime.fromObject(parsed,{...opts,zone:interpretationZone,specificOffset});return setZone?inst:inst.setZone(zone)}else return DateTime.invalid(new Invalid("unparsable",`the input "${text}" can't be parsed as ${format}`))}function toTechFormat(dt,format,allowZ=!0){return dt.isValid?Formatter2.create(Locale.create("en-US"),{allowZ,forceSimple:!0}).formatDateTimeFromString(dt,format):null}function toISODate(o,extended){let longFormat=o.c.year>9999||o.c.year<0,c="";return longFormat&&o.c.year>=0&&(c+="+"),c+=padStart(o.c.year,longFormat?6:4),extended?(c+="-",c+=padStart(o.c.month),c+="-",c+=padStart(o.c.day)):(c+=padStart(o.c.month),c+=padStart(o.c.day)),c}function toISOTime(o,extended,suppressSeconds,suppressMilliseconds,includeOffset,extendedZone){let c=padStart(o.c.hour);return extended?(c+=":",c+=padStart(o.c.minute),(o.c.millisecond!==0||o.c.second!==0||!suppressSeconds)&&(c+=":")):c+=padStart(o.c.minute),(o.c.millisecond!==0||o.c.second!==0||!suppressSeconds)&&(c+=padStart(o.c.second),(o.c.millisecond!==0||!suppressMilliseconds)&&(c+=".",c+=padStart(o.c.millisecond,3))),includeOffset&&(o.isOffsetFixed&&o.offset===0&&!extendedZone?c+="Z":o.o<0?(c+="-",c+=padStart(Math.trunc(-o.o/60)),c+=":",c+=padStart(Math.trunc(-o.o%60))):(c+="+",c+=padStart(Math.trunc(o.o/60)),c+=":",c+=padStart(Math.trunc(o.o%60)))),extendedZone&&(c+="["+o.zone.ianaName+"]"),c}var defaultUnitValues={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},defaultWeekUnitValues={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},defaultOrdinalUnitValues={ordinal:1,hour:0,minute:0,second:0,millisecond:0},orderedUnits=["year","month","day","hour","minute","second","millisecond"],orderedWeekUnits=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],orderedOrdinalUnits=["year","ordinal","hour","minute","second","millisecond"];function normalizeUnit(unit){let normalized={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[unit.toLowerCase()];if(!normalized)throw new InvalidUnitError(unit);return normalized}function quickDT(obj,opts){let zone=normalizeZone(opts.zone,Settings.defaultZone),loc=Locale.fromObject(opts),tsNow=Settings.now(),ts,o;if(isUndefined(obj.year))ts=tsNow;else{for(let u of orderedUnits)isUndefined(obj[u])&&(obj[u]=defaultUnitValues[u]);let invalid=hasInvalidGregorianData(obj)||hasInvalidTimeData(obj);if(invalid)return DateTime.invalid(invalid);let offsetProvis=zone.offset(tsNow);[ts,o]=objToTS(obj,offsetProvis,zone)}return new DateTime({ts,zone,loc,o})}function diffRelative(start,end,opts){let round=isUndefined(opts.round)?!0:opts.round,format=(c,unit)=>(c=roundTo(c,round||opts.calendary?0:2,!0),end.loc.clone(opts).relFormatter(opts).format(c,unit)),differ=unit=>opts.calendary?end.hasSame(start,unit)?0:end.startOf(unit).diff(start.startOf(unit),unit).get(unit):end.diff(start,unit).get(unit);if(opts.unit)return format(differ(opts.unit),opts.unit);for(let unit of opts.units){let count=differ(unit);if(Math.abs(count)>=1)return format(count,unit)}return format(start>end?-0:0,opts.units[opts.units.length-1])}function lastOpts(argList){let opts={},args;return argList.length>0&&typeof argList[argList.length-1]=="object"?(opts=argList[argList.length-1],args=Array.from(argList).slice(0,argList.length-1)):args=Array.from(argList),[opts,args]}var DateTime=class _DateTime{constructor(config){let zone=config.zone||Settings.defaultZone,invalid=config.invalid||(Number.isNaN(config.ts)?new Invalid("invalid input"):null)||(zone.isValid?null:unsupportedZone(zone));this.ts=isUndefined(config.ts)?Settings.now():config.ts;let c=null,o=null;if(!invalid)if(config.old&&config.old.ts===this.ts&&config.old.zone.equals(zone))[c,o]=[config.old.c,config.old.o];else{let ot=zone.offset(this.ts);c=tsToObj(this.ts,ot),invalid=Number.isNaN(c.year)?new Invalid("invalid input"):null,c=invalid?null:c,o=invalid?null:ot}this._zone=zone,this.loc=config.loc||Locale.create(),this.invalid=invalid,this.weekData=null,this.c=c,this.o=o,this.isLuxonDateTime=!0}static now(){return new _DateTime({})}static local(){let[opts,args]=lastOpts(arguments),[year,month,day,hour,minute,second,millisecond]=args;return quickDT({year,month,day,hour,minute,second,millisecond},opts)}static utc(){let[opts,args]=lastOpts(arguments),[year,month,day,hour,minute,second,millisecond]=args;return opts.zone=FixedOffsetZone.utcInstance,quickDT({year,month,day,hour,minute,second,millisecond},opts)}static fromJSDate(date,options={}){let ts=isDate(date)?date.valueOf():NaN;if(Number.isNaN(ts))return _DateTime.invalid("invalid input");let zoneToUse=normalizeZone(options.zone,Settings.defaultZone);return zoneToUse.isValid?new _DateTime({ts,zone:zoneToUse,loc:Locale.fromObject(options)}):_DateTime.invalid(unsupportedZone(zoneToUse))}static fromMillis(milliseconds,options={}){if(isNumber(milliseconds))return milliseconds<-MAX_DATE||milliseconds>MAX_DATE?_DateTime.invalid("Timestamp out of range"):new _DateTime({ts:milliseconds,zone:normalizeZone(options.zone,Settings.defaultZone),loc:Locale.fromObject(options)});throw new InvalidArgumentError(`fromMillis requires a numerical input, but received a ${typeof milliseconds} with value ${milliseconds}`)}static fromSeconds(seconds,options={}){if(isNumber(seconds))return new _DateTime({ts:seconds*1e3,zone:normalizeZone(options.zone,Settings.defaultZone),loc:Locale.fromObject(options)});throw new InvalidArgumentError("fromSeconds requires a numerical input")}static fromObject(obj,opts={}){obj=obj||{};let zoneToUse=normalizeZone(opts.zone,Settings.defaultZone);if(!zoneToUse.isValid)return _DateTime.invalid(unsupportedZone(zoneToUse));let tsNow=Settings.now(),offsetProvis=isUndefined(opts.specificOffset)?zoneToUse.offset(tsNow):opts.specificOffset,normalized=normalizeObject(obj,normalizeUnit),containsOrdinal=!isUndefined(normalized.ordinal),containsGregorYear=!isUndefined(normalized.year),containsGregorMD=!isUndefined(normalized.month)||!isUndefined(normalized.day),containsGregor=containsGregorYear||containsGregorMD,definiteWeekDef=normalized.weekYear||normalized.weekNumber,loc=Locale.fromObject(opts);if((containsGregor||containsOrdinal)&&definiteWeekDef)throw new ConflictingSpecificationError("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(containsGregorMD&&containsOrdinal)throw new ConflictingSpecificationError("Can't mix ordinal dates with month/day");let useWeekData=definiteWeekDef||normalized.weekday&&!containsGregor,units,defaultValues,objNow=tsToObj(tsNow,offsetProvis);useWeekData?(units=orderedWeekUnits,defaultValues=defaultWeekUnitValues,objNow=gregorianToWeek(objNow)):containsOrdinal?(units=orderedOrdinalUnits,defaultValues=defaultOrdinalUnitValues,objNow=gregorianToOrdinal(objNow)):(units=orderedUnits,defaultValues=defaultUnitValues);let foundFirst=!1;for(let u of units){let v=normalized[u];isUndefined(v)?foundFirst?normalized[u]=defaultValues[u]:normalized[u]=objNow[u]:foundFirst=!0}let higherOrderInvalid=useWeekData?hasInvalidWeekData(normalized):containsOrdinal?hasInvalidOrdinalData(normalized):hasInvalidGregorianData(normalized),invalid=higherOrderInvalid||hasInvalidTimeData(normalized);if(invalid)return _DateTime.invalid(invalid);let gregorian=useWeekData?weekToGregorian(normalized):containsOrdinal?ordinalToGregorian(normalized):normalized,[tsFinal,offsetFinal]=objToTS(gregorian,offsetProvis,zoneToUse),inst=new _DateTime({ts:tsFinal,zone:zoneToUse,o:offsetFinal,loc});return normalized.weekday&&containsGregor&&obj.weekday!==inst.weekday?_DateTime.invalid("mismatched weekday",`you can't specify both a weekday of ${normalized.weekday} and a date of ${inst.toISO()}`):inst}static fromISO(text,opts={}){let[vals,parsedZone]=parseISODate(text);return parseDataToDateTime(vals,parsedZone,opts,"ISO 8601",text)}static fromRFC2822(text,opts={}){let[vals,parsedZone]=parseRFC2822Date(text);return parseDataToDateTime(vals,parsedZone,opts,"RFC 2822",text)}static fromHTTP(text,opts={}){let[vals,parsedZone]=parseHTTPDate(text);return parseDataToDateTime(vals,parsedZone,opts,"HTTP",opts)}static fromFormat(text,fmt,opts={}){if(isUndefined(text)||isUndefined(fmt))throw new InvalidArgumentError("fromFormat requires an input string and a format");let{locale=null,numberingSystem=null}=opts,localeToUse=Locale.fromOpts({locale,numberingSystem,defaultToEN:!0}),[vals,parsedZone,specificOffset,invalid]=parseFromTokens(localeToUse,text,fmt);return invalid?_DateTime.invalid(invalid):parseDataToDateTime(vals,parsedZone,opts,`format ${fmt}`,text,specificOffset)}static fromString(text,fmt,opts={}){return _DateTime.fromFormat(text,fmt,opts)}static fromSQL(text,opts={}){let[vals,parsedZone]=parseSQL(text);return parseDataToDateTime(vals,parsedZone,opts,"SQL",text)}static invalid(reason,explanation=null){if(!reason)throw new InvalidArgumentError("need to specify a reason the DateTime is invalid");let invalid=reason instanceof Invalid?reason:new Invalid(reason,explanation);if(Settings.throwOnInvalid)throw new InvalidDateTimeError(invalid);return new _DateTime({invalid})}static isDateTime(o){return o&&o.isLuxonDateTime||!1}static parseFormatForOpts(formatOpts,localeOpts={}){let tokenList=formatOptsToTokens(formatOpts,Locale.fromObject(localeOpts));return tokenList?tokenList.map(t2=>t2?t2.val:null).join(""):null}static expandFormat(fmt,localeOpts={}){return expandMacroTokens(Formatter2.parseFormat(fmt),Locale.fromObject(localeOpts)).map(t2=>t2.val).join("")}get(unit){return this[unit]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?possiblyCachedWeekData(this).weekYear:NaN}get weekNumber(){return this.isValid?possiblyCachedWeekData(this).weekNumber:NaN}get weekday(){return this.isValid?possiblyCachedWeekData(this).weekday:NaN}get ordinal(){return this.isValid?gregorianToOrdinal(this.c).ordinal:NaN}get monthShort(){return this.isValid?Info.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?Info.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?Info.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Info.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];let dayMs=864e5,minuteMs=6e4,localTS=objToLocalTS(this.c),oEarlier=this.zone.offset(localTS-dayMs),oLater=this.zone.offset(localTS+dayMs),o1=this.zone.offset(localTS-oEarlier*minuteMs),o2=this.zone.offset(localTS-oLater*minuteMs);if(o1===o2)return[this];let ts1=localTS-o1*minuteMs,ts2=localTS-o2*minuteMs,c1=tsToObj(ts1,o1),c2=tsToObj(ts2,o2);return c1.hour===c2.hour&&c1.minute===c2.minute&&c1.second===c2.second&&c1.millisecond===c2.millisecond?[clone(this,{ts:ts1}),clone(this,{ts:ts2})]:[this]}get isInLeapYear(){return isLeapYear(this.year)}get daysInMonth(){return daysInMonth(this.year,this.month)}get daysInYear(){return this.isValid?daysInYear(this.year):NaN}get weeksInWeekYear(){return this.isValid?weeksInWeekYear(this.weekYear):NaN}resolvedLocaleOptions(opts={}){let{locale,numberingSystem,calendar}=Formatter2.create(this.loc.clone(opts),opts).resolvedOptions(this);return{locale,numberingSystem,outputCalendar:calendar}}toUTC(offset2=0,opts={}){return this.setZone(FixedOffsetZone.instance(offset2),opts)}toLocal(){return this.setZone(Settings.defaultZone)}setZone(zone,{keepLocalTime=!1,keepCalendarTime=!1}={}){if(zone=normalizeZone(zone,Settings.defaultZone),zone.equals(this.zone))return this;if(zone.isValid){let newTS=this.ts;if(keepLocalTime||keepCalendarTime){let offsetGuess=zone.offset(this.ts),asObj=this.toObject();[newTS]=objToTS(asObj,offsetGuess,zone)}return clone(this,{ts:newTS,zone})}else return _DateTime.invalid(unsupportedZone(zone))}reconfigure({locale,numberingSystem,outputCalendar}={}){let loc=this.loc.clone({locale,numberingSystem,outputCalendar});return clone(this,{loc})}setLocale(locale){return this.reconfigure({locale})}set(values){if(!this.isValid)return this;let normalized=normalizeObject(values,normalizeUnit),settingWeekStuff=!isUndefined(normalized.weekYear)||!isUndefined(normalized.weekNumber)||!isUndefined(normalized.weekday),containsOrdinal=!isUndefined(normalized.ordinal),containsGregorYear=!isUndefined(normalized.year),containsGregorMD=!isUndefined(normalized.month)||!isUndefined(normalized.day),containsGregor=containsGregorYear||containsGregorMD,definiteWeekDef=normalized.weekYear||normalized.weekNumber;if((containsGregor||containsOrdinal)&&definiteWeekDef)throw new ConflictingSpecificationError("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(containsGregorMD&&containsOrdinal)throw new ConflictingSpecificationError("Can't mix ordinal dates with month/day");let mixed;settingWeekStuff?mixed=weekToGregorian({...gregorianToWeek(this.c),...normalized}):isUndefined(normalized.ordinal)?(mixed={...this.toObject(),...normalized},isUndefined(normalized.day)&&(mixed.day=Math.min(daysInMonth(mixed.year,mixed.month),mixed.day))):mixed=ordinalToGregorian({...gregorianToOrdinal(this.c),...normalized});let[ts,o]=objToTS(mixed,this.o,this.zone);return clone(this,{ts,o})}plus(duration){if(!this.isValid)return this;let dur=Duration.fromDurationLike(duration);return clone(this,adjustTime(this,dur))}minus(duration){if(!this.isValid)return this;let dur=Duration.fromDurationLike(duration).negate();return clone(this,adjustTime(this,dur))}startOf(unit){if(!this.isValid)return this;let o={},normalizedUnit=Duration.normalizeUnit(unit);switch(normalizedUnit){case"years":o.month=1;case"quarters":case"months":o.day=1;case"weeks":case"days":o.hour=0;case"hours":o.minute=0;case"minutes":o.second=0;case"seconds":o.millisecond=0;break}if(normalizedUnit==="weeks"&&(o.weekday=1),normalizedUnit==="quarters"){let q=Math.ceil(this.month/3);o.month=(q-1)*3+1}return this.set(o)}endOf(unit){return this.isValid?this.plus({[unit]:1}).startOf(unit).minus(1):this}toFormat(fmt,opts={}){return this.isValid?Formatter2.create(this.loc.redefaultToEN(opts)).formatDateTimeFromString(this,fmt):INVALID}toLocaleString(formatOpts=DATE_SHORT,opts={}){return this.isValid?Formatter2.create(this.loc.clone(opts),formatOpts).formatDateTime(this):INVALID}toLocaleParts(opts={}){return this.isValid?Formatter2.create(this.loc.clone(opts),opts).formatDateTimeParts(this):[]}toISO({format="extended",suppressSeconds=!1,suppressMilliseconds=!1,includeOffset=!0,extendedZone=!1}={}){if(!this.isValid)return null;let ext=format==="extended",c=toISODate(this,ext);return c+="T",c+=toISOTime(this,ext,suppressSeconds,suppressMilliseconds,includeOffset,extendedZone),c}toISODate({format="extended"}={}){return this.isValid?toISODate(this,format==="extended"):null}toISOWeekDate(){return toTechFormat(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds=!1,suppressSeconds=!1,includeOffset=!0,includePrefix=!1,extendedZone=!1,format="extended"}={}){return this.isValid?(includePrefix?"T":"")+toISOTime(this,format==="extended",suppressSeconds,suppressMilliseconds,includeOffset,extendedZone):null}toRFC2822(){return toTechFormat(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return toTechFormat(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?toISODate(this,!0):null}toSQLTime({includeOffset=!0,includeZone=!1,includeOffsetSpace=!0}={}){let fmt="HH:mm:ss.SSS";return(includeZone||includeOffset)&&(includeOffsetSpace&&(fmt+=" "),includeZone?fmt+="z":includeOffset&&(fmt+="ZZ")),toTechFormat(this,fmt,!0)}toSQL(opts={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(opts)}`:null}toString(){return this.isValid?this.toISO():INVALID}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(opts={}){if(!this.isValid)return{};let base={...this.c};return opts.includeConfig&&(base.outputCalendar=this.outputCalendar,base.numberingSystem=this.loc.numberingSystem,base.locale=this.loc.locale),base}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(otherDateTime,unit="milliseconds",opts={}){if(!this.isValid||!otherDateTime.isValid)return Duration.invalid("created by diffing an invalid DateTime");let durOpts={locale:this.locale,numberingSystem:this.numberingSystem,...opts},units=maybeArray(unit).map(Duration.normalizeUnit),otherIsLater=otherDateTime.valueOf()>this.valueOf(),earlier=otherIsLater?this:otherDateTime,later=otherIsLater?otherDateTime:this,diffed=diff(earlier,later,units,durOpts);return otherIsLater?diffed.negate():diffed}diffNow(unit="milliseconds",opts={}){return this.diff(_DateTime.now(),unit,opts)}until(otherDateTime){return this.isValid?Interval.fromDateTimes(this,otherDateTime):this}hasSame(otherDateTime,unit){if(!this.isValid)return!1;let inputMs=otherDateTime.valueOf(),adjustedToZone=this.setZone(otherDateTime.zone,{keepLocalTime:!0});return adjustedToZone.startOf(unit)<=inputMs&&inputMs<=adjustedToZone.endOf(unit)}equals(other3){return this.isValid&&other3.isValid&&this.valueOf()===other3.valueOf()&&this.zone.equals(other3.zone)&&this.loc.equals(other3.loc)}toRelative(options={}){if(!this.isValid)return null;let base=options.base||_DateTime.fromObject({},{zone:this.zone}),padding=options.padding?this<base?-options.padding:options.padding:0,units=["years","months","days","hours","minutes","seconds"],unit=options.unit;return Array.isArray(options.unit)&&(units=options.unit,unit=void 0),diffRelative(base,this.plus(padding),{...options,numeric:"always",units,unit})}toRelativeCalendar(options={}){return this.isValid?diffRelative(options.base||_DateTime.fromObject({},{zone:this.zone}),this,{...options,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...dateTimes){if(!dateTimes.every(_DateTime.isDateTime))throw new InvalidArgumentError("min requires all arguments be DateTimes");return bestBy(dateTimes,i=>i.valueOf(),Math.min)}static max(...dateTimes){if(!dateTimes.every(_DateTime.isDateTime))throw new InvalidArgumentError("max requires all arguments be DateTimes");return bestBy(dateTimes,i=>i.valueOf(),Math.max)}static fromFormatExplain(text,fmt,options={}){let{locale=null,numberingSystem=null}=options,localeToUse=Locale.fromOpts({locale,numberingSystem,defaultToEN:!0});return explainFromTokens(localeToUse,text,fmt)}static fromStringExplain(text,fmt,options={}){return _DateTime.fromFormatExplain(text,fmt,options)}static get DATE_SHORT(){return DATE_SHORT}static get DATE_MED(){return DATE_MED}static get DATE_MED_WITH_WEEKDAY(){return DATE_MED_WITH_WEEKDAY}static get DATE_FULL(){return DATE_FULL}static get DATE_HUGE(){return DATE_HUGE}static get TIME_SIMPLE(){return TIME_SIMPLE}static get TIME_WITH_SECONDS(){return TIME_WITH_SECONDS}static get TIME_WITH_SHORT_OFFSET(){return TIME_WITH_SHORT_OFFSET}static get TIME_WITH_LONG_OFFSET(){return TIME_WITH_LONG_OFFSET}static get TIME_24_SIMPLE(){return TIME_24_SIMPLE}static get TIME_24_WITH_SECONDS(){return TIME_24_WITH_SECONDS}static get TIME_24_WITH_SHORT_OFFSET(){return TIME_24_WITH_SHORT_OFFSET}static get TIME_24_WITH_LONG_OFFSET(){return TIME_24_WITH_LONG_OFFSET}static get DATETIME_SHORT(){return DATETIME_SHORT}static get DATETIME_SHORT_WITH_SECONDS(){return DATETIME_SHORT_WITH_SECONDS}static get DATETIME_MED(){return DATETIME_MED}static get DATETIME_MED_WITH_SECONDS(){return DATETIME_MED_WITH_SECONDS}static get DATETIME_MED_WITH_WEEKDAY(){return DATETIME_MED_WITH_WEEKDAY}static get DATETIME_FULL(){return DATETIME_FULL}static get DATETIME_FULL_WITH_SECONDS(){return DATETIME_FULL_WITH_SECONDS}static get DATETIME_HUGE(){return DATETIME_HUGE}static get DATETIME_HUGE_WITH_SECONDS(){return DATETIME_HUGE_WITH_SECONDS}};function friendlyDateTime(dateTimeish){if(DateTime.isDateTime(dateTimeish))return dateTimeish;if(dateTimeish&&dateTimeish.valueOf&&isNumber(dateTimeish.valueOf()))return DateTime.fromJSDate(dateTimeish);if(dateTimeish&&typeof dateTimeish=="object")return DateTime.fromObject(dateTimeish);throw new InvalidArgumentError(`Unknown datetime argument: ${dateTimeish}, of type ${typeof dateTimeish}`)}var DEFAULT_QUERY_SETTINGS={renderNullAs:"\\-",taskCompletionTracking:!1,taskCompletionUseEmojiShorthand:!1,taskCompletionText:"completion",taskCompletionDateFormat:"yyyy-MM-dd",recursiveSubTaskCompletion:!1,warnOnEmptyResult:!0,refreshEnabled:!0,refreshInterval:2500,defaultDateFormat:"MMMM dd, yyyy",defaultDateTimeFormat:"h:mm a - MMMM dd, yyyy",maxRecursiveRenderDepth:4,tableIdColumnName:"File",tableGroupColumnName:"Group",showResultCount:!0},DEFAULT_EXPORT_SETTINGS={allowHtml:!0};({...DEFAULT_QUERY_SETTINGS,...DEFAULT_EXPORT_SETTINGS});var Success=class _Success{value;successful;constructor(value){this.value=value,this.successful=!0}map(f){return new _Success(f(this.value))}flatMap(f){return f(this.value)}mapErr(f){return this}bimap(succ,_fail){return this.map(succ)}orElse(_value){return this.value}cast(){return this}orElseThrow(_message){return this.value}},Failure=class _Failure{error;successful;constructor(error){this.error=error,this.successful=!1}map(_f){return this}flatMap(_f){return this}mapErr(f){return new _Failure(f(this.error))}bimap(_succ,fail){return this.mapErr(fail)}orElse(value){return value}cast(){return this}orElseThrow(message){throw message?new Error(message(this.error)):new Error(""+this.error)}},Result;(function(Result2){function success(value){return new Success(value)}Result2.success=success;function failure(error){return new Failure(error)}Result2.failure=failure;function flatMap2(first,second,f){return first.successful?second.successful?f(first.value,second.value):failure(second.error):failure(first.error)}Result2.flatMap2=flatMap2;function map2(first,second,f){return flatMap2(first,second,(a,b)=>success(f(a,b)))}Result2.map2=map2})(Result||(Result={}));var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},parsimmon_umd_min={exports:{}};parsimmon_umd_min.exports;(function(module3,exports2){(function(n2,t2){module3.exports=t2()})(typeof self<"u"?self:commonjsGlobal,function(){return function(n2){var t2={};function r(e){if(t2[e])return t2[e].exports;var u=t2[e]={i:e,l:!1,exports:{}};return n2[e].call(u.exports,u,u.exports,r),u.l=!0,u.exports}return r.m=n2,r.c=t2,r.d=function(n3,t3,e){r.o(n3,t3)||Object.defineProperty(n3,t3,{configurable:!1,enumerable:!0,get:e})},r.r=function(n3){Object.defineProperty(n3,"__esModule",{value:!0})},r.n=function(n3){var t3=n3&&n3.__esModule?function(){return n3.default}:function(){return n3};return r.d(t3,"a",t3),t3},r.o=function(n3,t3){return Object.prototype.hasOwnProperty.call(n3,t3)},r.p="",r(r.s=0)}([function(n2,t2,r){function e(n3){if(!(this instanceof e))return new e(n3);this._=n3}var u=e.prototype;function o(n3,t3){for(var r2=0;r2<n3;r2++)t3(r2)}function i(n3,t3,r2){return function(n4,t4){o(t4.length,function(r3){n4(t4[r3],r3,t4)})}(function(r3,e2,u2){t3=n3(t3,r3,e2,u2)},r2),t3}function a(n3,t3){return i(function(t4,r2,e2,u2){return t4.concat([n3(r2,e2,u2)])},[],t3)}function f(n3,t3){var r2={v:0,buf:t3};return o(n3,function(){var n4;r2={v:r2.v<<1|(n4=r2.buf,n4[0]>>7),buf:function(n5){var t4=i(function(n6,t5,r3,e2){return n6.concat(r3===e2.length-1?Buffer.from([t5,0]).readUInt16BE(0):e2.readUInt16BE(r3))},[],n5);return Buffer.from(a(function(n6){return(n6<<1&65535)>>8},t4))}(r2.buf)}}),r2}function c(){return typeof Buffer<"u"}function s2(){if(!c())throw new Error("Buffer global does not exist; please use webpack if you need to parse Buffers in the browser.")}function l2(n3){s2();var t3=i(function(n4,t4){return n4+t4},0,n3);if(t3%8!=0)throw new Error("The bits ["+n3.join(", ")+"] add up to "+t3+" which is not an even number of bytes; the total should be divisible by 8");var r2,u2=t3/8,o2=(r2=function(n4){return n4>48},i(function(n4,t4){return n4||(r2(t4)?t4:n4)},null,n3));if(o2)throw new Error(o2+" bit range requested exceeds 48 bit (6 byte) Number max.");return new e(function(t4,r3){var e2=u2+r3;return e2>t4.length?x(r3,u2.toString()+" bytes"):b(e2,i(function(n4,t5){var r4=f(t5,n4.buf);return{coll:n4.coll.concat(r4.v),buf:r4.buf}},{coll:[],buf:t4.slice(r3,e2)},n3).coll)})}function h(n3,t3){return new e(function(r2,e2){return s2(),e2+t3>r2.length?x(e2,t3+" bytes for "+n3):b(e2+t3,r2.slice(e2,e2+t3))})}function p(n3,t3){if(typeof(r2=t3)!="number"||Math.floor(r2)!==r2||t3<0||t3>6)throw new Error(n3+" requires integer length in range [0, 6].");var r2}function d(n3){return p("uintBE",n3),h("uintBE("+n3+")",n3).map(function(t3){return t3.readUIntBE(0,n3)})}function v(n3){return p("uintLE",n3),h("uintLE("+n3+")",n3).map(function(t3){return t3.readUIntLE(0,n3)})}function g(n3){return p("intBE",n3),h("intBE("+n3+")",n3).map(function(t3){return t3.readIntBE(0,n3)})}function m(n3){return p("intLE",n3),h("intLE("+n3+")",n3).map(function(t3){return t3.readIntLE(0,n3)})}function y(n3){return n3 instanceof e}function E(n3){return{}.toString.call(n3)==="[object Array]"}function w(n3){return c()&&Buffer.isBuffer(n3)}function b(n3,t3){return{status:!0,index:n3,value:t3,furthest:-1,expected:[]}}function x(n3,t3){return E(t3)||(t3=[t3]),{status:!1,index:-1,value:null,furthest:n3,expected:t3}}function B(n3,t3){if(!t3||n3.furthest>t3.furthest)return n3;var r2=n3.furthest===t3.furthest?function(n4,t4){if(function(){if(e._supportsSet!==void 0)return e._supportsSet;var n5=typeof Set<"u";return e._supportsSet=n5,n5}()&&Array.from){for(var r3=new Set(n4),u2=0;u2<t4.length;u2++)r3.add(t4[u2]);var o2=Array.from(r3);return o2.sort(),o2}for(var i2={},a2=0;a2<n4.length;a2++)i2[n4[a2]]=!0;for(var f2=0;f2<t4.length;f2++)i2[t4[f2]]=!0;var c2=[];for(var s3 in i2)({}).hasOwnProperty.call(i2,s3)&&c2.push(s3);return c2.sort(),c2}(n3.expected,t3.expected):t3.expected;return{status:n3.status,index:n3.index,value:n3.value,furthest:t3.furthest,expected:r2}}var j={};function S(n3,t3){if(w(n3))return{offset:t3,line:-1,column:-1};n3 in j||(j[n3]={});for(var r2=j[n3],e2=0,u2=0,o2=0,i2=t3;i2>=0;){if(i2 in r2){e2=r2[i2].line,o2===0&&(o2=r2[i2].lineStart);break}(n3.charAt(i2)===`
`||n3.charAt(i2)==="\r"&&n3.charAt(i2+1)!==`
`)&&(u2++,o2===0&&(o2=i2+1)),i2--}var a2=e2+u2,f2=t3-o2;return r2[t3]={line:a2,lineStart:o2},{offset:t3,line:a2+1,column:f2+1}}function _(n3){if(!y(n3))throw new Error("not a parser: "+n3)}function L(n3,t3){return typeof n3=="string"?n3.charAt(t3):n3[t3]}function O(n3){if(typeof n3!="number")throw new Error("not a number: "+n3)}function k(n3){if(typeof n3!="function")throw new Error("not a function: "+n3)}function P(n3){if(typeof n3!="string")throw new Error("not a string: "+n3)}var q=2,A=3,I=8,F=5*I,M=4*I,z="  ";function R(n3,t3){return new Array(t3+1).join(n3)}function U(n3,t3,r2){var e2=t3-n3.length;return e2<=0?n3:R(r2,e2)+n3}function W(n3,t3,r2,e2){return{from:n3-t3>0?n3-t3:0,to:n3+r2>e2?e2:n3+r2}}function D(n3,t3){var r2,e2,u2,o2,f2,c2=t3.index,s3=c2.offset,l3=1;if(s3===n3.length)return"Got the end of the input";if(w(n3)){var h2=s3-s3%I,p2=s3-h2,d2=W(h2,F,M+I,n3.length),v2=a(function(n4){return a(function(n5){return U(n5.toString(16),2,"0")},n4)},function(n4,t4){var r3=n4.length,e3=[],u3=0;if(r3<=t4)return[n4.slice()];for(var o3=0;o3<r3;o3++)e3[u3]||e3.push([]),e3[u3].push(n4[o3]),(o3+1)%t4==0&&u3++;return e3}(n3.slice(d2.from,d2.to).toJSON().data,I));o2=function(n4){return n4.from===0&&n4.to===1?{from:n4.from,to:n4.to}:{from:n4.from/I,to:Math.floor(n4.to/I)}}(d2),e2=h2/I,r2=3*p2,p2>=4&&(r2+=1),l3=2,u2=a(function(n4){return n4.length<=4?n4.join(" "):n4.slice(0,4).join(" ")+"  "+n4.slice(4).join(" ")},v2),(f2=(8*(o2.to>0?o2.to-1:o2.to)).toString(16).length)<2&&(f2=2)}else{var g2=n3.split(/\r\n|[\n\r\u2028\u2029]/);r2=c2.column-1,e2=c2.line-1,o2=W(e2,q,A,g2.length),u2=g2.slice(o2.from,o2.to),f2=o2.to.toString().length}var m2=e2-o2.from;return w(n3)&&(f2=(8*(o2.to>0?o2.to-1:o2.to)).toString(16).length)<2&&(f2=2),i(function(t4,e3,u3){var i2,a2=u3===m2,c3=a2?"> ":z;return i2=w(n3)?U((8*(o2.from+u3)).toString(16),f2,"0"):U((o2.from+u3+1).toString(),f2," "),[].concat(t4,[c3+i2+" | "+e3],a2?[z+R(" ",f2)+" | "+U("",r2," ")+R("^",l3)]:[])},[],u2).join(`
`)}function N(n3,t3){return[`
`,"-- PARSING FAILED "+R("-",50),`

`,D(n3,t3),`

`,(r2=t3.expected,r2.length===1?`Expected:

`+r2[0]:`Expected one of the following: 

`+r2.join(", ")),`
`].join("");var r2}function G(n3){return n3.flags!==void 0?n3.flags:[n3.global?"g":"",n3.ignoreCase?"i":"",n3.multiline?"m":"",n3.unicode?"u":"",n3.sticky?"y":""].join("")}function C(){for(var n3=[].slice.call(arguments),t3=n3.length,r2=0;r2<t3;r2+=1)_(n3[r2]);return e(function(r3,e2){for(var u2,o2=new Array(t3),i2=0;i2<t3;i2+=1){if(!(u2=B(n3[i2]._(r3,e2),u2)).status)return u2;o2[i2]=u2.value,e2=u2.index}return B(b(e2,o2),u2)})}function J(){var n3=[].slice.call(arguments);if(n3.length===0)throw new Error("seqMap needs at least one argument");var t3=n3.pop();return k(t3),C.apply(null,n3).map(function(n4){return t3.apply(null,n4)})}function T(){var n3=[].slice.call(arguments),t3=n3.length;if(t3===0)return Y("zero alternates");for(var r2=0;r2<t3;r2+=1)_(n3[r2]);return e(function(t4,r3){for(var e2,u2=0;u2<n3.length;u2+=1)if((e2=B(n3[u2]._(t4,r3),e2)).status)return e2;return e2})}function V(n3,t3){return H(n3,t3).or(X([]))}function H(n3,t3){return _(n3),_(t3),J(n3,t3.then(n3).many(),function(n4,t4){return[n4].concat(t4)})}function K(n3){P(n3);var t3="'"+n3+"'";return e(function(r2,e2){var u2=e2+n3.length,o2=r2.slice(e2,u2);return o2===n3?b(u2,o2):x(e2,t3)})}function Q(n3,t3){(function(n4){if(!(n4 instanceof RegExp))throw new Error("not a regexp: "+n4);for(var t4=G(n4),r3=0;r3<t4.length;r3++){var e2=t4.charAt(r3);if(e2!=="i"&&e2!=="m"&&e2!=="u"&&e2!=="s")throw new Error('unsupported regexp flag "'+e2+'": '+n4)}})(n3),arguments.length>=2?O(t3):t3=0;var r2=function(n4){return RegExp("^(?:"+n4.source+")",G(n4))}(n3),u2=""+n3;return e(function(n4,e2){var o2=r2.exec(n4.slice(e2));if(o2){if(0<=t3&&t3<=o2.length){var i2=o2[0],a2=o2[t3];return b(e2+i2.length,a2)}return x(e2,"valid match group (0 to "+o2.length+") in "+u2)}return x(e2,u2)})}function X(n3){return e(function(t3,r2){return b(r2,n3)})}function Y(n3){return e(function(t3,r2){return x(r2,n3)})}function Z(n3){if(y(n3))return e(function(t3,r2){var e2=n3._(t3,r2);return e2.index=r2,e2.value="",e2});if(typeof n3=="string")return Z(K(n3));if(n3 instanceof RegExp)return Z(Q(n3));throw new Error("not a string, regexp, or parser: "+n3)}function $(n3){return _(n3),e(function(t3,r2){var e2=n3._(t3,r2),u2=t3.slice(r2,e2.index);return e2.status?x(r2,'not "'+u2+'"'):b(r2,null)})}function nn(n3){return k(n3),e(function(t3,r2){var e2=L(t3,r2);return r2<t3.length&&n3(e2)?b(r2+1,e2):x(r2,"a character/byte matching "+n3)})}function tn(n3,t3){arguments.length<2&&(t3=n3,n3=void 0);var r2=e(function(n4,e2){return r2._=t3()._,r2._(n4,e2)});return n3?r2.desc(n3):r2}function rn(){return Y("fantasy-land/empty")}u.parse=function(n3){if(typeof n3!="string"&&!w(n3))throw new Error(".parse must be called with a string or Buffer as its argument");var t3,r2=this.skip(an)._(n3,0);return t3=r2.status?{status:!0,value:r2.value}:{status:!1,index:S(n3,r2.furthest),expected:r2.expected},delete j[n3],t3},u.tryParse=function(n3){var t3=this.parse(n3);if(t3.status)return t3.value;var r2=N(n3,t3),e2=new Error(r2);throw e2.type="ParsimmonError",e2.result=t3,e2},u.assert=function(n3,t3){return this.chain(function(r2){return n3(r2)?X(r2):Y(t3)})},u.or=function(n3){return T(this,n3)},u.trim=function(n3){return this.wrap(n3,n3)},u.wrap=function(n3,t3){return J(n3,this,t3,function(n4,t4){return t4})},u.thru=function(n3){return n3(this)},u.then=function(n3){return _(n3),C(this,n3).map(function(n4){return n4[1]})},u.many=function(){var n3=this;return e(function(t3,r2){for(var e2=[],u2=void 0;;){if(!(u2=B(n3._(t3,r2),u2)).status)return B(b(r2,e2),u2);if(r2===u2.index)throw new Error("infinite loop detected in .many() parser --- calling .many() on a parser which can accept zero characters is usually the cause");r2=u2.index,e2.push(u2.value)}})},u.tieWith=function(n3){return P(n3),this.map(function(t3){if(function(n4){if(!E(n4))throw new Error("not an array: "+n4)}(t3),t3.length){P(t3[0]);for(var r2=t3[0],e2=1;e2<t3.length;e2++)P(t3[e2]),r2+=n3+t3[e2];return r2}return""})},u.tie=function(){return this.tieWith("")},u.times=function(n3,t3){var r2=this;return arguments.length<2&&(t3=n3),O(n3),O(t3),e(function(e2,u2){for(var o2=[],i2=void 0,a2=void 0,f2=0;f2<n3;f2+=1){if(a2=B(i2=r2._(e2,u2),a2),!i2.status)return a2;u2=i2.index,o2.push(i2.value)}for(;f2<t3&&(a2=B(i2=r2._(e2,u2),a2),i2.status);f2+=1)u2=i2.index,o2.push(i2.value);return B(b(u2,o2),a2)})},u.result=function(n3){return this.map(function(){return n3})},u.atMost=function(n3){return this.times(0,n3)},u.atLeast=function(n3){return J(this.times(n3),this.many(),function(n4,t3){return n4.concat(t3)})},u.map=function(n3){k(n3);var t3=this;return e(function(r2,e2){var u2=t3._(r2,e2);return u2.status?B(b(u2.index,n3(u2.value)),u2):u2})},u.contramap=function(n3){k(n3);var t3=this;return e(function(r2,e2){var u2=t3.parse(n3(r2.slice(e2)));return u2.status?b(e2+r2.length,u2.value):u2})},u.promap=function(n3,t3){return k(n3),k(t3),this.contramap(n3).map(t3)},u.skip=function(n3){return C(this,n3).map(function(n4){return n4[0]})},u.mark=function(){return J(en,this,en,function(n3,t3,r2){return{start:n3,value:t3,end:r2}})},u.node=function(n3){return J(en,this,en,function(t3,r2,e2){return{name:n3,value:r2,start:t3,end:e2}})},u.sepBy=function(n3){return V(this,n3)},u.sepBy1=function(n3){return H(this,n3)},u.lookahead=function(n3){return this.skip(Z(n3))},u.notFollowedBy=function(n3){return this.skip($(n3))},u.desc=function(n3){E(n3)||(n3=[n3]);var t3=this;return e(function(r2,e2){var u2=t3._(r2,e2);return u2.status||(u2.expected=n3),u2})},u.fallback=function(n3){return this.or(X(n3))},u.ap=function(n3){return J(n3,this,function(n4,t3){return n4(t3)})},u.chain=function(n3){var t3=this;return e(function(r2,e2){var u2=t3._(r2,e2);return u2.status?B(n3(u2.value)._(r2,u2.index),u2):u2})},u.concat=u.or,u.empty=rn,u.of=X,u["fantasy-land/ap"]=u.ap,u["fantasy-land/chain"]=u.chain,u["fantasy-land/concat"]=u.concat,u["fantasy-land/empty"]=u.empty,u["fantasy-land/of"]=u.of,u["fantasy-land/map"]=u.map;var en=e(function(n3,t3){return b(t3,S(n3,t3))}),un=e(function(n3,t3){return t3>=n3.length?x(t3,"any character/byte"):b(t3+1,L(n3,t3))}),on=e(function(n3,t3){return b(n3.length,n3.slice(t3))}),an=e(function(n3,t3){return t3<n3.length?x(t3,"EOF"):b(t3,null)}),fn=Q(/[0-9]/).desc("a digit"),cn=Q(/[0-9]*/).desc("optional digits"),sn=Q(/[a-z]/i).desc("a letter"),ln=Q(/[a-z]*/i).desc("optional letters"),hn=Q(/\s*/).desc("optional whitespace"),pn=Q(/\s+/).desc("whitespace"),dn=K("\r"),vn=K(`
`),gn=K(`\r
`),mn=T(gn,vn,dn).desc("newline"),yn=T(mn,an);e.all=on,e.alt=T,e.any=un,e.cr=dn,e.createLanguage=function(n3){var t3={};for(var r2 in n3)({}).hasOwnProperty.call(n3,r2)&&function(r3){t3[r3]=tn(function(){return n3[r3](t3)})}(r2);return t3},e.crlf=gn,e.custom=function(n3){return e(n3(b,x))},e.digit=fn,e.digits=cn,e.empty=rn,e.end=yn,e.eof=an,e.fail=Y,e.formatError=N,e.index=en,e.isParser=y,e.lazy=tn,e.letter=sn,e.letters=ln,e.lf=vn,e.lookahead=Z,e.makeFailure=x,e.makeSuccess=b,e.newline=mn,e.noneOf=function(n3){return nn(function(t3){return n3.indexOf(t3)<0}).desc("none of '"+n3+"'")},e.notFollowedBy=$,e.of=X,e.oneOf=function(n3){for(var t3=n3.split(""),r2=0;r2<t3.length;r2++)t3[r2]="'"+t3[r2]+"'";return nn(function(t4){return n3.indexOf(t4)>=0}).desc(t3)},e.optWhitespace=hn,e.Parser=e,e.range=function(n3,t3){return nn(function(r2){return n3<=r2&&r2<=t3}).desc(n3+"-"+t3)},e.regex=Q,e.regexp=Q,e.sepBy=V,e.sepBy1=H,e.seq=C,e.seqMap=J,e.seqObj=function(){for(var n3,t3={},r2=0,u2=(n3=arguments,Array.prototype.slice.call(n3)),o2=u2.length,i2=0;i2<o2;i2+=1){var a2=u2[i2];if(!y(a2)){if(E(a2)&&a2.length===2&&typeof a2[0]=="string"&&y(a2[1])){var f2=a2[0];if(Object.prototype.hasOwnProperty.call(t3,f2))throw new Error("seqObj: duplicate key "+f2);t3[f2]=!0,r2++;continue}throw new Error("seqObj arguments must be parsers or [string, parser] array pairs.")}}if(r2===0)throw new Error("seqObj expects at least one named parser, found zero");return e(function(n4,t4){for(var r3,e2={},i3=0;i3<o2;i3+=1){var a3,f3;if(E(u2[i3])?(a3=u2[i3][0],f3=u2[i3][1]):(a3=null,f3=u2[i3]),!(r3=B(f3._(n4,t4),r3)).status)return r3;a3&&(e2[a3]=r3.value),t4=r3.index}return B(b(t4,e2),r3)})},e.string=K,e.succeed=X,e.takeWhile=function(n3){return k(n3),e(function(t3,r2){for(var e2=r2;e2<t3.length&&n3(L(t3,e2));)e2++;return b(e2,t3.slice(r2,e2))})},e.test=nn,e.whitespace=pn,e["fantasy-land/empty"]=rn,e["fantasy-land/of"]=X,e.Binary={bitSeq:l2,bitSeqObj:function(n3){s2();var t3={},r2=0,e2=a(function(n4){if(E(n4)){var e3=n4;if(e3.length!==2)throw new Error("["+e3.join(", ")+"] should be length 2, got length "+e3.length);if(P(e3[0]),O(e3[1]),Object.prototype.hasOwnProperty.call(t3,e3[0]))throw new Error("duplicate key in bitSeqObj: "+e3[0]);return t3[e3[0]]=!0,r2++,e3}return O(n4),[null,n4]},n3);if(r2<1)throw new Error("bitSeqObj expects at least one named pair, got ["+n3.join(", ")+"]");var u2=a(function(n4){return n4[0]},e2);return l2(a(function(n4){return n4[1]},e2)).map(function(n4){return i(function(n5,t4){return t4[0]!==null&&(n5[t4[0]]=t4[1]),n5},{},a(function(t4,r3){return[t4,n4[r3]]},u2))})},byte:function(n3){if(s2(),O(n3),n3>255)throw new Error("Value specified to byte constructor ("+n3+"=0x"+n3.toString(16)+") is larger in value than a single byte.");var t3=(n3>15?"0x":"0x0")+n3.toString(16);return e(function(r2,e2){var u2=L(r2,e2);return u2===n3?b(e2+1,u2):x(e2,t3)})},buffer:function(n3){return h("buffer",n3).map(function(n4){return Buffer.from(n4)})},encodedString:function(n3,t3){return h("string",t3).map(function(t4){return t4.toString(n3)})},uintBE:d,uint8BE:d(1),uint16BE:d(2),uint32BE:d(4),uintLE:v,uint8LE:v(1),uint16LE:v(2),uint32LE:v(4),intBE:g,int8BE:g(1),int16BE:g(2),int32BE:g(4),intLE:m,int8LE:m(1),int16LE:m(2),int32LE:m(4),floatBE:h("floatBE",4).map(function(n3){return n3.readFloatBE(0)}),floatLE:h("floatLE",4).map(function(n3){return n3.readFloatLE(0)}),doubleBE:h("doubleBE",8).map(function(n3){return n3.readDoubleBE(0)}),doubleLE:h("doubleLE",8).map(function(n3){return n3.readDoubleLE(0)})},n2.exports=e}])})})(parsimmon_umd_min,parsimmon_umd_min.exports);var parsimmon_umd_minExports=parsimmon_umd_min.exports,emojiRegex=()=>/[#*0-9]\uFE0F?\u20E3|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23ED-\u23EF\u23F1\u23F2\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692\u2694-\u2697\u2699\u269B\u269C\u26A0\u26A7\u26AA\u26B0\u26B1\u26BD\u26BE\u26C4\u26C8\u26CF\u26D1\u26D3\u26E9\u26F0-\u26F5\u26F7\u26F8\u26FA\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B55\u3030\u303D\u3297\u3299]\uFE0F?|[\u261D\u270C\u270D](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\u270A\u270B](?:\uD83C[\uDFFB-\uDFFF])?|[\u23E9-\u23EC\u23F0\u23F3\u25FD\u2693\u26A1\u26AB\u26C5\u26CE\u26D4\u26EA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2795-\u2797\u27B0\u27BF\u2B50]|\u26F9(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\u2764\uFE0F?(?:\u200D(?:\uD83D\uDD25|\uD83E\uDE79))?|\uD83C(?:[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE37\uDF21\uDF24-\uDF2C\uDF36\uDF7D\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFCD\uDFCE\uDFD4-\uDFDF\uDFF5\uDFF7]\uFE0F?|[\uDF85\uDFC2\uDFC7](?:\uD83C[\uDFFB-\uDFFF])?|[\uDFC3\uDFC4\uDFCA](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDFCB\uDFCC](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDCCF\uDD8E\uDD91-\uDD9A\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF84\uDF86-\uDF93\uDFA0-\uDFC1\uDFC5\uDFC6\uDFC8\uDFC9\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF8-\uDFFF]|\uDDE6\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF]|\uDDE7\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF]|\uDDE8\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF]|\uDDE9\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF]|\uDDEA\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA]|\uDDEB\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7]|\uDDEC\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE]|\uDDED\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA]|\uDDEE\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9]|\uDDEF\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5]|\uDDF0\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF]|\uDDF1\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE]|\uDDF2\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF]|\uDDF3\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF]|\uDDF4\uD83C\uDDF2|\uDDF5\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE]|\uDDF6\uD83C\uDDE6|\uDDF7\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC]|\uDDF8\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF]|\uDDF9\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF]|\uDDFA\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF]|\uDDFB\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA]|\uDDFC\uD83C[\uDDEB\uDDF8]|\uDDFD\uD83C\uDDF0|\uDDFE\uD83C[\uDDEA\uDDF9]|\uDDFF\uD83C[\uDDE6\uDDF2\uDDFC]|\uDFF3\uFE0F?(?:\u200D(?:\u26A7\uFE0F?|\uD83C\uDF08))?|\uDFF4(?:\u200D\u2620\uFE0F?|\uDB40\uDC67\uDB40\uDC62\uDB40(?:\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDC73\uDB40\uDC63\uDB40\uDC74|\uDC77\uDB40\uDC6C\uDB40\uDC73)\uDB40\uDC7F)?)|\uD83D(?:[\uDC08\uDC26](?:\u200D\u2B1B)?|[\uDC3F\uDCFD\uDD49\uDD4A\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3]\uFE0F?|[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC](?:\uD83C[\uDFFB-\uDFFF])?|[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD74\uDD90](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\uDC00-\uDC07\uDC09-\uDC14\uDC16-\uDC25\uDC27-\uDC3A\uDC3C-\uDC3E\uDC40\uDC44\uDC45\uDC51-\uDC65\uDC6A\uDC79-\uDC7B\uDC7D-\uDC80\uDC84\uDC88-\uDC8E\uDC90\uDC92-\uDCA9\uDCAB-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDDA4\uDDFB-\uDE2D\uDE2F-\uDE34\uDE37-\uDE44\uDE48-\uDE4A\uDE80-\uDEA2\uDEA4-\uDEB3\uDEB7-\uDEBF\uDEC1-\uDEC5\uDED0-\uDED2\uDED5-\uDED7\uDEDC-\uDEDF\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uDC15(?:\u200D\uD83E\uDDBA)?|\uDC3B(?:\u200D\u2744\uFE0F?)?|\uDC41\uFE0F?(?:\u200D\uD83D\uDDE8\uFE0F?)?|\uDC68(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDC68\uDC69]\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFE])))?))?|\uDC69(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?[\uDC68\uDC69]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?|\uDC69\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?))|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFE])))?))?|\uDC6F(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDD75(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDE2E(?:\u200D\uD83D\uDCA8)?|\uDE35(?:\u200D\uD83D\uDCAB)?|\uDE36(?:\u200D\uD83C\uDF2B\uFE0F?)?)|\uD83E(?:[\uDD0C\uDD0F\uDD18-\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5\uDEC3-\uDEC5\uDEF0\uDEF2-\uDEF8](?:\uD83C[\uDFFB-\uDFFF])?|[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD4\uDDD6-\uDDDD](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDDDE\uDDDF](?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD0D\uDD0E\uDD10-\uDD17\uDD20-\uDD25\uDD27-\uDD2F\uDD3A\uDD3F-\uDD45\uDD47-\uDD76\uDD78-\uDDB4\uDDB7\uDDBA\uDDBC-\uDDCC\uDDD0\uDDE0-\uDDFF\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC2\uDECE-\uDEDB\uDEE0-\uDEE8]|\uDD3C(?:\u200D[\u2640\u2642]\uFE0F?|\uD83C[\uDFFB-\uDFFF])?|\uDDD1(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFC-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFD-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFD\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFE]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?))?|\uDEF1(?:\uD83C(?:\uDFFB(?:\u200D\uD83E\uDEF2\uD83C[\uDFFC-\uDFFF])?|\uDFFC(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFD-\uDFFF])?|\uDFFD(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])?|\uDFFE(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFD\uDFFF])?|\uDFFF(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFE])?))?)/g;function normalizeDuration(dur){return dur==null?dur:dur.shiftToAll().normalize()}function getFileTitle(path){return path.includes("/")&&(path=path.substring(path.lastIndexOf("/")+1)),path.endsWith(".md")&&(path=path.substring(0,path.length-3)),path}parsimmon_umd_minExports.alt(parsimmon_umd_minExports.regex(new RegExp(emojiRegex(),"")),parsimmon_umd_minExports.regex(/[0-9\p{Letter}_-]+/u).map(str=>str.toLocaleLowerCase()),parsimmon_umd_minExports.whitespace.map(_=>"-"),parsimmon_umd_minExports.any.map(_=>"")).many().map(result=>result.join(""));var HEADER_CANONICALIZER=parsimmon_umd_minExports.alt(parsimmon_umd_minExports.regex(new RegExp(emojiRegex(),"")),parsimmon_umd_minExports.regex(/[0-9\p{Letter}_-]+/u),parsimmon_umd_minExports.whitespace.map(_=>" "),parsimmon_umd_minExports.any.map(_=>" ")).many().map(result=>result.join("").split(/\s+/).join(" ").trim());function normalizeHeaderForLink(header){return HEADER_CANONICALIZER.tryParse(header)}function renderMinimalDuration(dur){return dur=normalizeDuration(dur),dur=Duration.fromObject(Object.fromEntries(Object.entries(dur.toObject()).filter(([,quantity])=>quantity!=0))),dur.toHuman()}var Values;(function(Values2){function toString(field,setting=DEFAULT_QUERY_SETTINGS,recursive=!1){let wrapped=wrapValue(field);if(!wrapped)return setting.renderNullAs;switch(wrapped.type){case"null":return setting.renderNullAs;case"string":return wrapped.value;case"number":case"boolean":return""+wrapped.value;case"html":return wrapped.value.outerHTML;case"widget":return wrapped.value.markdown();case"link":return wrapped.value.markdown();case"function":return"<function>";case"array":let result="";return recursive&&(result+="["),result+=wrapped.value.map(f=>toString(f,setting,!0)).join(", "),recursive&&(result+="]"),result;case"object":return"{ "+Object.entries(wrapped.value).map(e=>e[0]+": "+toString(e[1],setting,!0)).join(", ")+" }";case"date":return wrapped.value.second==0&&wrapped.value.hour==0&&wrapped.value.minute==0?wrapped.value.toFormat(setting.defaultDateFormat):wrapped.value.toFormat(setting.defaultDateTimeFormat);case"duration":return renderMinimalDuration(wrapped.value)}}Values2.toString=toString;function wrapValue(val){return isNull(val)?{type:"null",value:val}:isNumber2(val)?{type:"number",value:val}:isString3(val)?{type:"string",value:val}:isBoolean(val)?{type:"boolean",value:val}:isDuration(val)?{type:"duration",value:val}:isDate2(val)?{type:"date",value:val}:isWidget(val)?{type:"widget",value:val}:isArray(val)?{type:"array",value:val}:isLink(val)?{type:"link",value:val}:isFunction(val)?{type:"function",value:val}:isHtml(val)?{type:"html",value:val}:isObject2(val)?{type:"object",value:val}:void 0}Values2.wrapValue=wrapValue;function mapLeaves(val,func){if(isObject2(val)){let result={};for(let[key,value]of Object.entries(val))result[key]=mapLeaves(value,func);return result}else if(isArray(val)){let result=[];for(let value of val)result.push(mapLeaves(value,func));return result}else return func(val)}Values2.mapLeaves=mapLeaves;function compareValue(val1,val2,linkNormalizer){if(val1===void 0&&(val1=null),val2===void 0&&(val2=null),val1===null&&val2===null)return 0;if(val1===null)return-1;if(val2===null)return 1;let wrap1=wrapValue(val1),wrap2=wrapValue(val2);if(wrap1===void 0&&wrap2===void 0)return 0;if(wrap1===void 0)return-1;if(wrap2===void 0)return 1;if(wrap1.type!=wrap2.type)return wrap1.type.localeCompare(wrap2.type);if(wrap1.value===wrap2.value)return 0;switch(wrap1.type){case"string":return wrap1.value.localeCompare(wrap2.value);case"number":return wrap1.value<wrap2.value?-1:wrap1.value==wrap2.value?0:1;case"null":return 0;case"boolean":return wrap1.value==wrap2.value?0:wrap1.value?1:-1;case"link":let link1=wrap1.value,link2=wrap2.value,normalize=linkNormalizer??(x=>x),pathCompare=normalize(link1.path).localeCompare(normalize(link2.path));if(pathCompare!=0)return pathCompare;let typeCompare=link1.type.localeCompare(link2.type);return typeCompare!=0?typeCompare:link1.subpath&&!link2.subpath?1:!link1.subpath&&link2.subpath?-1:!link1.subpath&&!link2.subpath?0:(link1.subpath??"").localeCompare(link2.subpath??"");case"date":return wrap1.value<wrap2.value?-1:wrap1.value.equals(wrap2.value)?0:1;case"duration":return wrap1.value<wrap2.value?-1:wrap1.value.equals(wrap2.value)?0:1;case"array":let f1=wrap1.value,f2=wrap2.value;for(let index=0;index<Math.min(f1.length,f2.length);index++){let comp=compareValue(f1[index],f2[index]);if(comp!=0)return comp}return f1.length-f2.length;case"object":let o1=wrap1.value,o2=wrap2.value,k1=Array.from(Object.keys(o1)),k2=Array.from(Object.keys(o2));k1.sort(),k2.sort();let keyCompare=compareValue(k1,k2);if(keyCompare!=0)return keyCompare;for(let key of k1){let comp=compareValue(o1[key],o2[key]);if(comp!=0)return comp}return 0;case"widget":case"html":case"function":return 0}}Values2.compareValue=compareValue;function typeOf(val){return wrapValue(val)?.type}Values2.typeOf=typeOf;function isTruthy(field){let wrapped=wrapValue(field);if(!wrapped)return!1;switch(wrapped.type){case"number":return wrapped.value!=0;case"string":return wrapped.value.length>0;case"boolean":return wrapped.value;case"link":return!!wrapped.value.path;case"date":return wrapped.value.toMillis()!=0;case"duration":return wrapped.value.as("seconds")!=0;case"object":return Object.keys(wrapped.value).length>0;case"array":return wrapped.value.length>0;case"null":return!1;case"html":case"widget":case"function":return!0}}Values2.isTruthy=isTruthy;function deepCopy(field){if(field==null)return field;if(Values2.isArray(field))return[].concat(field.map(v=>deepCopy(v)));if(Values2.isObject(field)){let result={};for(let[key,value]of Object.entries(field))result[key]=deepCopy(value);return result}else return field}Values2.deepCopy=deepCopy;function isString3(val){return typeof val=="string"}Values2.isString=isString3;function isNumber2(val){return typeof val=="number"}Values2.isNumber=isNumber2;function isDate2(val){return val instanceof DateTime}Values2.isDate=isDate2;function isDuration(val){return val instanceof Duration}Values2.isDuration=isDuration;function isNull(val){return val==null}Values2.isNull=isNull;function isArray(val){return Array.isArray(val)}Values2.isArray=isArray;function isBoolean(val){return typeof val=="boolean"}Values2.isBoolean=isBoolean;function isLink(val){return val instanceof Link}Values2.isLink=isLink;function isWidget(val){return val instanceof Widget}Values2.isWidget=isWidget;function isHtml(val){return typeof HTMLElement<"u"?val instanceof HTMLElement:!1}Values2.isHtml=isHtml;function isObject2(val){return typeof val=="object"&&!isHtml(val)&&!isWidget(val)&&!isArray(val)&&!isDuration(val)&&!isDate2(val)&&!isLink(val)&&val!==void 0&&!isNull(val)}Values2.isObject=isObject2;function isFunction(val){return typeof val=="function"}Values2.isFunction=isFunction})(Values||(Values={}));var Groupings;(function(Groupings2){function isElementGroup(entry){return Values.isObject(entry)&&Object.keys(entry).length==2&&"key"in entry&&"rows"in entry}Groupings2.isElementGroup=isElementGroup;function isGrouping(entry){for(let element of entry)if(!isElementGroup(element))return!1;return!0}Groupings2.isGrouping=isGrouping;function count(elements){if(isGrouping(elements)){let result=0;for(let subgroup of elements)result+=count(subgroup.rows);return result}else return elements.length}Groupings2.count=count})(Groupings||(Groupings={}));var Link=class _Link{path;display;subpath;embed;type;static file(path,embed=!1,display){return new _Link({path,embed,display,subpath:void 0,type:"file"})}static infer(linkpath,embed=!1,display){if(linkpath.includes("#^")){let split=linkpath.split("#^");return _Link.block(split[0],split[1],embed,display)}else if(linkpath.includes("#")){let split=linkpath.split("#");return _Link.header(split[0],split[1],embed,display)}else return _Link.file(linkpath,embed,display)}static header(path,header,embed,display){return new _Link({path,embed,display,subpath:normalizeHeaderForLink(header),type:"header"})}static block(path,blockId,embed,display){return new _Link({path,embed,display,subpath:blockId,type:"block"})}static fromObject(object){return new _Link(object)}constructor(fields){Object.assign(this,fields)}equals(other3){return other3==null||other3==null?!1:this.path==other3.path&&this.type==other3.type&&this.subpath==other3.subpath}toString(){return this.markdown()}toObject(){return{path:this.path,type:this.type,subpath:this.subpath,display:this.display,embed:this.embed}}withPath(path){return new _Link(Object.assign({},this,{path}))}withDisplay(display){return new _Link(Object.assign({},this,{display}))}withHeader(header){return _Link.header(this.path,header,this.embed,this.display)}toFile(){return _Link.file(this.path,this.embed,this.display)}toEmbed(){if(this.embed)return this;{let link=new _Link(this);return link.embed=!0,link}}fromEmbed(){if(this.embed){let link=new _Link(this);return link.embed=!1,link}else return this}markdown(){let result=(this.embed?"!":"")+"[["+this.obsidianLink();return this.display?result+="|"+this.display:(result+="|"+getFileTitle(this.path),(this.type=="header"||this.type=="block")&&(result+=" > "+this.subpath)),result+="]]",result}obsidianLink(){let escaped=this.path.replaceAll("|","\\|");return this.type=="header"?escaped+"#"+this.subpath?.replaceAll("|","\\|"):this.type=="block"?escaped+"#^"+this.subpath?.replaceAll("|","\\|"):escaped}fileName(){return getFileTitle(this.path).replace(".md","")}},Widget=class{$widget;constructor($widget){this.$widget=$widget}},ListPairWidget=class extends Widget{key;value;constructor(key,value){super("dataview:list-pair"),this.key=key,this.value=value}markdown(){return`${Values.toString(this.key)}: ${Values.toString(this.value)}`}},ExternalLinkWidget=class extends Widget{url;display;constructor(url,display){super("dataview:external-link"),this.url=url,this.display=display}markdown(){return`[${this.display??this.url}](${this.url})`}},Widgets;(function(Widgets2){function listPair(key,value){return new ListPairWidget(key,value)}Widgets2.listPair=listPair;function externalLink(url,display){return new ExternalLinkWidget(url,display)}Widgets2.externalLink=externalLink;function isListPair(widget){return widget.$widget==="dataview:list-pair"}Widgets2.isListPair=isListPair;function isExternalLink(widget){return widget.$widget==="dataview:external-link"}Widgets2.isExternalLink=isExternalLink;function isBuiltin(widget){return isListPair(widget)||isExternalLink(widget)}Widgets2.isBuiltin=isBuiltin})(Widgets||(Widgets={}));var Fields;(function(Fields2){function variable(name){return{type:"variable",name}}Fields2.variable=variable;function literal(value){return{type:"literal",value}}Fields2.literal=literal;function binaryOp(left,op,right){return{type:"binaryop",left,op,right}}Fields2.binaryOp=binaryOp;function index(obj,index2){return{type:"index",object:obj,index:index2}}Fields2.index=index;function indexVariable(name){let parts=name.split("."),result=Fields2.variable(parts[0]);for(let index2=1;index2<parts.length;index2++)result=Fields2.index(result,Fields2.literal(parts[index2]));return result}Fields2.indexVariable=indexVariable;function lambda(args,value){return{type:"lambda",arguments:args,value}}Fields2.lambda=lambda;function func(func2,args){return{type:"function",func:func2,arguments:args}}Fields2.func=func;function list(values){return{type:"list",values}}Fields2.list=list;function object(values){return{type:"object",values}}Fields2.object=object;function negate(child){return{type:"negated",child}}Fields2.negate=negate;function isCompareOp(op){return op=="<="||op=="<"||op==">"||op==">="||op=="!="||op=="="}Fields2.isCompareOp=isCompareOp,Fields2.NULL=Fields2.literal(null)})(Fields||(Fields={}));var Sources;(function(Sources2){function tag(tag2){return{type:"tag",tag:tag2}}Sources2.tag=tag;function csv(path){return{type:"csv",path}}Sources2.csv=csv;function folder(prefix){return{type:"folder",folder:prefix}}Sources2.folder=folder;function link(file,incoming){return{type:"link",file,direction:incoming?"incoming":"outgoing"}}Sources2.link=link;function binaryOp(left,op,right){return{type:"binaryop",left,op,right}}Sources2.binaryOp=binaryOp;function and(left,right){return{type:"binaryop",left,op:"&",right}}Sources2.and=and;function or(left,right){return{type:"binaryop",left,op:"|",right}}Sources2.or=or;function negate(child){return{type:"negate",child}}Sources2.negate=negate;function empty(){return{type:"empty"}}Sources2.empty=empty})(Sources||(Sources={}));var EMOJI_REGEX=new RegExp(emojiRegex(),""),DURATION_TYPES={year:Duration.fromObject({years:1}),years:Duration.fromObject({years:1}),yr:Duration.fromObject({years:1}),yrs:Duration.fromObject({years:1}),month:Duration.fromObject({months:1}),months:Duration.fromObject({months:1}),mo:Duration.fromObject({months:1}),mos:Duration.fromObject({months:1}),week:Duration.fromObject({weeks:1}),weeks:Duration.fromObject({weeks:1}),wk:Duration.fromObject({weeks:1}),wks:Duration.fromObject({weeks:1}),w:Duration.fromObject({weeks:1}),day:Duration.fromObject({days:1}),days:Duration.fromObject({days:1}),d:Duration.fromObject({days:1}),hour:Duration.fromObject({hours:1}),hours:Duration.fromObject({hours:1}),hr:Duration.fromObject({hours:1}),hrs:Duration.fromObject({hours:1}),h:Duration.fromObject({hours:1}),minute:Duration.fromObject({minutes:1}),minutes:Duration.fromObject({minutes:1}),min:Duration.fromObject({minutes:1}),mins:Duration.fromObject({minutes:1}),m:Duration.fromObject({minutes:1}),second:Duration.fromObject({seconds:1}),seconds:Duration.fromObject({seconds:1}),sec:Duration.fromObject({seconds:1}),secs:Duration.fromObject({seconds:1}),s:Duration.fromObject({seconds:1})},DATE_SHORTHANDS={now:()=>DateTime.local(),today:()=>DateTime.local().startOf("day"),yesterday:()=>DateTime.local().startOf("day").minus(Duration.fromObject({days:1})),tomorrow:()=>DateTime.local().startOf("day").plus(Duration.fromObject({days:1})),sow:()=>DateTime.local().startOf("week"),"start-of-week":()=>DateTime.local().startOf("week"),eow:()=>DateTime.local().endOf("week"),"end-of-week":()=>DateTime.local().endOf("week"),soy:()=>DateTime.local().startOf("year"),"start-of-year":()=>DateTime.local().startOf("year"),eoy:()=>DateTime.local().endOf("year"),"end-of-year":()=>DateTime.local().endOf("year"),som:()=>DateTime.local().startOf("month"),"start-of-month":()=>DateTime.local().startOf("month"),eom:()=>DateTime.local().endOf("month"),"end-of-month":()=>DateTime.local().endOf("month")},KEYWORDS=["FROM","WHERE","LIMIT","GROUP","FLATTEN"];function splitOnUnescapedPipe(link){let pipe=-1;for(;(pipe=link.indexOf("|",pipe+1))>=0;)if(!(pipe>0&&link[pipe-1]=="\\"))return[link.substring(0,pipe).replace(/\\\|/g,"|"),link.substring(pipe+1)];return[link.replace(/\\\|/g,"|"),void 0]}function parseInnerLink(rawlink){let[link,display]=splitOnUnescapedPipe(rawlink);return Link.infer(link,!1,display)}function createBinaryParser(child,sep,combine){return parsimmon_umd_minExports.seqMap(child,parsimmon_umd_minExports.seq(parsimmon_umd_minExports.optWhitespace,sep,parsimmon_umd_minExports.optWhitespace,child).many(),(first,rest)=>{if(rest.length==0)return first;let node=combine(first,rest[0][1],rest[0][3]);for(let index=1;index<rest.length;index++)node=combine(node,rest[index][1],rest[index][3]);return node})}function chainOpt(base,...funcs){return parsimmon_umd_minExports.custom((success,failure)=>(input,i)=>{let result=base._(input,i);if(!result.status)return result;for(let func of funcs){let next=func(result.value)._(input,result.index);if(!next.status)return result;result=next}return result})}var EXPRESSION=parsimmon_umd_minExports.createLanguage({number:q=>parsimmon_umd_minExports.regexp(/-?[0-9]+(\.[0-9]+)?/).map(str=>Number.parseFloat(str)).desc("number"),string:q=>parsimmon_umd_minExports.string('"').then(parsimmon_umd_minExports.alt(q.escapeCharacter,parsimmon_umd_minExports.noneOf('"\\')).atLeast(0).map(chars2=>chars2.join(""))).skip(parsimmon_umd_minExports.string('"')).desc("string"),escapeCharacter:_=>parsimmon_umd_minExports.string("\\").then(parsimmon_umd_minExports.any).map(escaped=>escaped==='"'?'"':escaped==="\\"?"\\":"\\"+escaped),bool:_=>parsimmon_umd_minExports.regexp(/true|false|True|False/).map(str=>str.toLowerCase()=="true").desc("boolean ('true' or 'false')"),tag:_=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.string("#"),parsimmon_umd_minExports.alt(parsimmon_umd_minExports.regexp(/[^\u2000-\u206F\u2E00-\u2E7F'!"#$%&()*+,.:;<=>?@^`{|}~\[\]\\\s]/).desc("text")).many(),(start,rest)=>start+rest.join("")).desc("tag ('#hello/stuff')"),identifier:_=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.alt(parsimmon_umd_minExports.regexp(/\p{Letter}/u),parsimmon_umd_minExports.regexp(EMOJI_REGEX).desc("text")),parsimmon_umd_minExports.alt(parsimmon_umd_minExports.regexp(/[0-9\p{Letter}_-]/u),parsimmon_umd_minExports.regexp(EMOJI_REGEX).desc("text")).many(),(first,rest)=>first+rest.join("")).desc("variable identifier"),link:_=>parsimmon_umd_minExports.regexp(/\[\[([^\[\]]*?)\]\]/u,1).map(linkInner=>parseInnerLink(linkInner)).desc("file link"),embedLink:q=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.string("!").atMost(1),q.link,(p,l2)=>(p.length>0&&(l2.embed=!0),l2)).desc("file link"),binaryPlusMinus:_=>parsimmon_umd_minExports.regexp(/\+|-/).map(str=>str).desc("'+' or '-'"),binaryMulDiv:_=>parsimmon_umd_minExports.regexp(/\*|\/|%/).map(str=>str).desc("'*' or '/' or '%'"),binaryCompareOp:_=>parsimmon_umd_minExports.regexp(/>=|<=|!=|>|<|=/).map(str=>str).desc("'>=' or '<=' or '!=' or '=' or '>' or '<'"),binaryBooleanOp:_=>parsimmon_umd_minExports.regexp(/and|or|&|\|/i).map(str=>str.toLowerCase()=="and"?"&":str.toLowerCase()=="or"?"|":str).desc("'and' or 'or'"),rootDate:_=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.regexp(/\d{4}/),parsimmon_umd_minExports.string("-"),parsimmon_umd_minExports.regexp(/\d{2}/),(year,_2,month)=>DateTime.fromObject({year:Number.parseInt(year),month:Number.parseInt(month)})).desc("date in format YYYY-MM[-DDTHH-MM-SS.MS]"),dateShorthand:_=>parsimmon_umd_minExports.alt(...Object.keys(DATE_SHORTHANDS).sort((a,b)=>b.length-a.length).map(parsimmon_umd_minExports.string)),date:q=>chainOpt(q.rootDate,ym=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.string("-"),parsimmon_umd_minExports.regexp(/\d{2}/),(_,day)=>ym.set({day:Number.parseInt(day)})),ymd=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.string("T"),parsimmon_umd_minExports.regexp(/\d{2}/),(_,hour)=>ymd.set({hour:Number.parseInt(hour)})),ymdh=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.string(":"),parsimmon_umd_minExports.regexp(/\d{2}/),(_,minute)=>ymdh.set({minute:Number.parseInt(minute)})),ymdhm=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.string(":"),parsimmon_umd_minExports.regexp(/\d{2}/),(_,second)=>ymdhm.set({second:Number.parseInt(second)})),ymdhms=>parsimmon_umd_minExports.alt(parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.string("."),parsimmon_umd_minExports.regexp(/\d{3}/),(_,millisecond)=>ymdhms.set({millisecond:Number.parseInt(millisecond)})),parsimmon_umd_minExports.succeed(ymdhms)),dt=>parsimmon_umd_minExports.alt(parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.string("+").or(parsimmon_umd_minExports.string("-")),parsimmon_umd_minExports.regexp(/\d{1,2}(:\d{2})?/),(pm,hr)=>dt.setZone("UTC"+pm+hr,{keepLocalTime:!0})),parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.string("Z"),()=>dt.setZone("utc",{keepLocalTime:!0})),parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.string("["),parsimmon_umd_minExports.regexp(/[0-9A-Za-z+-\/]+/u),parsimmon_umd_minExports.string("]"),(_a,zone,_b)=>dt.setZone(zone,{keepLocalTime:!0})))).assert(dt=>dt.isValid,"valid date").desc("date in format YYYY-MM[-DDTHH-MM-SS.MS]"),datePlus:q=>parsimmon_umd_minExports.alt(q.dateShorthand.map(d=>DATE_SHORTHANDS[d]()),q.date).desc("date in format YYYY-MM[-DDTHH-MM-SS.MS] or in shorthand"),durationType:_=>parsimmon_umd_minExports.alt(...Object.keys(DURATION_TYPES).sort((a,b)=>b.length-a.length).map(parsimmon_umd_minExports.string)),duration:q=>parsimmon_umd_minExports.seqMap(q.number,parsimmon_umd_minExports.optWhitespace,q.durationType,(count,_,t2)=>DURATION_TYPES[t2].mapUnits(x=>x*count)).sepBy1(parsimmon_umd_minExports.string(",").trim(parsimmon_umd_minExports.optWhitespace).or(parsimmon_umd_minExports.optWhitespace)).map(durations=>durations.reduce((p,c)=>p.plus(c))).desc("duration like 4hr2min"),rawNull:_=>parsimmon_umd_minExports.string("null"),tagSource:q=>q.tag.map(tag=>Sources.tag(tag)),csvSource:q=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.string("csv(").skip(parsimmon_umd_minExports.optWhitespace),q.string,parsimmon_umd_minExports.string(")"),(_1,path,_2)=>Sources.csv(path)),linkIncomingSource:q=>q.link.map(link=>Sources.link(link.path,!0)),linkOutgoingSource:q=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.string("outgoing(").skip(parsimmon_umd_minExports.optWhitespace),q.link,parsimmon_umd_minExports.string(")"),(_1,link,_2)=>Sources.link(link.path,!1)),folderSource:q=>q.string.map(str=>Sources.folder(str)),parensSource:q=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.string("("),parsimmon_umd_minExports.optWhitespace,q.source,parsimmon_umd_minExports.optWhitespace,parsimmon_umd_minExports.string(")"),(_1,_2,field,_3,_4)=>field),negateSource:q=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.alt(parsimmon_umd_minExports.string("-"),parsimmon_umd_minExports.string("!")),q.atomSource,(_,source)=>Sources.negate(source)),atomSource:q=>parsimmon_umd_minExports.alt(q.parensSource,q.negateSource,q.linkOutgoingSource,q.linkIncomingSource,q.folderSource,q.tagSource,q.csvSource),binaryOpSource:q=>createBinaryParser(q.atomSource,q.binaryBooleanOp.map(s2=>s2),Sources.binaryOp),source:q=>q.binaryOpSource,variableField:q=>q.identifier.chain(r=>KEYWORDS.includes(r.toUpperCase())?parsimmon_umd_minExports.fail("Variable fields cannot be a keyword ("+KEYWORDS.join(" or ")+")"):parsimmon_umd_minExports.succeed(Fields.variable(r))).desc("variable"),numberField:q=>q.number.map(val=>Fields.literal(val)).desc("number"),stringField:q=>q.string.map(val=>Fields.literal(val)).desc("string"),boolField:q=>q.bool.map(val=>Fields.literal(val)).desc("boolean"),dateField:q=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.string("date("),parsimmon_umd_minExports.optWhitespace,q.datePlus,parsimmon_umd_minExports.optWhitespace,parsimmon_umd_minExports.string(")"),(prefix,_1,date,_2,postfix)=>Fields.literal(date)).desc("date"),durationField:q=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.string("dur("),parsimmon_umd_minExports.optWhitespace,q.duration,parsimmon_umd_minExports.optWhitespace,parsimmon_umd_minExports.string(")"),(prefix,_1,dur,_2,postfix)=>Fields.literal(dur)).desc("duration"),nullField:q=>q.rawNull.map(_=>Fields.NULL),linkField:q=>q.link.map(f=>Fields.literal(f)),listField:q=>q.field.sepBy(parsimmon_umd_minExports.string(",").trim(parsimmon_umd_minExports.optWhitespace)).wrap(parsimmon_umd_minExports.string("[").skip(parsimmon_umd_minExports.optWhitespace),parsimmon_umd_minExports.optWhitespace.then(parsimmon_umd_minExports.string("]"))).map(l2=>Fields.list(l2)).desc("list ('[1, 2, 3]')"),objectField:q=>parsimmon_umd_minExports.seqMap(q.identifier.or(q.string),parsimmon_umd_minExports.string(":").trim(parsimmon_umd_minExports.optWhitespace),q.field,(name,_sep,value)=>({name,value})).sepBy(parsimmon_umd_minExports.string(",").trim(parsimmon_umd_minExports.optWhitespace)).wrap(parsimmon_umd_minExports.string("{").skip(parsimmon_umd_minExports.optWhitespace),parsimmon_umd_minExports.optWhitespace.then(parsimmon_umd_minExports.string("}"))).map(vals=>{let res={};for(let entry of vals)res[entry.name]=entry.value;return Fields.object(res)}).desc("object ('{ a: 1, b: 2 }')"),atomInlineField:q=>parsimmon_umd_minExports.alt(q.date,q.duration.map(d=>normalizeDuration(d)),q.string,q.tag,q.embedLink,q.bool,q.number,q.rawNull),inlineFieldList:q=>q.atomInlineField.sepBy(parsimmon_umd_minExports.string(",").trim(parsimmon_umd_minExports.optWhitespace).lookahead(q.atomInlineField)),inlineField:q=>parsimmon_umd_minExports.alt(parsimmon_umd_minExports.seqMap(q.atomInlineField,parsimmon_umd_minExports.string(",").trim(parsimmon_umd_minExports.optWhitespace),q.inlineFieldList,(f,_s,l2)=>[f].concat(l2)),q.atomInlineField),atomField:q=>parsimmon_umd_minExports.alt(q.embedLink.map(l2=>Fields.literal(l2)),q.negatedField,q.linkField,q.listField,q.objectField,q.lambdaField,q.parensField,q.boolField,q.numberField,q.stringField,q.dateField,q.durationField,q.nullField,q.variableField),indexField:q=>parsimmon_umd_minExports.seqMap(q.atomField,parsimmon_umd_minExports.alt(q.dotPostfix,q.indexPostfix,q.functionPostfix).many(),(obj,postfixes)=>{let result=obj;for(let post of postfixes)switch(post.type){case"dot":result=Fields.index(result,Fields.literal(post.field));break;case"index":result=Fields.index(result,post.field);break;case"function":result=Fields.func(result,post.fields);break}return result}),negatedField:q=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.string("!"),q.indexField,(_,field)=>Fields.negate(field)).desc("negated field"),parensField:q=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.string("("),parsimmon_umd_minExports.optWhitespace,q.field,parsimmon_umd_minExports.optWhitespace,parsimmon_umd_minExports.string(")"),(_1,_2,field,_3,_4)=>field),lambdaField:q=>parsimmon_umd_minExports.seqMap(q.identifier.sepBy(parsimmon_umd_minExports.string(",").trim(parsimmon_umd_minExports.optWhitespace)).wrap(parsimmon_umd_minExports.string("(").trim(parsimmon_umd_minExports.optWhitespace),parsimmon_umd_minExports.string(")").trim(parsimmon_umd_minExports.optWhitespace)),parsimmon_umd_minExports.string("=>").trim(parsimmon_umd_minExports.optWhitespace),q.field,(ident,_ignore,value)=>({type:"lambda",arguments:ident,value})),dotPostfix:q=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.string("."),q.identifier,(_,field)=>({type:"dot",field})),indexPostfix:q=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.string("["),parsimmon_umd_minExports.optWhitespace,q.field,parsimmon_umd_minExports.optWhitespace,parsimmon_umd_minExports.string("]"),(_,_2,field,_3,_4)=>({type:"index",field})),functionPostfix:q=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.string("("),parsimmon_umd_minExports.optWhitespace,q.field.sepBy(parsimmon_umd_minExports.string(",").trim(parsimmon_umd_minExports.optWhitespace)),parsimmon_umd_minExports.optWhitespace,parsimmon_umd_minExports.string(")"),(_,_1,fields,_2,_3)=>({type:"function",fields})),binaryMulDivField:q=>createBinaryParser(q.indexField,q.binaryMulDiv,Fields.binaryOp),binaryPlusMinusField:q=>createBinaryParser(q.binaryMulDivField,q.binaryPlusMinus,Fields.binaryOp),binaryCompareField:q=>createBinaryParser(q.binaryPlusMinusField,q.binaryCompareOp,Fields.binaryOp),binaryBooleanField:q=>createBinaryParser(q.binaryCompareField,q.binaryBooleanOp,Fields.binaryOp),binaryOpField:q=>q.binaryBooleanField,field:q=>q.binaryOpField});function parseField(text){try{return Result.success(EXPRESSION.field.tryParse(text))}catch(error){return Result.failure(""+error)}}var QueryFields;(function(QueryFields2){function named(name,field){return{name,field}}QueryFields2.named=named;function sortBy(field,dir2){return{field,direction:dir2}}QueryFields2.sortBy=sortBy})(QueryFields||(QueryFields={}));function captureRaw(base){return parsimmon_umd_minExports.custom((success,failure)=>(input,i)=>{let result=base._(input,i);return result.status?Object.assign({},result,{value:[result.value,input.substring(i,result.index)]}):result})}function stripNewlines(text){return text.split(/[\r\n]+/).map(t2=>t2.trim()).join("")}function precededByWhitespaceIfNotEof(if_eof,parser){return parsimmon_umd_minExports.eof.map(if_eof).or(parsimmon_umd_minExports.whitespace.then(parser))}var QUERY_LANGUAGE=parsimmon_umd_minExports.createLanguage({queryType:q=>parsimmon_umd_minExports.alt(parsimmon_umd_minExports.regexp(/TABLE|LIST|TASK|CALENDAR/i)).map(str=>str.toLowerCase()).desc("query type ('TABLE', 'LIST', 'TASK', or 'CALENDAR')"),explicitNamedField:q=>parsimmon_umd_minExports.seqMap(EXPRESSION.field.skip(parsimmon_umd_minExports.whitespace),parsimmon_umd_minExports.regexp(/AS/i).skip(parsimmon_umd_minExports.whitespace),EXPRESSION.identifier.or(EXPRESSION.string),(field,_as,ident)=>QueryFields.named(ident,field)),comment:()=>parsimmon_umd_minExports.Parser((input,i)=>{let line=input.substring(i);if(!line.startsWith("//"))return parsimmon_umd_minExports.makeFailure(i,"Not a comment");line=line.split(`
`)[0];let comment=line.substring(2).trim();return parsimmon_umd_minExports.makeSuccess(i+line.length,comment)}),namedField:q=>parsimmon_umd_minExports.alt(q.explicitNamedField,captureRaw(EXPRESSION.field).map(([value,text])=>QueryFields.named(stripNewlines(text),value))),sortField:q=>parsimmon_umd_minExports.seqMap(EXPRESSION.field.skip(parsimmon_umd_minExports.optWhitespace),parsimmon_umd_minExports.regexp(/ASCENDING|DESCENDING|ASC|DESC/i).atMost(1),(field,dir2)=>{let direction=dir2.length==0?"ascending":dir2[0].toLowerCase();return direction=="desc"&&(direction="descending"),direction=="asc"&&(direction="ascending"),{field,direction}}),headerClause:q=>q.queryType.chain(type=>{switch(type){case"table":return precededByWhitespaceIfNotEof(()=>({type,fields:[],showId:!0}),parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.regexp(/WITHOUT\s+ID/i).skip(parsimmon_umd_minExports.optWhitespace).atMost(1),parsimmon_umd_minExports.sepBy(q.namedField,parsimmon_umd_minExports.string(",").trim(parsimmon_umd_minExports.optWhitespace)),(withoutId,fields)=>({type,fields,showId:withoutId.length==0})));case"list":return precededByWhitespaceIfNotEof(()=>({type,format:void 0,showId:!0}),parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.regexp(/WITHOUT\s+ID/i).skip(parsimmon_umd_minExports.optWhitespace).atMost(1),EXPRESSION.field.atMost(1),(withoutId,format)=>({type,format:format.length==1?format[0]:void 0,showId:withoutId.length==0})));case"task":return parsimmon_umd_minExports.succeed({type});case"calendar":return parsimmon_umd_minExports.whitespace.then(parsimmon_umd_minExports.seqMap(q.namedField,field=>({type,showId:!0,field})));default:return parsimmon_umd_minExports.fail(`Unrecognized query type '${type}'`)}}).desc("TABLE or LIST or TASK or CALENDAR"),fromClause:q=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.regexp(/FROM/i),parsimmon_umd_minExports.whitespace,EXPRESSION.source,(_1,_2,source)=>source),whereClause:q=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.regexp(/WHERE/i),parsimmon_umd_minExports.whitespace,EXPRESSION.field,(where,_,field)=>({type:"where",clause:field})).desc("WHERE <expression>"),sortByClause:q=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.regexp(/SORT/i),parsimmon_umd_minExports.whitespace,q.sortField.sepBy1(parsimmon_umd_minExports.string(",").trim(parsimmon_umd_minExports.optWhitespace)),(sort,_1,fields)=>({type:"sort",fields})).desc("SORT field [ASC/DESC]"),limitClause:q=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.regexp(/LIMIT/i),parsimmon_umd_minExports.whitespace,EXPRESSION.field,(limit,_1,field)=>({type:"limit",amount:field})).desc("LIMIT <value>"),flattenClause:q=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.regexp(/FLATTEN/i).skip(parsimmon_umd_minExports.whitespace),q.namedField,(_,field)=>({type:"flatten",field})).desc("FLATTEN <value> [AS <name>]"),groupByClause:q=>parsimmon_umd_minExports.seqMap(parsimmon_umd_minExports.regexp(/GROUP BY/i).skip(parsimmon_umd_minExports.whitespace),q.namedField,(_,field)=>({type:"group",field})).desc("GROUP BY <value> [AS <name>]"),clause:q=>parsimmon_umd_minExports.alt(q.fromClause,q.whereClause,q.sortByClause,q.limitClause,q.groupByClause,q.flattenClause),query:q=>parsimmon_umd_minExports.seqMap(q.headerClause.trim(optionalWhitespaceOrComment),q.fromClause.trim(optionalWhitespaceOrComment).atMost(1),q.clause.trim(optionalWhitespaceOrComment).many(),(header,from,clauses)=>({header,source:from.length==0?Sources.folder(""):from[0],operations:clauses,settings:DEFAULT_QUERY_SETTINGS}))}),optionalWhitespaceOrComment=parsimmon_umd_minExports.alt(parsimmon_umd_minExports.whitespace,QUERY_LANGUAGE.comment).many().map(arr=>arr.join("")),getAPI2=app=>app?app.plugins.plugins.dataview?.api:window.DataviewAPI,isPluginEnabled2=app=>app.plugins.enabledPlugins.has("dataview");exports.DATE_SHORTHANDS=DATE_SHORTHANDS;exports.DURATION_TYPES=DURATION_TYPES;exports.EXPRESSION=EXPRESSION;exports.KEYWORDS=KEYWORDS;exports.QUERY_LANGUAGE=QUERY_LANGUAGE;exports.getAPI=getAPI2;exports.isPluginEnabled=isPluginEnabled2;exports.parseField=parseField}});var main_exports={};__export(main_exports,{default:()=>EnhancedCopy});module.exports=__toCommonJS(main_exports);var import_view=require("@codemirror/view");var isString=obj=>typeof obj=="string",defer=()=>{let res,rej,promise=new Promise((resolve,reject)=>{res=resolve,rej=reject});return promise.resolve=res,promise.reject=rej,promise},makeString=object=>object==null?"":""+object,copy=(a,s,t2)=>{a.forEach(m=>{s[m]&&(t2[m]=s[m])})},lastOfPathSeparatorRegExp=/###/g,cleanKey=key=>key&&key.indexOf("###")>-1?key.replace(lastOfPathSeparatorRegExp,"."):key,canNotTraverseDeeper=object=>!object||isString(object),getLastOfPath=(object,path,Empty)=>{let stack=isString(path)?path.split("."):path,stackIndex=0;for(;stackIndex<stack.length-1;){if(canNotTraverseDeeper(object))return{};let key=cleanKey(stack[stackIndex]);!object[key]&&Empty&&(object[key]=new Empty),Object.prototype.hasOwnProperty.call(object,key)?object=object[key]:object={},++stackIndex}return canNotTraverseDeeper(object)?{}:{obj:object,k:cleanKey(stack[stackIndex])}},setPath=(object,path,newValue)=>{let{obj,k}=getLastOfPath(object,path,Object);if(obj!==void 0||path.length===1){obj[k]=newValue;return}let e=path[path.length-1],p=path.slice(0,path.length-1),last=getLastOfPath(object,p,Object);for(;last.obj===void 0&&p.length;)e=`${p[p.length-1]}.${e}`,p=p.slice(0,p.length-1),last=getLastOfPath(object,p,Object),last&&last.obj&&typeof last.obj[`${last.k}.${e}`]<"u"&&(last.obj=void 0);last.obj[`${last.k}.${e}`]=newValue},pushPath=(object,path,newValue,concat)=>{let{obj,k}=getLastOfPath(object,path,Object);obj[k]=obj[k]||[],obj[k].push(newValue)},getPath=(object,path)=>{let{obj,k}=getLastOfPath(object,path);if(obj)return obj[k]},getPathWithDefaults=(data,defaultData,key)=>{let value=getPath(data,key);return value!==void 0?value:getPath(defaultData,key)},deepExtend=(target,source,overwrite)=>{for(let prop in source)prop!=="__proto__"&&prop!=="constructor"&&(prop in target?isString(target[prop])||target[prop]instanceof String||isString(source[prop])||source[prop]instanceof String?overwrite&&(target[prop]=source[prop]):deepExtend(target[prop],source[prop],overwrite):target[prop]=source[prop]);return target},regexEscape=str=>str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),_entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},escape=data=>isString(data)?data.replace(/[&<>"'\/]/g,s=>_entityMap[s]):data,RegExpCache=class{constructor(capacity){this.capacity=capacity,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(pattern){let regExpFromCache=this.regExpMap.get(pattern);if(regExpFromCache!==void 0)return regExpFromCache;let regExpNew=new RegExp(pattern);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(pattern,regExpNew),this.regExpQueue.push(pattern),regExpNew}},chars=[" ",",","?","!",";"],looksLikeObjectPathRegExpCache=new RegExpCache(20),looksLikeObjectPath=(key,nsSeparator,keySeparator)=>{nsSeparator=nsSeparator||"",keySeparator=keySeparator||"";let possibleChars=chars.filter(c=>nsSeparator.indexOf(c)<0&&keySeparator.indexOf(c)<0);if(possibleChars.length===0)return!0;let r=looksLikeObjectPathRegExpCache.getRegExp(`(${possibleChars.map(c=>c==="?"?"\\?":c).join("|")})`),matched=!r.test(key);if(!matched){let ki=key.indexOf(keySeparator);ki>0&&!r.test(key.substring(0,ki))&&(matched=!0)}return matched},deepFind=function(obj,path){let keySeparator=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!obj)return;if(obj[path])return obj[path];let tokens=path.split(keySeparator),current=obj;for(let i=0;i<tokens.length;){if(!current||typeof current!="object")return;let next,nextPath="";for(let j=i;j<tokens.length;++j)if(j!==i&&(nextPath+=keySeparator),nextPath+=tokens[j],next=current[nextPath],next!==void 0){if(["string","number","boolean"].indexOf(typeof next)>-1&&j<tokens.length-1)continue;i+=j-i+1;break}current=next}return current},getCleanedCode=code=>code&&code.replace("_","-"),consoleLogger={type:"logger",log(args){this.output("log",args)},warn(args){this.output("warn",args)},error(args){this.output("error",args)},output(type,args){console&&console[type]&&console[type].apply(console,args)}},Logger=class _Logger{constructor(concreteLogger){let options=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(concreteLogger,options)}init(concreteLogger){let options=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=options.prefix||"i18next:",this.logger=concreteLogger||consoleLogger,this.options=options,this.debug=options.debug}log(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return this.forward(args,"log","",!0)}warn(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return this.forward(args,"warn","",!0)}error(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=arguments[_key3];return this.forward(args,"error","")}deprecate(){for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++)args[_key4]=arguments[_key4];return this.forward(args,"warn","WARNING DEPRECATED: ",!0)}forward(args,lvl,prefix,debugOnly){return debugOnly&&!this.debug?null:(isString(args[0])&&(args[0]=`${prefix}${this.prefix} ${args[0]}`),this.logger[lvl](args))}create(moduleName){return new _Logger(this.logger,{prefix:`${this.prefix}:${moduleName}:`,...this.options})}clone(options){return options=options||this.options,options.prefix=options.prefix||this.prefix,new _Logger(this.logger,options)}},baseLogger=new Logger,EventEmitter=class{constructor(){this.observers={}}on(events,listener){return events.split(" ").forEach(event=>{this.observers[event]||(this.observers[event]=new Map);let numListeners=this.observers[event].get(listener)||0;this.observers[event].set(listener,numListeners+1)}),this}off(event,listener){if(this.observers[event]){if(!listener){delete this.observers[event];return}this.observers[event].delete(listener)}}emit(event){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];this.observers[event]&&Array.from(this.observers[event].entries()).forEach(_ref=>{let[observer,numTimesAdded]=_ref;for(let i=0;i<numTimesAdded;i++)observer(...args)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(_ref2=>{let[observer,numTimesAdded]=_ref2;for(let i=0;i<numTimesAdded;i++)observer.apply(observer,[event,...args])})}},ResourceStore=class extends EventEmitter{constructor(data){let options=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=data||{},this.options=options,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(ns){this.options.ns.indexOf(ns)<0&&this.options.ns.push(ns)}removeNamespaces(ns){let index=this.options.ns.indexOf(ns);index>-1&&this.options.ns.splice(index,1)}getResource(lng,ns,key){let options=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},keySeparator=options.keySeparator!==void 0?options.keySeparator:this.options.keySeparator,ignoreJSONStructure=options.ignoreJSONStructure!==void 0?options.ignoreJSONStructure:this.options.ignoreJSONStructure,path;lng.indexOf(".")>-1?path=lng.split("."):(path=[lng,ns],key&&(Array.isArray(key)?path.push(...key):isString(key)&&keySeparator?path.push(...key.split(keySeparator)):path.push(key)));let result=getPath(this.data,path);return!result&&!ns&&!key&&lng.indexOf(".")>-1&&(lng=path[0],ns=path[1],key=path.slice(2).join(".")),result||!ignoreJSONStructure||!isString(key)?result:deepFind(this.data&&this.data[lng]&&this.data[lng][ns],key,keySeparator)}addResource(lng,ns,key,value){let options=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1},keySeparator=options.keySeparator!==void 0?options.keySeparator:this.options.keySeparator,path=[lng,ns];key&&(path=path.concat(keySeparator?key.split(keySeparator):key)),lng.indexOf(".")>-1&&(path=lng.split("."),value=ns,ns=path[1]),this.addNamespaces(ns),setPath(this.data,path,value),options.silent||this.emit("added",lng,ns,key,value)}addResources(lng,ns,resources2){let options=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(let m in resources2)(isString(resources2[m])||Array.isArray(resources2[m]))&&this.addResource(lng,ns,m,resources2[m],{silent:!0});options.silent||this.emit("added",lng,ns,resources2)}addResourceBundle(lng,ns,resources2,deep,overwrite){let options=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},path=[lng,ns];lng.indexOf(".")>-1&&(path=lng.split("."),deep=resources2,resources2=ns,ns=path[1]),this.addNamespaces(ns);let pack=getPath(this.data,path)||{};options.skipCopy||(resources2=JSON.parse(JSON.stringify(resources2))),deep?deepExtend(pack,resources2,overwrite):pack={...pack,...resources2},setPath(this.data,path,pack),options.silent||this.emit("added",lng,ns,resources2)}removeResourceBundle(lng,ns){this.hasResourceBundle(lng,ns)&&delete this.data[lng][ns],this.removeNamespaces(ns),this.emit("removed",lng,ns)}hasResourceBundle(lng,ns){return this.getResource(lng,ns)!==void 0}getResourceBundle(lng,ns){return ns||(ns=this.options.defaultNS),this.options.compatibilityAPI==="v1"?{...this.getResource(lng,ns)}:this.getResource(lng,ns)}getDataByLanguage(lng){return this.data[lng]}hasLanguageSomeTranslations(lng){let data=this.getDataByLanguage(lng);return!!(data&&Object.keys(data)||[]).find(v=>data[v]&&Object.keys(data[v]).length>0)}toJSON(){return this.data}},postProcessor={processors:{},addPostProcessor(module2){this.processors[module2.name]=module2},handle(processors,value,key,options,translator){return processors.forEach(processor=>{this.processors[processor]&&(value=this.processors[processor].process(value,key,options,translator))}),value}},checkedLoadedFor={},Translator=class _Translator extends EventEmitter{constructor(services){let options=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),copy(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],services,this),this.options=options,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=baseLogger.create("translator")}changeLanguage(lng){lng&&(this.language=lng)}exists(key){let options=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(key==null)return!1;let resolved=this.resolve(key,options);return resolved&&resolved.res!==void 0}extractFromKey(key,options){let nsSeparator=options.nsSeparator!==void 0?options.nsSeparator:this.options.nsSeparator;nsSeparator===void 0&&(nsSeparator=":");let keySeparator=options.keySeparator!==void 0?options.keySeparator:this.options.keySeparator,namespaces=options.ns||this.options.defaultNS||[],wouldCheckForNsInKey=nsSeparator&&key.indexOf(nsSeparator)>-1,seemsNaturalLanguage=!this.options.userDefinedKeySeparator&&!options.keySeparator&&!this.options.userDefinedNsSeparator&&!options.nsSeparator&&!looksLikeObjectPath(key,nsSeparator,keySeparator);if(wouldCheckForNsInKey&&!seemsNaturalLanguage){let m=key.match(this.interpolator.nestingRegexp);if(m&&m.length>0)return{key,namespaces};let parts=key.split(nsSeparator);(nsSeparator!==keySeparator||nsSeparator===keySeparator&&this.options.ns.indexOf(parts[0])>-1)&&(namespaces=parts.shift()),key=parts.join(keySeparator)}return isString(namespaces)&&(namespaces=[namespaces]),{key,namespaces}}translate(keys,options,lastKey){if(typeof options!="object"&&this.options.overloadTranslationOptionHandler&&(options=this.options.overloadTranslationOptionHandler(arguments)),typeof options=="object"&&(options={...options}),options||(options={}),keys==null)return"";Array.isArray(keys)||(keys=[String(keys)]);let returnDetails=options.returnDetails!==void 0?options.returnDetails:this.options.returnDetails,keySeparator=options.keySeparator!==void 0?options.keySeparator:this.options.keySeparator,{key,namespaces}=this.extractFromKey(keys[keys.length-1],options),namespace=namespaces[namespaces.length-1],lng=options.lng||this.language,appendNamespaceToCIMode=options.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(lng&&lng.toLowerCase()==="cimode"){if(appendNamespaceToCIMode){let nsSeparator=options.nsSeparator||this.options.nsSeparator;return returnDetails?{res:`${namespace}${nsSeparator}${key}`,usedKey:key,exactUsedKey:key,usedLng:lng,usedNS:namespace,usedParams:this.getUsedParamsDetails(options)}:`${namespace}${nsSeparator}${key}`}return returnDetails?{res:key,usedKey:key,exactUsedKey:key,usedLng:lng,usedNS:namespace,usedParams:this.getUsedParamsDetails(options)}:key}let resolved=this.resolve(keys,options),res=resolved&&resolved.res,resUsedKey=resolved&&resolved.usedKey||key,resExactUsedKey=resolved&&resolved.exactUsedKey||key,resType=Object.prototype.toString.apply(res),noObject=["[object Number]","[object Function]","[object RegExp]"],joinArrays=options.joinArrays!==void 0?options.joinArrays:this.options.joinArrays,handleAsObjectInI18nFormat=!this.i18nFormat||this.i18nFormat.handleAsObject,handleAsObject=!isString(res)&&typeof res!="boolean"&&typeof res!="number";if(handleAsObjectInI18nFormat&&res&&handleAsObject&&noObject.indexOf(resType)<0&&!(isString(joinArrays)&&Array.isArray(res))){if(!options.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");let r=this.options.returnedObjectHandler?this.options.returnedObjectHandler(resUsedKey,res,{...options,ns:namespaces}):`key '${key} (${this.language})' returned an object instead of string.`;return returnDetails?(resolved.res=r,resolved.usedParams=this.getUsedParamsDetails(options),resolved):r}if(keySeparator){let resTypeIsArray=Array.isArray(res),copy2=resTypeIsArray?[]:{},newKeyToUse=resTypeIsArray?resExactUsedKey:resUsedKey;for(let m in res)if(Object.prototype.hasOwnProperty.call(res,m)){let deepKey=`${newKeyToUse}${keySeparator}${m}`;copy2[m]=this.translate(deepKey,{...options,joinArrays:!1,ns:namespaces}),copy2[m]===deepKey&&(copy2[m]=res[m])}res=copy2}}else if(handleAsObjectInI18nFormat&&isString(joinArrays)&&Array.isArray(res))res=res.join(joinArrays),res&&(res=this.extendTranslation(res,keys,options,lastKey));else{let usedDefault=!1,usedKey=!1,needsPluralHandling=options.count!==void 0&&!isString(options.count),hasDefaultValue=_Translator.hasDefaultValue(options),defaultValueSuffix=needsPluralHandling?this.pluralResolver.getSuffix(lng,options.count,options):"",defaultValueSuffixOrdinalFallback=options.ordinal&&needsPluralHandling?this.pluralResolver.getSuffix(lng,options.count,{ordinal:!1}):"",needsZeroSuffixLookup=needsPluralHandling&&!options.ordinal&&options.count===0&&this.pluralResolver.shouldUseIntlApi(),defaultValue=needsZeroSuffixLookup&&options[`defaultValue${this.options.pluralSeparator}zero`]||options[`defaultValue${defaultValueSuffix}`]||options[`defaultValue${defaultValueSuffixOrdinalFallback}`]||options.defaultValue;!this.isValidLookup(res)&&hasDefaultValue&&(usedDefault=!0,res=defaultValue),this.isValidLookup(res)||(usedKey=!0,res=key);let resForMissing=(options.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&usedKey?void 0:res,updateMissing=hasDefaultValue&&defaultValue!==res&&this.options.updateMissing;if(usedKey||usedDefault||updateMissing){if(this.logger.log(updateMissing?"updateKey":"missingKey",lng,namespace,key,updateMissing?defaultValue:res),keySeparator){let fk=this.resolve(key,{...options,keySeparator:!1});fk&&fk.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let lngs=[],fallbackLngs=this.languageUtils.getFallbackCodes(this.options.fallbackLng,options.lng||this.language);if(this.options.saveMissingTo==="fallback"&&fallbackLngs&&fallbackLngs[0])for(let i=0;i<fallbackLngs.length;i++)lngs.push(fallbackLngs[i]);else this.options.saveMissingTo==="all"?lngs=this.languageUtils.toResolveHierarchy(options.lng||this.language):lngs.push(options.lng||this.language);let send=(l,k,specificDefaultValue)=>{let defaultForMissing=hasDefaultValue&&specificDefaultValue!==res?specificDefaultValue:resForMissing;this.options.missingKeyHandler?this.options.missingKeyHandler(l,namespace,k,defaultForMissing,updateMissing,options):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(l,namespace,k,defaultForMissing,updateMissing,options),this.emit("missingKey",l,namespace,k,res)};this.options.saveMissing&&(this.options.saveMissingPlurals&&needsPluralHandling?lngs.forEach(language=>{let suffixes=this.pluralResolver.getSuffixes(language,options);needsZeroSuffixLookup&&options[`defaultValue${this.options.pluralSeparator}zero`]&&suffixes.indexOf(`${this.options.pluralSeparator}zero`)<0&&suffixes.push(`${this.options.pluralSeparator}zero`),suffixes.forEach(suffix=>{send([language],key+suffix,options[`defaultValue${suffix}`]||defaultValue)})}):send(lngs,key,defaultValue))}res=this.extendTranslation(res,keys,options,resolved,lastKey),usedKey&&res===key&&this.options.appendNamespaceToMissingKey&&(res=`${namespace}:${key}`),(usedKey||usedDefault)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?res=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${namespace}:${key}`:key,usedDefault?res:void 0):res=this.options.parseMissingKeyHandler(res))}return returnDetails?(resolved.res=res,resolved.usedParams=this.getUsedParamsDetails(options),resolved):res}extendTranslation(res,key,options,resolved,lastKey){var _this=this;if(this.i18nFormat&&this.i18nFormat.parse)res=this.i18nFormat.parse(res,{...this.options.interpolation.defaultVariables,...options},options.lng||this.language||resolved.usedLng,resolved.usedNS,resolved.usedKey,{resolved});else if(!options.skipInterpolation){options.interpolation&&this.interpolator.init({...options,interpolation:{...this.options.interpolation,...options.interpolation}});let skipOnVariables=isString(res)&&(options&&options.interpolation&&options.interpolation.skipOnVariables!==void 0?options.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables),nestBef;if(skipOnVariables){let nb=res.match(this.interpolator.nestingRegexp);nestBef=nb&&nb.length}let data=options.replace&&!isString(options.replace)?options.replace:options;if(this.options.interpolation.defaultVariables&&(data={...this.options.interpolation.defaultVariables,...data}),res=this.interpolator.interpolate(res,data,options.lng||this.language||resolved.usedLng,options),skipOnVariables){let na=res.match(this.interpolator.nestingRegexp),nestAft=na&&na.length;nestBef<nestAft&&(options.nest=!1)}!options.lng&&this.options.compatibilityAPI!=="v1"&&resolved&&resolved.res&&(options.lng=this.language||resolved.usedLng),options.nest!==!1&&(res=this.interpolator.nest(res,function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return lastKey&&lastKey[0]===args[0]&&!options.context?(_this.logger.warn(`It seems you are nesting recursively key: ${args[0]} in key: ${key[0]}`),null):_this.translate(...args,key)},options)),options.interpolation&&this.interpolator.reset()}let postProcess=options.postProcess||this.options.postProcess,postProcessorNames=isString(postProcess)?[postProcess]:postProcess;return res!=null&&postProcessorNames&&postProcessorNames.length&&options.applyPostProcessor!==!1&&(res=postProcessor.handle(postProcessorNames,res,key,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...resolved,usedParams:this.getUsedParamsDetails(options)},...options}:options,this)),res}resolve(keys){let options=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},found,usedKey,exactUsedKey,usedLng,usedNS;return isString(keys)&&(keys=[keys]),keys.forEach(k=>{if(this.isValidLookup(found))return;let extracted=this.extractFromKey(k,options),key=extracted.key;usedKey=key;let namespaces=extracted.namespaces;this.options.fallbackNS&&(namespaces=namespaces.concat(this.options.fallbackNS));let needsPluralHandling=options.count!==void 0&&!isString(options.count),needsZeroSuffixLookup=needsPluralHandling&&!options.ordinal&&options.count===0&&this.pluralResolver.shouldUseIntlApi(),needsContextHandling=options.context!==void 0&&(isString(options.context)||typeof options.context=="number")&&options.context!=="",codes=options.lngs?options.lngs:this.languageUtils.toResolveHierarchy(options.lng||this.language,options.fallbackLng);namespaces.forEach(ns=>{this.isValidLookup(found)||(usedNS=ns,!checkedLoadedFor[`${codes[0]}-${ns}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(usedNS)&&(checkedLoadedFor[`${codes[0]}-${ns}`]=!0,this.logger.warn(`key "${usedKey}" for languages "${codes.join(", ")}" won't get resolved as namespace "${usedNS}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),codes.forEach(code=>{if(this.isValidLookup(found))return;usedLng=code;let finalKeys=[key];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(finalKeys,key,code,ns,options);else{let pluralSuffix;needsPluralHandling&&(pluralSuffix=this.pluralResolver.getSuffix(code,options.count,options));let zeroSuffix=`${this.options.pluralSeparator}zero`,ordinalPrefix=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(needsPluralHandling&&(finalKeys.push(key+pluralSuffix),options.ordinal&&pluralSuffix.indexOf(ordinalPrefix)===0&&finalKeys.push(key+pluralSuffix.replace(ordinalPrefix,this.options.pluralSeparator)),needsZeroSuffixLookup&&finalKeys.push(key+zeroSuffix)),needsContextHandling){let contextKey=`${key}${this.options.contextSeparator}${options.context}`;finalKeys.push(contextKey),needsPluralHandling&&(finalKeys.push(contextKey+pluralSuffix),options.ordinal&&pluralSuffix.indexOf(ordinalPrefix)===0&&finalKeys.push(contextKey+pluralSuffix.replace(ordinalPrefix,this.options.pluralSeparator)),needsZeroSuffixLookup&&finalKeys.push(contextKey+zeroSuffix))}}let possibleKey;for(;possibleKey=finalKeys.pop();)this.isValidLookup(found)||(exactUsedKey=possibleKey,found=this.getResource(code,ns,possibleKey,options))}))})}),{res:found,usedKey,exactUsedKey,usedLng,usedNS}}isValidLookup(res){return res!==void 0&&!(!this.options.returnNull&&res===null)&&!(!this.options.returnEmptyString&&res==="")}getResource(code,ns,key){let options=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(code,ns,key,options):this.resourceStore.getResource(code,ns,key,options)}getUsedParamsDetails(){let options=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},optionsKeys=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],useOptionsReplaceForData=options.replace&&!isString(options.replace),data=useOptionsReplaceForData?options.replace:options;if(useOptionsReplaceForData&&typeof options.count<"u"&&(data.count=options.count),this.options.interpolation.defaultVariables&&(data={...this.options.interpolation.defaultVariables,...data}),!useOptionsReplaceForData){data={...data};for(let key of optionsKeys)delete data[key]}return data}static hasDefaultValue(options){let prefix="defaultValue";for(let option in options)if(Object.prototype.hasOwnProperty.call(options,option)&&prefix===option.substring(0,prefix.length)&&options[option]!==void 0)return!0;return!1}},capitalize=string=>string.charAt(0).toUpperCase()+string.slice(1),LanguageUtil=class{constructor(options){this.options=options,this.supportedLngs=this.options.supportedLngs||!1,this.logger=baseLogger.create("languageUtils")}getScriptPartFromCode(code){if(code=getCleanedCode(code),!code||code.indexOf("-")<0)return null;let p=code.split("-");return p.length===2||(p.pop(),p[p.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(p.join("-"))}getLanguagePartFromCode(code){if(code=getCleanedCode(code),!code||code.indexOf("-")<0)return code;let p=code.split("-");return this.formatLanguageCode(p[0])}formatLanguageCode(code){if(isString(code)&&code.indexOf("-")>-1){if(typeof Intl<"u"&&typeof Intl.getCanonicalLocales<"u")try{let formattedCode=Intl.getCanonicalLocales(code)[0];if(formattedCode&&this.options.lowerCaseLng&&(formattedCode=formattedCode.toLowerCase()),formattedCode)return formattedCode}catch{}let specialCases=["hans","hant","latn","cyrl","cans","mong","arab"],p=code.split("-");return this.options.lowerCaseLng?p=p.map(part=>part.toLowerCase()):p.length===2?(p[0]=p[0].toLowerCase(),p[1]=p[1].toUpperCase(),specialCases.indexOf(p[1].toLowerCase())>-1&&(p[1]=capitalize(p[1].toLowerCase()))):p.length===3&&(p[0]=p[0].toLowerCase(),p[1].length===2&&(p[1]=p[1].toUpperCase()),p[0]!=="sgn"&&p[2].length===2&&(p[2]=p[2].toUpperCase()),specialCases.indexOf(p[1].toLowerCase())>-1&&(p[1]=capitalize(p[1].toLowerCase())),specialCases.indexOf(p[2].toLowerCase())>-1&&(p[2]=capitalize(p[2].toLowerCase()))),p.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?code.toLowerCase():code}isSupportedCode(code){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(code=this.getLanguagePartFromCode(code)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(code)>-1}getBestMatchFromCodes(codes){if(!codes)return null;let found;return codes.forEach(code=>{if(found)return;let cleanedLng=this.formatLanguageCode(code);(!this.options.supportedLngs||this.isSupportedCode(cleanedLng))&&(found=cleanedLng)}),!found&&this.options.supportedLngs&&codes.forEach(code=>{if(found)return;let lngOnly=this.getLanguagePartFromCode(code);if(this.isSupportedCode(lngOnly))return found=lngOnly;found=this.options.supportedLngs.find(supportedLng=>{if(supportedLng===lngOnly)return supportedLng;if(!(supportedLng.indexOf("-")<0&&lngOnly.indexOf("-")<0)&&(supportedLng.indexOf("-")>0&&lngOnly.indexOf("-")<0&&supportedLng.substring(0,supportedLng.indexOf("-"))===lngOnly||supportedLng.indexOf(lngOnly)===0&&lngOnly.length>1))return supportedLng})}),found||(found=this.getFallbackCodes(this.options.fallbackLng)[0]),found}getFallbackCodes(fallbacks,code){if(!fallbacks)return[];if(typeof fallbacks=="function"&&(fallbacks=fallbacks(code)),isString(fallbacks)&&(fallbacks=[fallbacks]),Array.isArray(fallbacks))return fallbacks;if(!code)return fallbacks.default||[];let found=fallbacks[code];return found||(found=fallbacks[this.getScriptPartFromCode(code)]),found||(found=fallbacks[this.formatLanguageCode(code)]),found||(found=fallbacks[this.getLanguagePartFromCode(code)]),found||(found=fallbacks.default),found||[]}toResolveHierarchy(code,fallbackCode){let fallbackCodes=this.getFallbackCodes(fallbackCode||this.options.fallbackLng||[],code),codes=[],addCode=c=>{c&&(this.isSupportedCode(c)?codes.push(c):this.logger.warn(`rejecting language code not found in supportedLngs: ${c}`))};return isString(code)&&(code.indexOf("-")>-1||code.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&addCode(this.formatLanguageCode(code)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&addCode(this.getScriptPartFromCode(code)),this.options.load!=="currentOnly"&&addCode(this.getLanguagePartFromCode(code))):isString(code)&&addCode(this.formatLanguageCode(code)),fallbackCodes.forEach(fc=>{codes.indexOf(fc)<0&&addCode(this.formatLanguageCode(fc))}),codes}},sets=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],_rulesPluralsTypes={1:n=>+(n>1),2:n=>+(n!=1),3:n=>0,4:n=>n%10==1&&n%100!=11?0:n%10>=2&&n%10<=4&&(n%100<10||n%100>=20)?1:2,5:n=>n==0?0:n==1?1:n==2?2:n%100>=3&&n%100<=10?3:n%100>=11?4:5,6:n=>n==1?0:n>=2&&n<=4?1:2,7:n=>n==1?0:n%10>=2&&n%10<=4&&(n%100<10||n%100>=20)?1:2,8:n=>n==1?0:n==2?1:n!=8&&n!=11?2:3,9:n=>+(n>=2),10:n=>n==1?0:n==2?1:n<7?2:n<11?3:4,11:n=>n==1||n==11?0:n==2||n==12?1:n>2&&n<20?2:3,12:n=>+(n%10!=1||n%100==11),13:n=>+(n!==0),14:n=>n==1?0:n==2?1:n==3?2:3,15:n=>n%10==1&&n%100!=11?0:n%10>=2&&(n%100<10||n%100>=20)?1:2,16:n=>n%10==1&&n%100!=11?0:n!==0?1:2,17:n=>n==1||n%10==1&&n%100!=11?0:1,18:n=>n==0?0:n==1?1:2,19:n=>n==1?0:n==0||n%100>1&&n%100<11?1:n%100>10&&n%100<20?2:3,20:n=>n==1?0:n==0||n%100>0&&n%100<20?1:2,21:n=>n%100==1?1:n%100==2?2:n%100==3||n%100==4?3:0,22:n=>n==1?0:n==2?1:(n<0||n>10)&&n%10==0?2:3},nonIntlVersions=["v1","v2","v3"],intlVersions=["v4"],suffixesOrder={zero:0,one:1,two:2,few:3,many:4,other:5},createRules=()=>{let rules={};return sets.forEach(set=>{set.lngs.forEach(l=>{rules[l]={numbers:set.nr,plurals:_rulesPluralsTypes[set.fc]}})}),rules},PluralResolver=class{constructor(languageUtils){let options=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=languageUtils,this.options=options,this.logger=baseLogger.create("pluralResolver"),(!this.options.compatibilityJSON||intlVersions.includes(this.options.compatibilityJSON))&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=createRules(),this.pluralRulesCache={}}addRule(lng,obj){this.rules[lng]=obj}clearCache(){this.pluralRulesCache={}}getRule(code){let options=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi())try{let cleanedCode=getCleanedCode(code==="dev"?"en":code),type=options.ordinal?"ordinal":"cardinal",cacheKey=JSON.stringify({cleanedCode,type});if(cacheKey in this.pluralRulesCache)return this.pluralRulesCache[cacheKey];let rule=new Intl.PluralRules(cleanedCode,{type});return this.pluralRulesCache[cacheKey]=rule,rule}catch{return}return this.rules[code]||this.rules[this.languageUtils.getLanguagePartFromCode(code)]}needsPlural(code){let options=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},rule=this.getRule(code,options);return this.shouldUseIntlApi()?rule&&rule.resolvedOptions().pluralCategories.length>1:rule&&rule.numbers.length>1}getPluralFormsOfKey(code,key){let options=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(code,options).map(suffix=>`${key}${suffix}`)}getSuffixes(code){let options=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},rule=this.getRule(code,options);return rule?this.shouldUseIntlApi()?rule.resolvedOptions().pluralCategories.sort((pluralCategory1,pluralCategory2)=>suffixesOrder[pluralCategory1]-suffixesOrder[pluralCategory2]).map(pluralCategory=>`${this.options.prepend}${options.ordinal?`ordinal${this.options.prepend}`:""}${pluralCategory}`):rule.numbers.map(number=>this.getSuffix(code,number,options)):[]}getSuffix(code,count){let options=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},rule=this.getRule(code,options);return rule?this.shouldUseIntlApi()?`${this.options.prepend}${options.ordinal?`ordinal${this.options.prepend}`:""}${rule.select(count)}`:this.getSuffixRetroCompatible(rule,count):(this.logger.warn(`no plural rule found for: ${code}`),"")}getSuffixRetroCompatible(rule,count){let idx=rule.noAbs?rule.plurals(count):rule.plurals(Math.abs(count)),suffix=rule.numbers[idx];this.options.simplifyPluralSuffix&&rule.numbers.length===2&&rule.numbers[0]===1&&(suffix===2?suffix="plural":suffix===1&&(suffix=""));let returnSuffix=()=>this.options.prepend&&suffix.toString()?this.options.prepend+suffix.toString():suffix.toString();return this.options.compatibilityJSON==="v1"?suffix===1?"":typeof suffix=="number"?`_plural_${suffix.toString()}`:returnSuffix():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&rule.numbers.length===2&&rule.numbers[0]===1?returnSuffix():this.options.prepend&&idx.toString()?this.options.prepend+idx.toString():idx.toString()}shouldUseIntlApi(){return!nonIntlVersions.includes(this.options.compatibilityJSON)}},deepFindWithDefaults=function(data,defaultData,key){let keySeparator=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",ignoreJSONStructure=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,path=getPathWithDefaults(data,defaultData,key);return!path&&ignoreJSONStructure&&isString(key)&&(path=deepFind(data,key,keySeparator),path===void 0&&(path=deepFind(defaultData,key,keySeparator))),path},regexSafe=val=>val.replace(/\$/g,"$$$$"),Interpolator=class{constructor(){let options=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=baseLogger.create("interpolator"),this.options=options,this.format=options.interpolation&&options.interpolation.format||(value=>value),this.init(options)}init(){let options=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};options.interpolation||(options.interpolation={escapeValue:!0});let{escape:escape$1,escapeValue,useRawValueToEscape,prefix,prefixEscaped,suffix,suffixEscaped,formatSeparator,unescapeSuffix,unescapePrefix,nestingPrefix,nestingPrefixEscaped,nestingSuffix,nestingSuffixEscaped,nestingOptionsSeparator,maxReplaces,alwaysFormat}=options.interpolation;this.escape=escape$1!==void 0?escape$1:escape,this.escapeValue=escapeValue!==void 0?escapeValue:!0,this.useRawValueToEscape=useRawValueToEscape!==void 0?useRawValueToEscape:!1,this.prefix=prefix?regexEscape(prefix):prefixEscaped||"{{",this.suffix=suffix?regexEscape(suffix):suffixEscaped||"}}",this.formatSeparator=formatSeparator||",",this.unescapePrefix=unescapeSuffix?"":unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":unescapeSuffix||"",this.nestingPrefix=nestingPrefix?regexEscape(nestingPrefix):nestingPrefixEscaped||regexEscape("$t("),this.nestingSuffix=nestingSuffix?regexEscape(nestingSuffix):nestingSuffixEscaped||regexEscape(")"),this.nestingOptionsSeparator=nestingOptionsSeparator||",",this.maxReplaces=maxReplaces||1e3,this.alwaysFormat=alwaysFormat!==void 0?alwaysFormat:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){let getOrResetRegExp=(existingRegExp,pattern)=>existingRegExp&&existingRegExp.source===pattern?(existingRegExp.lastIndex=0,existingRegExp):new RegExp(pattern,"g");this.regexp=getOrResetRegExp(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=getOrResetRegExp(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=getOrResetRegExp(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(str,data,lng,options){let match,value,replaces,defaultData=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},handleFormat=key=>{if(key.indexOf(this.formatSeparator)<0){let path=deepFindWithDefaults(data,defaultData,key,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(path,void 0,lng,{...options,...data,interpolationkey:key}):path}let p=key.split(this.formatSeparator),k=p.shift().trim(),f=p.join(this.formatSeparator).trim();return this.format(deepFindWithDefaults(data,defaultData,k,this.options.keySeparator,this.options.ignoreJSONStructure),f,lng,{...options,...data,interpolationkey:k})};this.resetRegExp();let missingInterpolationHandler=options&&options.missingInterpolationHandler||this.options.missingInterpolationHandler,skipOnVariables=options&&options.interpolation&&options.interpolation.skipOnVariables!==void 0?options.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:val=>regexSafe(val)},{regex:this.regexp,safeValue:val=>this.escapeValue?regexSafe(this.escape(val)):regexSafe(val)}].forEach(todo=>{for(replaces=0;match=todo.regex.exec(str);){let matchedVar=match[1].trim();if(value=handleFormat(matchedVar),value===void 0)if(typeof missingInterpolationHandler=="function"){let temp=missingInterpolationHandler(str,match,options);value=isString(temp)?temp:""}else if(options&&Object.prototype.hasOwnProperty.call(options,matchedVar))value="";else if(skipOnVariables){value=match[0];continue}else this.logger.warn(`missed to pass in variable ${matchedVar} for interpolating ${str}`),value="";else!isString(value)&&!this.useRawValueToEscape&&(value=makeString(value));let safeValue=todo.safeValue(value);if(str=str.replace(match[0],safeValue),skipOnVariables?(todo.regex.lastIndex+=value.length,todo.regex.lastIndex-=match[0].length):todo.regex.lastIndex=0,replaces++,replaces>=this.maxReplaces)break}}),str}nest(str,fc){let options=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},match,value,clonedOptions,handleHasOptions=(key,inheritedOptions)=>{let sep=this.nestingOptionsSeparator;if(key.indexOf(sep)<0)return key;let c=key.split(new RegExp(`${sep}[ ]*{`)),optionsString=`{${c[1]}`;key=c[0],optionsString=this.interpolate(optionsString,clonedOptions);let matchedSingleQuotes=optionsString.match(/'/g),matchedDoubleQuotes=optionsString.match(/"/g);(matchedSingleQuotes&&matchedSingleQuotes.length%2===0&&!matchedDoubleQuotes||matchedDoubleQuotes.length%2!==0)&&(optionsString=optionsString.replace(/'/g,'"'));try{clonedOptions=JSON.parse(optionsString),inheritedOptions&&(clonedOptions={...inheritedOptions,...clonedOptions})}catch(e){return this.logger.warn(`failed parsing options string in nesting for key ${key}`,e),`${key}${sep}${optionsString}`}return clonedOptions.defaultValue&&clonedOptions.defaultValue.indexOf(this.prefix)>-1&&delete clonedOptions.defaultValue,key};for(;match=this.nestingRegexp.exec(str);){let formatters=[];clonedOptions={...options},clonedOptions=clonedOptions.replace&&!isString(clonedOptions.replace)?clonedOptions.replace:clonedOptions,clonedOptions.applyPostProcessor=!1,delete clonedOptions.defaultValue;let doReduce=!1;if(match[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(match[1])){let r=match[1].split(this.formatSeparator).map(elem=>elem.trim());match[1]=r.shift(),formatters=r,doReduce=!0}if(value=fc(handleHasOptions.call(this,match[1].trim(),clonedOptions),clonedOptions),value&&match[0]===str&&!isString(value))return value;isString(value)||(value=makeString(value)),value||(this.logger.warn(`missed to resolve ${match[1]} for nesting ${str}`),value=""),doReduce&&(value=formatters.reduce((v,f)=>this.format(v,f,options.lng,{...options,interpolationkey:match[1].trim()}),value.trim())),str=str.replace(match[0],value),this.regexp.lastIndex=0}return str}},parseFormatStr=formatStr=>{let formatName=formatStr.toLowerCase().trim(),formatOptions={};if(formatStr.indexOf("(")>-1){let p=formatStr.split("(");formatName=p[0].toLowerCase().trim();let optStr=p[1].substring(0,p[1].length-1);formatName==="currency"&&optStr.indexOf(":")<0?formatOptions.currency||(formatOptions.currency=optStr.trim()):formatName==="relativetime"&&optStr.indexOf(":")<0?formatOptions.range||(formatOptions.range=optStr.trim()):optStr.split(";").forEach(opt=>{if(opt){let[key,...rest]=opt.split(":"),val=rest.join(":").trim().replace(/^'+|'+$/g,""),trimmedKey=key.trim();formatOptions[trimmedKey]||(formatOptions[trimmedKey]=val),val==="false"&&(formatOptions[trimmedKey]=!1),val==="true"&&(formatOptions[trimmedKey]=!0),isNaN(val)||(formatOptions[trimmedKey]=parseInt(val,10))}})}return{formatName,formatOptions}},createCachedFormatter=fn=>{let cache={};return(val,lng,options)=>{let optForCache=options;options&&options.interpolationkey&&options.formatParams&&options.formatParams[options.interpolationkey]&&options[options.interpolationkey]&&(optForCache={...optForCache,[options.interpolationkey]:void 0});let key=lng+JSON.stringify(optForCache),formatter=cache[key];return formatter||(formatter=fn(getCleanedCode(lng),options),cache[key]=formatter),formatter(val)}},Formatter=class{constructor(){let options=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=baseLogger.create("formatter"),this.options=options,this.formats={number:createCachedFormatter((lng,opt)=>{let formatter=new Intl.NumberFormat(lng,{...opt});return val=>formatter.format(val)}),currency:createCachedFormatter((lng,opt)=>{let formatter=new Intl.NumberFormat(lng,{...opt,style:"currency"});return val=>formatter.format(val)}),datetime:createCachedFormatter((lng,opt)=>{let formatter=new Intl.DateTimeFormat(lng,{...opt});return val=>formatter.format(val)}),relativetime:createCachedFormatter((lng,opt)=>{let formatter=new Intl.RelativeTimeFormat(lng,{...opt});return val=>formatter.format(val,opt.range||"day")}),list:createCachedFormatter((lng,opt)=>{let formatter=new Intl.ListFormat(lng,{...opt});return val=>formatter.format(val)})},this.init(options)}init(services){let options=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=options.interpolation.formatSeparator||","}add(name,fc){this.formats[name.toLowerCase().trim()]=fc}addCached(name,fc){this.formats[name.toLowerCase().trim()]=createCachedFormatter(fc)}format(value,format,lng){let options=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},formats=format.split(this.formatSeparator);if(formats.length>1&&formats[0].indexOf("(")>1&&formats[0].indexOf(")")<0&&formats.find(f=>f.indexOf(")")>-1)){let lastIndex=formats.findIndex(f=>f.indexOf(")")>-1);formats[0]=[formats[0],...formats.splice(1,lastIndex)].join(this.formatSeparator)}return formats.reduce((mem,f)=>{let{formatName,formatOptions}=parseFormatStr(f);if(this.formats[formatName]){let formatted=mem;try{let valOptions=options&&options.formatParams&&options.formatParams[options.interpolationkey]||{},l=valOptions.locale||valOptions.lng||options.locale||options.lng||lng;formatted=this.formats[formatName](mem,l,{...formatOptions,...options,...valOptions})}catch(error){this.logger.warn(error)}return formatted}else this.logger.warn(`there was no format function for ${formatName}`);return mem},value)}},removePending=(q,name)=>{q.pending[name]!==void 0&&(delete q.pending[name],q.pendingCount--)},Connector=class extends EventEmitter{constructor(backend,store,services){let options=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=backend,this.store=store,this.services=services,this.languageUtils=services.languageUtils,this.options=options,this.logger=baseLogger.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=options.maxParallelReads||10,this.readingCalls=0,this.maxRetries=options.maxRetries>=0?options.maxRetries:5,this.retryTimeout=options.retryTimeout>=1?options.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(services,options.backend,options)}queueLoad(languages,namespaces,options,callback){let toLoad={},pending={},toLoadLanguages={},toLoadNamespaces={};return languages.forEach(lng=>{let hasAllNamespaces=!0;namespaces.forEach(ns=>{let name=`${lng}|${ns}`;!options.reload&&this.store.hasResourceBundle(lng,ns)?this.state[name]=2:this.state[name]<0||(this.state[name]===1?pending[name]===void 0&&(pending[name]=!0):(this.state[name]=1,hasAllNamespaces=!1,pending[name]===void 0&&(pending[name]=!0),toLoad[name]===void 0&&(toLoad[name]=!0),toLoadNamespaces[ns]===void 0&&(toLoadNamespaces[ns]=!0)))}),hasAllNamespaces||(toLoadLanguages[lng]=!0)}),(Object.keys(toLoad).length||Object.keys(pending).length)&&this.queue.push({pending,pendingCount:Object.keys(pending).length,loaded:{},errors:[],callback}),{toLoad:Object.keys(toLoad),pending:Object.keys(pending),toLoadLanguages:Object.keys(toLoadLanguages),toLoadNamespaces:Object.keys(toLoadNamespaces)}}loaded(name,err,data){let s=name.split("|"),lng=s[0],ns=s[1];err&&this.emit("failedLoading",lng,ns,err),!err&&data&&this.store.addResourceBundle(lng,ns,data,void 0,void 0,{skipCopy:!0}),this.state[name]=err?-1:2,err&&data&&(this.state[name]=0);let loaded={};this.queue.forEach(q=>{pushPath(q.loaded,[lng],ns),removePending(q,name),err&&q.errors.push(err),q.pendingCount===0&&!q.done&&(Object.keys(q.loaded).forEach(l=>{loaded[l]||(loaded[l]={});let loadedKeys=q.loaded[l];loadedKeys.length&&loadedKeys.forEach(n=>{loaded[l][n]===void 0&&(loaded[l][n]=!0)})}),q.done=!0,q.errors.length?q.callback(q.errors):q.callback())}),this.emit("loaded",loaded),this.queue=this.queue.filter(q=>!q.done)}read(lng,ns,fcName){let tried=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,wait=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,callback=arguments.length>5?arguments[5]:void 0;if(!lng.length)return callback(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng,ns,fcName,tried,wait,callback});return}this.readingCalls++;let resolver=(err,data)=>{if(this.readingCalls--,this.waitingReads.length>0){let next=this.waitingReads.shift();this.read(next.lng,next.ns,next.fcName,next.tried,next.wait,next.callback)}if(err&&data&&tried<this.maxRetries){setTimeout(()=>{this.read.call(this,lng,ns,fcName,tried+1,wait*2,callback)},wait);return}callback(err,data)},fc=this.backend[fcName].bind(this.backend);if(fc.length===2){try{let r=fc(lng,ns);r&&typeof r.then=="function"?r.then(data=>resolver(null,data)).catch(resolver):resolver(null,r)}catch(err){resolver(err)}return}return fc(lng,ns,resolver)}prepareLoading(languages,namespaces){let options=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},callback=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),callback&&callback();isString(languages)&&(languages=this.languageUtils.toResolveHierarchy(languages)),isString(namespaces)&&(namespaces=[namespaces]);let toLoad=this.queueLoad(languages,namespaces,options,callback);if(!toLoad.toLoad.length)return toLoad.pending.length||callback(),null;toLoad.toLoad.forEach(name=>{this.loadOne(name)})}load(languages,namespaces,callback){this.prepareLoading(languages,namespaces,{},callback)}reload(languages,namespaces,callback){this.prepareLoading(languages,namespaces,{reload:!0},callback)}loadOne(name){let prefix=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",s=name.split("|"),lng=s[0],ns=s[1];this.read(lng,ns,"read",void 0,void 0,(err,data)=>{err&&this.logger.warn(`${prefix}loading namespace ${ns} for language ${lng} failed`,err),!err&&data&&this.logger.log(`${prefix}loaded namespace ${ns} for language ${lng}`,data),this.loaded(name,err,data)})}saveMissing(languages,namespace,key,fallbackValue,isUpdate){let options=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},clb=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(namespace)){this.logger.warn(`did not save key "${key}" as the namespace "${namespace}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(key==null||key==="")){if(this.backend&&this.backend.create){let opts={...options,isUpdate},fc=this.backend.create.bind(this.backend);if(fc.length<6)try{let r;fc.length===5?r=fc(languages,namespace,key,fallbackValue,opts):r=fc(languages,namespace,key,fallbackValue),r&&typeof r.then=="function"?r.then(data=>clb(null,data)).catch(clb):clb(null,r)}catch(err){clb(err)}else fc(languages,namespace,key,fallbackValue,clb,opts)}!languages||!languages[0]||this.store.addResource(languages[0],namespace,key,fallbackValue)}}},get=()=>({debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:args=>{let ret={};if(typeof args[1]=="object"&&(ret=args[1]),isString(args[1])&&(ret.defaultValue=args[1]),isString(args[2])&&(ret.tDescription=args[2]),typeof args[2]=="object"||typeof args[3]=="object"){let options=args[3]||args[2];Object.keys(options).forEach(key=>{ret[key]=options[key]})}return ret},interpolation:{escapeValue:!0,format:value=>value,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),transformOptions=options=>(isString(options.ns)&&(options.ns=[options.ns]),isString(options.fallbackLng)&&(options.fallbackLng=[options.fallbackLng]),isString(options.fallbackNS)&&(options.fallbackNS=[options.fallbackNS]),options.supportedLngs&&options.supportedLngs.indexOf("cimode")<0&&(options.supportedLngs=options.supportedLngs.concat(["cimode"])),options),noop=()=>{},bindMemberFunctions=inst=>{Object.getOwnPropertyNames(Object.getPrototypeOf(inst)).forEach(mem=>{typeof inst[mem]=="function"&&(inst[mem]=inst[mem].bind(inst))})},I18n=class _I18n extends EventEmitter{constructor(){let options=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},callback=arguments.length>1?arguments[1]:void 0;if(super(),this.options=transformOptions(options),this.services={},this.logger=baseLogger,this.modules={external:[]},bindMemberFunctions(this),callback&&!this.isInitialized&&!options.isClone){if(!this.options.initImmediate)return this.init(options,callback),this;setTimeout(()=>{this.init(options,callback)},0)}}init(){var _this=this;let options=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},callback=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof options=="function"&&(callback=options,options={}),!options.defaultNS&&options.defaultNS!==!1&&options.ns&&(isString(options.ns)?options.defaultNS=options.ns:options.ns.indexOf("translation")<0&&(options.defaultNS=options.ns[0]));let defOpts=get();this.options={...defOpts,...this.options,...transformOptions(options)},this.options.compatibilityAPI!=="v1"&&(this.options.interpolation={...defOpts.interpolation,...this.options.interpolation}),options.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=options.keySeparator),options.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=options.nsSeparator);let createClassOnDemand=ClassOrObject=>ClassOrObject?typeof ClassOrObject=="function"?new ClassOrObject:ClassOrObject:null;if(!this.options.isClone){this.modules.logger?baseLogger.init(createClassOnDemand(this.modules.logger),this.options):baseLogger.init(null,this.options);let formatter;this.modules.formatter?formatter=this.modules.formatter:typeof Intl<"u"&&(formatter=Formatter);let lu=new LanguageUtil(this.options);this.store=new ResourceStore(this.options.resources,this.options);let s=this.services;s.logger=baseLogger,s.resourceStore=this.store,s.languageUtils=lu,s.pluralResolver=new PluralResolver(lu,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),formatter&&(!this.options.interpolation.format||this.options.interpolation.format===defOpts.interpolation.format)&&(s.formatter=createClassOnDemand(formatter),s.formatter.init(s,this.options),this.options.interpolation.format=s.formatter.format.bind(s.formatter)),s.interpolator=new Interpolator(this.options),s.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},s.backendConnector=new Connector(createClassOnDemand(this.modules.backend),s.resourceStore,s,this.options),s.backendConnector.on("*",function(event){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];_this.emit(event,...args)}),this.modules.languageDetector&&(s.languageDetector=createClassOnDemand(this.modules.languageDetector),s.languageDetector.init&&s.languageDetector.init(s,this.options.detection,this.options)),this.modules.i18nFormat&&(s.i18nFormat=createClassOnDemand(this.modules.i18nFormat),s.i18nFormat.init&&s.i18nFormat.init(this)),this.translator=new Translator(this.services,this.options),this.translator.on("*",function(event){for(var _len2=arguments.length,args=new Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++)args[_key2-1]=arguments[_key2];_this.emit(event,...args)}),this.modules.external.forEach(m=>{m.init&&m.init(this)})}if(this.format=this.options.interpolation.format,callback||(callback=noop),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){let codes=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);codes.length>0&&codes[0]!=="dev"&&(this.options.lng=codes[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(fcName=>{this[fcName]=function(){return _this.store[fcName](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(fcName=>{this[fcName]=function(){return _this.store[fcName](...arguments),_this}});let deferred=defer(),load=()=>{let finish=(err,t2)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),deferred.resolve(t2),callback(err,t2)};if(this.languages&&this.options.compatibilityAPI!=="v1"&&!this.isInitialized)return finish(null,this.t.bind(this));this.changeLanguage(this.options.lng,finish)};return this.options.resources||!this.options.initImmediate?load():setTimeout(load,0),deferred}loadResources(language){let usedCallback=arguments.length>1&&arguments[1]!==void 0?arguments[1]:noop,usedLng=isString(language)?language:this.language;if(typeof language=="function"&&(usedCallback=language),!this.options.resources||this.options.partialBundledLanguages){if(usedLng&&usedLng.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return usedCallback();let toLoad=[],append=lng=>{if(!lng||lng==="cimode")return;this.services.languageUtils.toResolveHierarchy(lng).forEach(l=>{l!=="cimode"&&toLoad.indexOf(l)<0&&toLoad.push(l)})};usedLng?append(usedLng):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(l=>append(l)),this.options.preload&&this.options.preload.forEach(l=>append(l)),this.services.backendConnector.load(toLoad,this.options.ns,e=>{!e&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),usedCallback(e)})}else usedCallback(null)}reloadResources(lngs,ns,callback){let deferred=defer();return typeof lngs=="function"&&(callback=lngs,lngs=void 0),typeof ns=="function"&&(callback=ns,ns=void 0),lngs||(lngs=this.languages),ns||(ns=this.options.ns),callback||(callback=noop),this.services.backendConnector.reload(lngs,ns,err=>{deferred.resolve(),callback(err)}),deferred}use(module2){if(!module2)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!module2.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return module2.type==="backend"&&(this.modules.backend=module2),(module2.type==="logger"||module2.log&&module2.warn&&module2.error)&&(this.modules.logger=module2),module2.type==="languageDetector"&&(this.modules.languageDetector=module2),module2.type==="i18nFormat"&&(this.modules.i18nFormat=module2),module2.type==="postProcessor"&&postProcessor.addPostProcessor(module2),module2.type==="formatter"&&(this.modules.formatter=module2),module2.type==="3rdParty"&&this.modules.external.push(module2),this}setResolvedLanguage(l){if(!(!l||!this.languages)&&!(["cimode","dev"].indexOf(l)>-1))for(let li=0;li<this.languages.length;li++){let lngInLngs=this.languages[li];if(!(["cimode","dev"].indexOf(lngInLngs)>-1)&&this.store.hasLanguageSomeTranslations(lngInLngs)){this.resolvedLanguage=lngInLngs;break}}}changeLanguage(lng,callback){var _this2=this;this.isLanguageChangingTo=lng;let deferred=defer();this.emit("languageChanging",lng);let setLngProps=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},done=(err,l)=>{l?(setLngProps(l),this.translator.changeLanguage(l),this.isLanguageChangingTo=void 0,this.emit("languageChanged",l),this.logger.log("languageChanged",l)):this.isLanguageChangingTo=void 0,deferred.resolve(function(){return _this2.t(...arguments)}),callback&&callback(err,function(){return _this2.t(...arguments)})},setLng=lngs=>{!lng&&!lngs&&this.services.languageDetector&&(lngs=[]);let l=isString(lngs)?lngs:this.services.languageUtils.getBestMatchFromCodes(lngs);l&&(this.language||setLngProps(l),this.translator.language||this.translator.changeLanguage(l),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(l)),this.loadResources(l,err=>{done(err,l)})};return!lng&&this.services.languageDetector&&!this.services.languageDetector.async?setLng(this.services.languageDetector.detect()):!lng&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(setLng):this.services.languageDetector.detect(setLng):setLng(lng),deferred}getFixedT(lng,ns,keyPrefix){var _this3=this;let fixedT=function(key,opts){let options;if(typeof opts!="object"){for(var _len3=arguments.length,rest=new Array(_len3>2?_len3-2:0),_key3=2;_key3<_len3;_key3++)rest[_key3-2]=arguments[_key3];options=_this3.options.overloadTranslationOptionHandler([key,opts].concat(rest))}else options={...opts};options.lng=options.lng||fixedT.lng,options.lngs=options.lngs||fixedT.lngs,options.ns=options.ns||fixedT.ns,options.keyPrefix!==""&&(options.keyPrefix=options.keyPrefix||keyPrefix||fixedT.keyPrefix);let keySeparator=_this3.options.keySeparator||".",resultKey;return options.keyPrefix&&Array.isArray(key)?resultKey=key.map(k=>`${options.keyPrefix}${keySeparator}${k}`):resultKey=options.keyPrefix?`${options.keyPrefix}${keySeparator}${key}`:key,_this3.t(resultKey,options)};return isString(lng)?fixedT.lng=lng:fixedT.lngs=lng,fixedT.ns=ns,fixedT.keyPrefix=keyPrefix,fixedT}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(ns){this.options.defaultNS=ns}hasLoadedNamespace(ns){let options=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;let lng=options.lng||this.resolvedLanguage||this.languages[0],fallbackLng=this.options?this.options.fallbackLng:!1,lastLng=this.languages[this.languages.length-1];if(lng.toLowerCase()==="cimode")return!0;let loadNotPending=(l,n)=>{let loadState=this.services.backendConnector.state[`${l}|${n}`];return loadState===-1||loadState===0||loadState===2};if(options.precheck){let preResult=options.precheck(this,loadNotPending);if(preResult!==void 0)return preResult}return!!(this.hasResourceBundle(lng,ns)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||loadNotPending(lng,ns)&&(!fallbackLng||loadNotPending(lastLng,ns)))}loadNamespaces(ns,callback){let deferred=defer();return this.options.ns?(isString(ns)&&(ns=[ns]),ns.forEach(n=>{this.options.ns.indexOf(n)<0&&this.options.ns.push(n)}),this.loadResources(err=>{deferred.resolve(),callback&&callback(err)}),deferred):(callback&&callback(),Promise.resolve())}loadLanguages(lngs,callback){let deferred=defer();isString(lngs)&&(lngs=[lngs]);let preloaded=this.options.preload||[],newLngs=lngs.filter(lng=>preloaded.indexOf(lng)<0&&this.services.languageUtils.isSupportedCode(lng));return newLngs.length?(this.options.preload=preloaded.concat(newLngs),this.loadResources(err=>{deferred.resolve(),callback&&callback(err)}),deferred):(callback&&callback(),Promise.resolve())}dir(lng){if(lng||(lng=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!lng)return"rtl";let rtlLngs=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],languageUtils=this.services&&this.services.languageUtils||new LanguageUtil(get());return rtlLngs.indexOf(languageUtils.getLanguagePartFromCode(lng))>-1||lng.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let options=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},callback=arguments.length>1?arguments[1]:void 0;return new _I18n(options,callback)}cloneInstance(){let options=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},callback=arguments.length>1&&arguments[1]!==void 0?arguments[1]:noop,forkResourceStore=options.forkResourceStore;forkResourceStore&&delete options.forkResourceStore;let mergedOptions={...this.options,...options,isClone:!0},clone=new _I18n(mergedOptions);return(options.debug!==void 0||options.prefix!==void 0)&&(clone.logger=clone.logger.clone(options)),["store","services","language"].forEach(m=>{clone[m]=this[m]}),clone.services={...this.services},clone.services.utils={hasLoadedNamespace:clone.hasLoadedNamespace.bind(clone)},forkResourceStore&&(clone.store=new ResourceStore(this.store.data,mergedOptions),clone.services.resourceStore=clone.store),clone.translator=new Translator(clone.services,mergedOptions),clone.translator.on("*",function(event){for(var _len4=arguments.length,args=new Array(_len4>1?_len4-1:0),_key4=1;_key4<_len4;_key4++)args[_key4-1]=arguments[_key4];clone.emit(event,...args)}),clone.init(mergedOptions,callback),clone.translator.options=mergedOptions,clone.translator.backendConnector.services.utils={hasLoadedNamespace:clone.hasLoadedNamespace.bind(clone)},clone}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}},instance=I18n.createInstance();instance.createInstance=I18n.createInstance;var createInstance=instance.createInstance,dir=instance.dir,init=instance.init,loadResources=instance.loadResources,reloadResources=instance.reloadResources,use=instance.use,changeLanguage=instance.changeLanguage,getFixedT=instance.getFixedT,t=instance.t,exists=instance.exists,setDefaultNamespace=instance.setDefaultNamespace,hasLoadedNamespace=instance.hasLoadedNamespace,loadNamespaces=instance.loadNamespaces,loadLanguages=instance.loadLanguages;function around(obj,factories){let removers=Object.keys(factories).map(key=>around1(obj,key,factories[key]));return removers.length===1?removers[0]:function(){removers.forEach(r=>r())}}function around1(obj,method,createWrapper){let original=obj[method],hadOwn=obj.hasOwnProperty(method),current=createWrapper(original);return original&&Object.setPrototypeOf(current,original),Object.setPrototypeOf(wrapper,current),obj[method]=wrapper,remove;function wrapper(...args){return current===original&&obj[method]===wrapper&&remove(),current.apply(this,args)}function remove(){obj[method]===wrapper&&(hadOwn?obj[method]=original:delete obj[method]),current!==original&&(current=original,Object.setPrototypeOf(wrapper,original||Function))}}var import_obsidian6=require("obsidian");var isObject=obj=>{if(typeof obj=="object"&&obj!==null){if(typeof Object.getPrototypeOf=="function"){let prototype=Object.getPrototypeOf(obj);return prototype===Object.prototype||prototype===null}return Object.prototype.toString.call(obj)==="[object Object]"}return!1},merge=(...objects)=>objects.reduce((result,current)=>{if(Array.isArray(current))throw new TypeError("Arguments provided to ts-deepmerge must be objects, not arrays.");return Object.keys(current).forEach(key=>{["__proto__","constructor","prototype"].includes(key)||(Array.isArray(result[key])&&Array.isArray(current[key])?result[key]=merge.options.mergeArrays?merge.options.uniqueArrayItems?Array.from(new Set(result[key].concat(current[key]))):[...result[key],...current[key]]:current[key]:isObject(result[key])&&isObject(current[key])?result[key]=merge(result[key],current[key]):result[key]=current[key]===void 0?merge.options.allowUndefinedOverrides?current[key]:result[key]:current[key])}),result},{}),defaultOptions={allowUndefinedOverrides:!0,mergeArrays:!0,uniqueArrayItems:!0};merge.options=defaultOptions;merge.withOptions=(options,...objects)=>{merge.options=Object.assign(Object.assign({},defaultOptions),options);let result=merge(...objects);return merge.options=defaultOptions,result};var esm_default=merge;var import_obsidian=require("obsidian");var en_exports={};__export(en_exports,{auto:()=>auto,callout:()=>callout,commands:()=>commands,common:()=>common,convertDataview:()=>convertDataview,copyAsHTML:()=>copyAsHTML,copyLinksAsText:()=>copyLinksAsText,debug:()=>debug,default:()=>en_default,delete:()=>delete2,edit:()=>edit,global:()=>global2,hardBreaks:()=>hardBreaks,highlight:()=>highlight,hotkey:()=>hotkey,links:()=>links,log:()=>log,modal:()=>modal,openTextReplacer:()=>openTextReplacer,other:()=>other,overrideCopy:()=>overrideCopy,profile:()=>profile,reading:()=>reading,removeFootnotesLinks:()=>removeFootnotesLinks,spaceSize:()=>spaceSize,tabSpaceSize:()=>tabSpaceSize,tabToSpace:()=>tabToSpace,unconventionalMarkdown:()=>unconventionalMarkdown,view:()=>view,wikiToMarkdown:()=>wikiToMarkdown});var auto={EQUAL:"EQUAL TO",and:"",desc:"Allow to automatically use this profile based on the path, tag or properties.<br/>For properties, it will be matched on the <code>enhanced_copy</code> key.<br/>It also supports regex (without the need to enclose them in <code>/</code>)!",frontmatter:"Properties",is:"",not:"NOT EQUAL TO",or:"OR",path:"Path",placeholder:"Value to match",tag:"Tags",title:"Automatic use"},callout={desc:"Format of the callout type. All format will be in blockquote.",obsidian:"Use Obsidian's default callout format",remove:"Remove the type & title",removeKeepTitle:"Keeping the title but removing the type.",strong:"Convert the type to a simple strong text, keep the title",title:"Callout type"},commands={all:"Copy selected text",brute:"Native copy",editor:"Copy selected text from edit view",other:"Copy selected text from opened view",reading:"Copy selected text from reading view"},common={add:"Add",cancel:"Cancel",delete:"Delete",from:"From",pattern:"pattern",profile:"Profile name",replacement:"replacement",save:"Save",to:"To"},convertDataview={block:"Code block",djs:{block:{},inline:{},title:"Dataview JS"},dql:{block:{},inline:{},title:"Dataview Query Language"},global:{desc:`Allows you to convert dataview queries (inline DQL, Djs...) to markdown. 
Does not always work, use with moderation.`,title:"Convert Dataview queries to markdown"},inline:"Inline"},copyAsHTML="Copy as HTML instead of Markdown. Some options may not be available.",copyLinksAsText={desc:"Adjust the way links are formatted when copying to the clipboard.",external:"Remove markup for internal links only",keep:"Keep markup",remove:"Remove markup for all links",title:"Links format"},debug={desc:"Show debug log in console",title:"Debug information"},delete2={},edit={desc:"Edit view settings",title:"Edit"},global2={copy:"Copy settings between profile",title:"General parameters"},hardBreaks={desc:"Add a standard markdown line break (two spaces at the end of the line) at the end of each line.",title:"Hard breaks"},highlight={desc:"Remove the highlight markup (==).",title:"Highlight"},hotkey={desc:"Create a separate command for each mode. This allows you to assign a different hotkey for each mode. \u26A0\uFE0F\uFE0F You need to reload the plugin to apply the changes.",title:"Separate commands"},links="Links",log={callout:{remove:"Remove callout title",title:"Convert callout"},editMode:"Edit mode",empty:"selectedText is empty // Fallback on activeWindow.getSelection().toString()",noHardBreaks:"No hard breaks - Remove extra spaces at the end of each line",readingMode:"Reading mode"},modal={copyView:{copy:"Copy",editing:"Editing",reading:"Reading"},replaceText:{down:"Move down",title:"Replace Text",up:"Move up"}},openTextReplacer="Open Text replacer",other="Other options",overrideCopy={desc:"Replace the native copy (CTRL C, right-click...) with the enhanced copy (need a reload of Obsidian)",title:"Override native copy"},profile={add:{desc:`Add a copy profile. 
An Obsidian reload is required to use it as a command.`,title:"Add profile"},delete:"Delete profile"},reading={desc:"Reading view settings",title:"Reading"},removeFootnotesLinks={desc:"Adjust the way footnotes are formatted when copying them to the clipboard.",format:"Remove all links but keep contents as [^1]",keep:"Keep all links markup and contents",remove:"Remove all links markup and contents",title:"Footnotes format"},spaceSize={desc:"Number of spaces to be used for indentation. Use -1 to disable the conversion.",title:"Space size"},tabSpaceSize="Number of spaces to be used for indentation",tabToSpace="Convert tabs to spaces",unconventionalMarkdown={desc:"Removed unconventional Markdown markup because they are not supported by all Markdown interpreters.",title:"Unconventional Markdown"},view={all:"All view",desc:"Choose on which view the conversion should be applied.",edit:"Edit view",reading:"Reading view only",title:"Apply settings"},wikiToMarkdown={desc:"Mandatory to edit the links when copying them to the clipboard. If disabled, the settings for links format will be ignored.",title:"Convert wiki links to Markdown link"},en_default={auto,callout,commands,common,convertDataview,copyAsHTML,copyLinksAsText,debug,delete:delete2,edit,global:global2,hardBreaks,highlight,hotkey,links,log,modal,openTextReplacer,other,overrideCopy,profile,reading,removeFootnotesLinks,spaceSize,tabSpaceSize,tabToSpace,unconventionalMarkdown,view,wikiToMarkdown};var fr_exports={};__export(fr_exports,{auto:()=>auto2,callout:()=>callout2,commands:()=>commands2,common:()=>common2,convertDataview:()=>convertDataview2,copyAsHTML:()=>copyAsHTML2,copyLinksAsText:()=>copyLinksAsText2,debug:()=>debug2,default:()=>fr_default,delete:()=>delete3,edit:()=>edit2,global:()=>global3,hardBreaks:()=>hardBreaks2,highlight:()=>highlight2,hotkey:()=>hotkey2,links:()=>links2,log:()=>log2,modal:()=>modal2,openTextReplacer:()=>openTextReplacer2,other:()=>other2,overrideCopy:()=>overrideCopy2,profile:()=>profile2,reading:()=>reading2,removeFootnotesLinks:()=>removeFootnotesLinks2,spaceSize:()=>spaceSize2,tabSpaceSize:()=>tabSpaceSize2,tabToSpace:()=>tabToSpace2,unconventionalMarkdown:()=>unconventionalMarkdown2,view:()=>view2,wikiToMarkdown:()=>wikiToMarkdown2});var auto2={EQUAL:"\xC9GAL \xC0",and:"ET",desc:"Permet d'utiliser automatiquement ce profil en se basant sur le chemin, un tag ou les propri\xE9t\xE9s.<br/>Pour les propri\xE9t\xE9s, la valeur sera s\xE9lectionn\xE9e \xE0 partir de la cl\xE9 <code>enhanced_copy</code>.<br/>Les regex sont aussi support\xE9s (sans avoir besoin de les mettre entre <code>/</code>) !",frontmatter:"Propri\xE9t\xE9s",is:"Activer uniquement SI VALIDE la condition",not:"DIFF\xC9RENT DE",or:"OU",path:"Chemin",placeholder:"Valeur \xE0 trouver",tag:"Tags",title:"Utilisation automatique"},callout2={desc:"Format du type de callout. Tous les formats seront sous formes de citations.",obsidian:"Utiliser le format de callout d'Obsidian",remove:"Suppression du type et titre",removeKeepTitle:"Conservation du titre mais suppression du type",strong:"Convertir le type en gras",title:"Type de callout"},commands2={all:"Copier le texte s\xE9lectionn\xE9",brute:"Copie native",editor:"Copier le texte s\xE9lectionn\xE9 depuis l'\xE9diteur",other:"Copier le texte s\xE9lectionn\xE9 depuis la vue non markdown",reading:"Copier le texte s\xE9lectionn\xE9 depuis la vue de lecture"},common2={add:"Ajouter",cancel:"Annuler",delete:"Supprimer",from:"Depuis",pattern:"pattern",profile:"Nom du profil",replacement:"remplacement",save:"Sauvegarder",to:"Vers"},convertDataview2={block:"Bloc de code",djs:{block:{},inline:{},title:"Dataview JS"},dql:{block:{},inline:{},title:"Dataview Query Language"},global:{desc:"Permet de convertir les queries dataview (inline DQL, Djs...) en markdown. Ne fonctionne pas toujours, \xE0 utiliser avec mod\xE9ration.",title:"Convertir les queries Dataview en markdown"},inline:"Inline"},copyAsHTML2="Copier en HTML au lieu de Markdown. Certaines options peuvent ne pas \xEAtre disponibles.",copyLinksAsText2={desc:"Modifier l'aspect des liens lorsqu'ils sont copi\xE9s dans le presse-papiers.",external:"Supprimer les balises pour les liens internes seulement",keep:"Conserver toutes les balises",remove:"Supprimer les balises pour tous les liens",title:"Format des liens"},debug2={desc:"Affiche le journal de d\xE9bogage dans la console",title:"Informations de d\xE9bogage"},delete3={},edit2={desc:"Param\xE8tre pour la vue d'\xE9dition",title:"\xC9dition"},global3={copy:"Copier les param\xE8tres entre les profiles",title:"Param\xE8tres g\xE9n\xE9raux"},hardBreaks2={desc:"Ajouter un saut de ligne strict (deux espaces en fin de ligne) \xE0 la fin de chaque ligne.",title:"Saut de ligne strict"},highlight2={desc:"Suppression de la balise de surlignage (==)",title:"Surlignage"},hotkey2={desc:"Cr\xE9ez une commande distincte pour chaque mode. Cela vous permet d'attribuer un raccourci clavier diff\xE9rent pour chaque mode. \u26A0 N\xE9cessite le rechargement du plugin pour prendre effet.",title:"S\xE9parer les commandes"},links2="Liens",log2={callout:{remove:"Supprimer le titre de l'accroche",title:"Convertir l'accroche"},editMode:"Mode \xE9dition",empty:"selectedText est vide // Repli sur activeWindow.getSelection().toString()",noHardBreaks:"Pas de pauses dures - Supprimez les espaces suppl\xE9mentaires \xE0 la fin de chaque ligne",readingMode:"Mode de lecture"},modal2={copyView:{copy:"Copier",editing:"\xC9dition",reading:"Lecture"},replaceText:{down:"Descendre",title:"Remplacer du texte",up:"Monter"}},openTextReplacer2="Ouvrir le remplacement de texte",other2="Autres options",overrideCopy2={desc:"Remplacer la copie native (CTRL + C, clic-droit...) par la copie am\xE9lior\xE9e (n\xE9cessite un rechargement d'Obsidian)",title:"Prendre en charge la copie native"},profile2={add:{desc:"Ajouter un profil de copy. Un rechargement d'Obsidian est n\xE9cessaire pour l'utiliser comme commande.",title:"Ajouter un profile"},delete:"Supprimer le profile"},reading2={desc:"Param\xE8tre pour la vue de lecture",title:"Lecture"},removeFootnotesLinks2={desc:"Modifier les balises des notes de bas de page lorsqu'elles sont copi\xE9es dans le presse-papiers.",format:"Supprimer les liens, mais conserver le contenu sous forme de [^1]",keep:"Conserver balises et contenu",remove:"Supprimer balises et contenu",title:"Format des footnotes"},spaceSize2={desc:"Modification du nombre d'espace pour la mise en retrait. Utiliser -1 pour d\xE9sactiver la fonction de conversion.",title:"Nombre d'espace"},tabSpaceSize2="Nombre d'espaces \xE0 utiliser pour la mise en retrait",tabToSpace2="Convertir les tabulations en espace",unconventionalMarkdown2={desc:"Suppression des balises Markdown non conventionnelles car elles ne sont pas prise en charge par tous les interpr\xE9teurs Markdown.",title:"Markdown non conventionnel"},view2={all:"Tous les modes",desc:"Choisissez le mode sur lequel les conversions doivent \xEAtre appliqu\xE9s.",edit:"Mode \xC9dition",reading:"Mode lecture uniquement",title:"Appliquer les param\xE8tres"},wikiToMarkdown2={desc:"Obligatoire pour \xE9diter les liens lors de leur copie dans le presse-papiers. Si cette option est d\xE9sactiv\xE9e, les param\xE8tres pour le format des liens sera ignor\xE9.",title:"Convertir les liens Wiki en liens Markdown"},fr_default={auto:auto2,callout:callout2,commands:commands2,common:common2,convertDataview:convertDataview2,copyAsHTML:copyAsHTML2,copyLinksAsText:copyLinksAsText2,debug:debug2,delete:delete3,edit:edit2,global:global3,hardBreaks:hardBreaks2,highlight:highlight2,hotkey:hotkey2,links:links2,log:log2,modal:modal2,openTextReplacer:openTextReplacer2,other:other2,overrideCopy:overrideCopy2,profile:profile2,reading:reading2,removeFootnotesLinks:removeFootnotesLinks2,spaceSize:spaceSize2,tabSpaceSize:tabSpaceSize2,tabToSpace:tabToSpace2,unconventionalMarkdown:unconventionalMarkdown2,view:view2,wikiToMarkdown:wikiToMarkdown2};var resources={en:{translation:en_exports},fr:{translation:fr_exports}},localeUsed=window.localStorage.language||import_obsidian.moment.locale(),translationLanguage=Object.keys(resources).find(i=>i==localeUsed)?localeUsed:"en";var COLLAPSE_INDICATOR=new RegExp('<div class="heading-collapse-indicator collapse-indicator collapse-icon( is-collapsed)?"><svg xmlns=".*" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>',"gi"),DEFAULT_SETTINGS={copyAsHTML:!1,applyingTo:"all",separateHotkey:!1,editing:{footnotes:"keep",links:"keep",callout:"obsidian",highlight:!1,hardBreak:!1,replaceText:[],overrideNativeCopy:!1},reading:{footnotes:"keep",links:"keep",callout:"obsidian",highlight:!1,hardBreak:!1,replaceText:[],overrideNativeCopy:!1,spaceReadingSize:-1,wikiToMarkdown:!1},devMode:!1,profiles:[]},DEFAULT_DATAVIEW_SETTINGS_DISABLED={enable:!1,djs:{inline:!1,block:!1},dql:{inline:!1,block:!1}},DEFAULT_DATAVIEW_SETTINGS_ENABLED={enable:!0,djs:{inline:!0,block:!0},dql:{inline:!0,block:!0}};var import_obsidian3=require("obsidian");var import_obsidian2=require("obsidian");var AllReplaceTextModal=class extends import_obsidian2.Modal{replaceText;onSubmit;constructor(app,replaceText,onSubmit){super(app),this.onSubmit=onSubmit,this.replaceText=replaceText}validateRegex(pattern){try{if(pattern.match(/^\/.*\/([gmiyus]+)?$/)){let flags=pattern.replace(/^\/.*\/([gmiyus]+)?$/,"$1"),regex=pattern.replace(/^\/(.*)\/(.*)$/,"$1");new RegExp(regex,flags.length>0?flags:void 0)}return!0}catch{return!1}}onOpen(){let{contentEl}=this;contentEl.empty(),contentEl.addClass("enhanced-copy"),new import_obsidian2.Setting(contentEl).setName(instance.t("modal.replaceText.title")).setClass("modal-title").addButton(button=>button.setIcon("plus").setTooltip(instance.t("common.add")).onClick(()=>{this.replaceText.unshift({pattern:"",replacement:""}),this.onOpen()}));for(let replacer of this.replaceText)new import_obsidian2.Setting(contentEl).addText(text=>text.setPlaceholder(instance.t("common.pattern")).setValue(replacer.pattern).onChange(async value=>{replacer.pattern=value,text.inputEl.setAttribute("data-pattern",value)}).inputEl.classList.add("full-width")).addText(text=>text.setPlaceholder(instance.t("common.replacement")).setValue(replacer.replacement).onChange(async value=>{replacer.replacement=value,text.inputEl.setAttribute("data-replacement",value)}).inputEl.classList.add("full-width")).addExtraButton(button=>button.setIcon("chevron-up").setTooltip(instance.t("modal.replaceText.up")).onClick(()=>{let index=this.replaceText.indexOf(replacer);index<=0||(this.replaceText.splice(index,1),this.replaceText.splice(index-1,0,replacer),this.onOpen())})).addExtraButton(button=>button.setIcon("chevron-down").setTooltip(instance.t("modal.replaceText.down")).onClick(()=>{let index=this.replaceText.indexOf(replacer);index>=this.replaceText.length-1||(this.replaceText.splice(index,1),this.replaceText.splice(index+1,0,replacer),this.onOpen())})).addExtraButton(button=>button.setIcon("trash").setTooltip(instance.t("common.delete")).onClick(()=>{let index=this.replaceText.indexOf(replacer);index>-1&&(this.replaceText.splice(index,1),this.onOpen())})).infoEl.classList.add("hide-info");new import_obsidian2.Setting(contentEl).addButton(button=>button.setButtonText(instance.t("common.save")).setCta().onClick(async()=>{for(let replacer of this.replaceText)if(!this.validateRegex(replacer.pattern)){new import_obsidian2.Notice(`Invalid regex for ${replacer.pattern}`);let input=contentEl.querySelector(`[data-pattern="${replacer.pattern}"]`);input&&input.addClass("error");return}this.onSubmit(this.replaceText),this.close()})).addButton(button=>button.setButtonText(instance.t("common.cancel")).setWarning().onClick(async()=>{this.close()}))}onClose(){let{contentEl}=this;contentEl.empty()}},EnhancedCopyViewModal=class extends import_obsidian2.Modal{settings;from;to;onSubmit;constructor(app,settings,onSubmit){super(app),this.onSubmit=onSubmit,this.settings=settings,this.from="reading",this.to="editing"}onOpen(){let{contentEl}=this;contentEl.empty(),contentEl.addClass("enhanced-copy");let profileOptions={};for(let profile3 of this.settings.profiles)profile3.name&&(profileOptions[profile3.name]=profile3.name);new import_obsidian2.Setting(contentEl).setName(instance.t("common.from")).addDropdown(dropdown=>dropdown.addOptions({reading:instance.t("modal.copyView.reading"),editing:instance.t("modal.copyView.editing"),...profileOptions}).setValue(this.from).onChange(async value=>{this.from=value}).selectEl.classList.add("full-width")).infoEl.classList.add("min-width"),new import_obsidian2.Setting(contentEl).setName(instance.t("common.to")).addDropdown(dropdown=>dropdown.addOptions({reading:instance.t("modal.copyView.reading"),editing:instance.t("modal.copyView.editing"),...profileOptions}).setValue(this.to).onChange(async value=>{this.to=value}).selectEl.classList.add("full-width")).infoEl.classList.add("min-width"),new import_obsidian2.Setting(contentEl).addButton(button=>button.setButtonText(instance.t("modal.copyView.copy")).setCta().onClick(async()=>{if(this.from===this.to)return;let override;switch(this.from){case"reading":override=this.settings.reading;break;case"editing":override=this.settings.editing;break;default:{let profile3=this.settings.profiles.find(profile4=>profile4.name===this.from);profile3&&(override=profile3)}}if(override){switch(this.to){case"reading":this.settings.reading=override;break;case"editing":this.settings.editing=override;break;default:{let profileIndex=this.settings.profiles.findIndex(profile3=>profile3.name===this.to);profileIndex&&(this.settings.profiles[profileIndex]=override)}}this.onSubmit(this.settings),this.close()}})).addButton(button=>button.setButtonText(instance.t("common.cancel")).setWarning().onClick(async()=>{this.close()}))}onClose(){let{contentEl}=this;contentEl.empty()}},NameProfile=class extends import_obsidian2.Modal{name="";onSubmit;constructor(app,onSubmit){super(app),this.onSubmit=onSubmit}onOpen(){let{contentEl}=this;contentEl.empty(),contentEl.addClass("enhanced-copy"),new import_obsidian2.Setting(contentEl).setName(instance.t("common.profile")).setClass("modal-title").addText(text=>text.setPlaceholder(instance.t("common.profile")).setValue(this.name).onChange(async value=>{this.name=value}).inputEl.classList.add("full-width")),new import_obsidian2.Setting(contentEl).addButton(button=>button.setButtonText(instance.t("common.save")).setCta().onClick(async()=>{this.onSubmit(this.name),this.close()})).addButton(button=>button.setButtonText(instance.t("common.cancel")).setWarning().onClick(async()=>{this.close()}))}onClose(){let{contentEl}=this;contentEl.empty()}};var EnhancedCopySettingTab=class extends import_obsidian3.PluginSettingTab{plugin;settingsPage;settings;reading={name:instance.t("reading.title"),id:"reading",icon:"book-open"};edit={name:instance.t("edit.title"),id:"edit",icon:"pencil"};tab=[{name:instance.t("global.title"),id:"global",icon:"globe"}];createReadingSettings(settings,profile3,noRegex){new import_obsidian3.Setting(this.settingsPage).setName(instance.t("reading.desc")).setHeading(),new import_obsidian3.Setting(this.settingsPage).setName(instance.t("copyAsHTML")).addToggle(toggle=>{toggle.setValue(settings.copyAsHTML??!1).onChange(async value=>{settings.copyAsHTML=value,await this.plugin.saveSettings(),this.renderSettingsPage(settings.name??"reading")})}),settings.copyAsHTML||(new import_obsidian3.Setting(this.settingsPage).setName(instance.t("links")).setHeading().setClass("h3"),this.links(settings),this.footnotes(settings),new import_obsidian3.Setting(this.settingsPage).setName(instance.t("unconventionalMarkdown.title")).setHeading().setClass("h3").setDesc(instance.t("unconventionalMarkdown.desc")),this.highlight(settings)),this.calloutTitle(settings),settings.copyAsHTML||(new import_obsidian3.Setting(this.settingsPage).setName(instance.t("other")).setHeading().setClass("h3"),this.hardBreak(settings),new import_obsidian3.Setting(this.settingsPage).setName(instance.t("spaceSize.title")).setDesc(instance.t("spaceSize.desc")).addText(text=>{text.setPlaceholder("-1").setValue(String(settings.spaceReadingSize??-1)).onChange(async value=>{settings.spaceReadingSize=Number(value),await this.plugin.saveSettings()})})),profile3||this.overrideSetting(settings),noRegex||this.regexReplacementButton(settings)}createEditSettings(settings,profile3,noRegex){new import_obsidian3.Setting(this.settingsPage).setName(instance.t("edit.desc")).setHeading(),this.app.plugins.enabledPlugins.has("dataview")&&(settings.convertDataview?settings.convertDataview===!0&&(settings.convertDataview=structuredClone(DEFAULT_DATAVIEW_SETTINGS_ENABLED)):settings.convertDataview=structuredClone(DEFAULT_DATAVIEW_SETTINGS_DISABLED),new import_obsidian3.Setting(this.settingsPage).setName(instance.t("convertDataview.global.title")).setDesc(instance.t("convertDataview.global.desc")).addToggle(toggle=>{toggle.setValue(settings.convertDataview?.enable??!1).onChange(async value=>{value?settings.convertDataview=structuredClone(DEFAULT_DATAVIEW_SETTINGS_ENABLED):settings.convertDataview=structuredClone(DEFAULT_DATAVIEW_SETTINGS_DISABLED),await this.plugin.saveSettings(),this.renderSettingsPage(settings.name??"edit")})}),settings.convertDataview?.enable&&(new import_obsidian3.Setting(this.settingsPage).setHeading().setClass("dataview").setName(instance.t("convertDataview.dql.title")),new import_obsidian3.Setting(this.settingsPage).setName(instance.t("convertDataview.block")).setClass("dataview").addToggle(toggle=>{toggle.setValue(settings.convertDataview?.djs.block??!1).onChange(async value=>{settings.convertDataview.djs.block=value,await this.plugin.saveSettings()})}),new import_obsidian3.Setting(this.settingsPage).setName(instance.t("convertDataview.inline")).setClass("dataview").addToggle(toggle=>{toggle.setValue(settings.convertDataview?.djs.inline??!1).onChange(async value=>{settings.convertDataview.djs.inline=value,await this.plugin.saveSettings(),this.renderSettingsPage(settings.name??"edit")})}),new import_obsidian3.Setting(this.settingsPage).setHeading().setClass("dataview").setName(instance.t("convertDataview.djs.title")),new import_obsidian3.Setting(this.settingsPage).setName(instance.t("convertDataview.block")).setClass("dataview").addToggle(toggle=>{toggle.setValue(settings.convertDataview?.dql.block??!1).onChange(async value=>{settings.convertDataview.dql.block=value,await this.plugin.saveSettings()})}),new import_obsidian3.Setting(this.settingsPage).setName(instance.t("convertDataview.inline")).setClass("dataview").addToggle(toggle=>{toggle.setValue(settings.convertDataview?.dql.inline??!1).onChange(async value=>{settings.convertDataview.dql.inline=value,await this.plugin.saveSettings(),this.renderSettingsPage(settings.name??"edit")})}))),new import_obsidian3.Setting(this.settingsPage).setName(instance.t("wikiToMarkdown.title")).setDesc(instance.t("wikiToMarkdown.desc")).addToggle(toggle=>{toggle.setValue(settings.wikiToMarkdown??!1).onChange(async value=>{settings.wikiToMarkdown=value,await this.plugin.saveSettings(),this.renderSettingsPage(settings.name??"edit")})}),new import_obsidian3.Setting(this.settingsPage).setName(instance.t("tabToSpace")).addToggle(toggle=>{toggle.setValue(settings.tabToSpace??!1).onChange(async value=>{settings.tabToSpace=value,await this.plugin.saveSettings(),this.renderSettingsPage(settings.name??"edit")})}),settings.tabToSpace&&new import_obsidian3.Setting(this.settingsPage).setName(instance.t("tabSpaceSize")).addText(text=>{text.setValue(settings.tabSpaceSize?settings.tabSpaceSize.toString():"4").onChange(async value=>{settings.tabSpaceSize=parseInt(value),text.inputEl.toggleClass("error",isNaN(settings.tabSpaceSize)||settings.tabSpaceSize<0),(isNaN(settings.tabSpaceSize)||settings.tabSpaceSize<0)&&(settings.tabSpaceSize=4),await this.plugin.saveSettings()})}),new import_obsidian3.Setting(this.settingsPage).setName(instance.t("links")).setHeading().setClass("h3"),settings.wikiToMarkdown&&this.links(settings),this.footnotes(settings),new import_obsidian3.Setting(this.settingsPage).setName(instance.t("unconventionalMarkdown.title")).setHeading().setClass("h3").setDesc(instance.t("unconventionalMarkdown.desc")),this.calloutTitle(settings),this.highlight(settings),new import_obsidian3.Setting(this.settingsPage).setName(instance.t("other")).setHeading().setClass("h3"),this.hardBreak(settings),profile3||this.overrideSetting(settings),noRegex||this.regexReplacementButton(settings)}constructor(app,plugin){super(app,plugin),this.plugin=plugin,this.settings=plugin.settings}display(){let{containerEl}=this;containerEl.empty(),this.containerEl.addClasses(["enhanced-copy","setting-tab"]);let tabBar=containerEl.createEl("nav",{cls:"settings-tab-bar"});this.settings.applyingTo==="reading"?(this.tab.push(this.reading),this.tab.remove(this.edit)):this.settings.applyingTo==="edit"?(this.tab.push(this.edit),this.tab.remove(this.reading)):(this.tab.push(this.edit),this.tab.push(this.reading));for(let profile3 of this.settings.profiles)this.tab=this.tab.filter(tab=>tab.id!==profile3.name),this.tab.push({name:profile3.name??"profile",id:profile3.name??"profile",icon:"layers-2"});this.tab=[...new Set(this.tab)];for(let tabInfo of this.tab){let tabEl=tabBar.createEl("div",{cls:"settings-tab"}),tabIcon=tabEl.createEl("div",{cls:"settings-tab-icon"});(0,import_obsidian3.setIcon)(tabIcon,tabInfo.icon),tabInfo.id==="global"&&tabEl.addClasses(["settings-tab-active"]),tabEl.createEl("div",{cls:"tabName",text:tabInfo.name}),tabEl.addEventListener("click",()=>{for(let tabEl2 of tabBar.children)tabEl2.removeClasses(["settings-tab-active"]);tabEl.addClasses(["settings-tab-active"]),this.renderSettingsPage(tabInfo.id)})}this.settingsPage=containerEl.createEl("div",{cls:"settings-tab-page"}),this.renderSettingsPage("global")}renderSettingsPage(tab){switch(this.settingsPage.empty(),tab){case"global":this.renderGlobal();break;case"reading":this.renderReading();break;case"edit":this.renderEdit();break;default:this.renderProfile(tab);break}}renderProfile(tab){let profile3=this.settings.profiles.find(profile4=>profile4.name===tab);if(profile3){this.settingsPage.empty(),new import_obsidian3.Setting(this.settingsPage).addButton(button=>{button.setButtonText(instance.t("profile.delete")).onClick(async()=>{let index=this.settings.profiles.findIndex(profile4=>profile4.name===tab);this.settings.profiles.splice(index,1),this.tab=this.tab.filter(tab2=>tab2.id!==profile3.name),await this.plugin.saveSettings(),this.display(),this.renderGlobal()}).buttonEl.classList.add("full-width")}).infoEl.classList.add("hide-info"),profile3.applyingTo=profile3.applyingTo??"all",new import_obsidian3.Setting(this.settingsPage).setName(profile3.name??"profile").setHeading(),new import_obsidian3.Setting(this.settingsPage).setName(instance.t("view.title")).setDesc(instance.t("view.desc")).addDropdown(dropdown=>{dropdown.addOption("all",instance.t("view.all")).addOption("reading",instance.t("view.reading")).addOption("edit",instance.t("view.edit")).setValue(profile3.applyingTo??"all").onChange(async value=>{profile3.applyingTo=value,await this.plugin.saveSettings(),this.renderSettingsPage(tab)})}),new import_obsidian3.Setting(this.settingsPage).setName(instance.t("auto.title")).setDesc((0,import_obsidian3.sanitizeHTMLToDom)(instance.t("auto.desc"))).addExtraButton(button=>button.setIcon("plus").setTooltip("Add new rule").onClick(async()=>{profile3.autoRules=profile3.autoRules??[],profile3.autoRules.unshift({type:"path",value:""}),await this.plugin.saveSettings(),this.renderSettingsPage(tab)}));for(let rules of profile3.autoRules??[])new import_obsidian3.Setting(this.settingsPage).addDropdown(dp=>{dp.addOption("not",instance.t("auto.not")).addOption("equal",instance.t("auto.EQUAL")).setValue(rules.not?"not":"equal").onChange(async value=>{rules.not=value==="not",await this.plugin.saveSettings()})}).setClass("no-display").setClass("full-width").addDropdown(dropdown=>{dropdown.addOption("path",instance.t("auto.path")).addOption("tag",instance.t("auto.tag")).addOption("frontmatter",instance.t("auto.frontmatter")).setValue(rules.type).onChange(async value=>{rules.type=value,await this.plugin.saveSettings()})}).addText(text=>{text.setValue(rules.value).setPlaceholder(instance.t("auto.placeholder")).onChange(async value=>{rules.value=value,await this.plugin.saveSettings()})}).addExtraButton(button=>{button.setIcon("trash").onClick(async()=>{let index=profile3.autoRules?.findIndex(rule=>rule===rules);index!==void 0&&(profile3.autoRules?.splice(index,1),await this.plugin.saveSettings(),this.renderSettingsPage(tab))})}).addExtraButton(button=>{button.setIcon("chevron-up").onClick(async()=>{let index=profile3.autoRules?.findIndex(rule=>rule===rules);index===void 0||index<=0||(profile3.autoRules?.splice(index,1),profile3.autoRules?.splice(index-1,0,rules),await this.plugin.saveSettings(),this.renderSettingsPage(tab))})}).addExtraButton(button=>{button.setIcon("chevron-down").onClick(async()=>{let index=profile3.autoRules?.findIndex(rule=>rule===rules);index===void 0||profile3.autoRules&&index>=profile3.autoRules.length-1||(profile3.autoRules?.splice(index,1),profile3.autoRules?.splice(index+1,0,rules),await this.plugin.saveSettings(),this.renderSettingsPage(tab))})});profile3.applyingTo==="all"?(this.createReadingSettings(profile3,!0,!0),this.createEditSettings(profile3,!0,!0),this.regexReplacementButton(profile3)):profile3.applyingTo==="reading"?this.createReadingSettings(profile3,!0):profile3.applyingTo==="edit"&&this.createEditSettings(profile3,!0)}}renderGlobal(){this.settingsPage.empty(),this.settingsPage.addClasses(["global"]),new import_obsidian3.Setting(this.settingsPage).addButton(button=>{button.setButtonText(instance.t("profile.add.title")).setTooltip(instance.t("profile.add.desc")).onClick(async()=>{new NameProfile(this.app,result=>{this.settings.profiles.push({name:result,...this.settings.editing}),this.plugin.saveSettings(),this.display()}).open()})}),new import_obsidian3.Setting(this.settingsPage).setName(instance.t("global.title")).setHeading(),new import_obsidian3.Setting(this.settingsPage).setName(instance.t("view.title")).setDesc(instance.t("view.desc")).addDropdown(dropdown=>{dropdown.addOption("all",instance.t("view.all")).addOption("reading",instance.t("view.reading")).addOption("edit",instance.t("view.edit")).setValue(this.settings.applyingTo).onChange(async value=>{this.settings.applyingTo=value,await this.plugin.saveSettings(),this.settings.applyingTo==="edit"&&(this.settings.copyAsHTML=!1,await this.plugin.saveSettings()),this.display()})}),new import_obsidian3.Setting(this.settingsPage).setName(instance.t("hotkey.title")).setDesc(instance.t("hotkey.desc")).addToggle(toggle=>{toggle.setValue(this.settings.separateHotkey).onChange(async value=>{this.settings.separateHotkey=value,await this.plugin.saveSettings(),this.renderSettingsPage("global")})}),new import_obsidian3.Setting(this.settingsPage).addButton(button=>{button.setButtonText(instance.t("global.copy")).onClick(async()=>{new EnhancedCopyViewModal(this.app,this.settings,result=>{this.settings=result,this.plugin.saveSettings(),this.display()}).open()}).buttonEl.classList.add("full-width")}).infoEl.classList.add("hide-info"),new import_obsidian3.Setting(this.settingsPage).setName(instance.t("debug.title")).setDesc(instance.t("debug.desc")).addToggle(toggle=>{toggle.setValue(this.settings.devMode).onChange(async value=>{this.settings.devMode=value,await this.plugin.saveSettings()})})}renderReading(){this.settingsPage.empty(),this.settingsPage.addClasses(["reading"]),this.createReadingSettings(this.settings.reading)}renderEdit(){this.settingsPage.empty(),this.settingsPage.addClasses(["edit"]),this.createEditSettings(this.settings.editing)}highlight(settings){return new import_obsidian3.Setting(this.settingsPage).setName(instance.t("highlight.title")).setDesc(instance.t("highlight.desc")).addToggle(toggle=>{toggle.setValue(settings.highlight).onChange(async value=>{settings.highlight=value,await this.plugin.saveSettings()})})}overrideSetting(settings){return new import_obsidian3.Setting(this.settingsPage).setName(instance.t("overrideCopy.title")).setDesc(instance.t("overrideCopy.desc")).addToggle(toggle=>{toggle.setValue(settings.overrideNativeCopy).onChange(async value=>{settings.overrideNativeCopy=value,await this.plugin.saveSettings()})})}calloutTitle(settings){return new import_obsidian3.Setting(this.settingsPage).setName(instance.t("callout.title")).setDesc(instance.t("callout.desc")).setClass("enhanced-copy-dp").addDropdown(dropdown=>{dropdown.addOption("obsidian",instance.t("callout.obsidian")).addOption("strong",instance.t("callout.strong")).addOption("remove",instance.t("callout.remove")).addOption("removeKeepTitle",instance.t("callout.removeKeepTitle")).setValue(settings.callout).onChange(async value=>{settings.callout=value,await this.plugin.saveSettings()})})}footnotes(settings){return new import_obsidian3.Setting(this.settingsPage).setName(instance.t("removeFootnotesLinks.title")).setDesc(instance.t("removeFootnotesLinks.desc")).setClass("enhanced-copy-dp").addDropdown(dropdown=>{dropdown.addOption("keep",instance.t("removeFootnotesLinks.keep")).addOption("remove",instance.t("removeFootnotesLinks.remove")).addOption("format",instance.t("removeFootnotesLinks.format")).setValue(settings.footnotes).onChange(async value=>{settings.footnotes=value,await this.plugin.saveSettings()})})}links(settings){return new import_obsidian3.Setting(this.settingsPage).setName(instance.t("copyLinksAsText.title")).setDesc(instance.t("copyLinksAsText.desc")).setClass("enhanced-copy-dp").addDropdown(dropdown=>{dropdown.addOption("keep",instance.t("copyLinksAsText.keep")).addOption("remove",instance.t("copyLinksAsText.remove")).addOption("external",instance.t("copyLinksAsText.external")).setValue(settings.links).onChange(async value=>{settings.links=value,await this.plugin.saveSettings()})})}hardBreak(settings){return new import_obsidian3.Setting(this.settingsPage).setName(instance.t("hardBreaks.title")).setDesc(instance.t("hardBreaks.desc")).addToggle(toggle=>{toggle.setValue(settings.hardBreak).onChange(async value=>{settings.hardBreak=value,await this.plugin.saveSettings()})})}regexReplacementButton(settings){return new import_obsidian3.Setting(this.settingsPage).addButton(button=>{button.setButtonText(instance.t("openTextReplacer")).onClick(async()=>{settings.replaceText||(settings.replaceText=[]),new AllReplaceTextModal(this.app,structuredClone(settings.replaceText),async result=>{settings.replaceText=result}).open(),await this.plugin.saveSettings()}).buttonEl.classList.add("full-width")}).infoEl.classList.add("hide-info")}};var import_obsidian4=require("obsidian"),import_obsidian_dataview=__toESM(require_lib()),DataviewCompiler=class{settings;dvApi;sourceText;path;constructor(settings,dvApi,sourceText,path){this.settings=settings,this.dvApi=dvApi,this.sourceText=sourceText,this.path=path}escapeRegex(filepath){return filepath.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&")}dvJsMatch(){let dataviewJsPrefix=this.dvApi.settings.dataviewJsKeyword||"dataviewjs",dataViewJsRegex=new RegExp(`\`\`\`${this.escapeRegex(dataviewJsPrefix)}\\s(.+?)\`\`\``,"gsm");return this.sourceText.matchAll(dataViewJsRegex)}dvInlineQueryMatches(){let inlineQueryPrefix=this.dvApi.settings.inlineQueryPrefix||"=",inlineDataViewRegex=new RegExp(`\`${this.escapeRegex(inlineQueryPrefix)}(.+?)\``,"gsm");return this.sourceText.matchAll(inlineDataViewRegex)}dvInlineJSMatches(){let inlineJsQueryPrefix=this.dvApi.settings.inlineJsQueryPrefix||"$=",inlineJsDataViewRegex=new RegExp(`\`${this.escapeRegex(inlineJsQueryPrefix)}(.+?)\``,"gsm");return this.sourceText.matchAll(inlineJsDataViewRegex)}matches(){return{dataviewJsMatches:this.dvJsMatch(),inlineMatches:this.dvInlineQueryMatches(),inlineJsMatches:this.dvInlineJSMatches()}}sanitizeQuery(query){let isInsideCallout=!1,parts=query.split(`
`),sanitized=[];for(let part of parts)part.startsWith(">")?(isInsideCallout=!0,sanitized.push(part.substring(1).trim())):sanitized.push(part);let finalQuery=isInsideCallout?sanitized.join(`
`):query;return{isInsideCallout,finalQuery}}removeDataviewQueries(dataviewMarkdown){let toStr=dataviewMarkdown?.toString();return this.settings.convertDataview&&dataviewMarkdown&&toStr?toStr:""}surroundWithCalloutBlock(input){return` ${input.split(`
`).join(`
> `)}`}async dataviewDQL(query){let{isInsideCallout,finalQuery}=this.sanitizeQuery(query),markdown=this.removeDataviewQueries(await this.dvApi.tryQueryMarkdown(finalQuery,this.path));return isInsideCallout?this.surroundWithCalloutBlock(markdown):markdown}async dataviewJS(query){let{isInsideCallout,finalQuery}=this.sanitizeQuery(query),div=createEl("div"),component=new import_obsidian4.Component;await this.dvApi.executeJs(finalQuery,div,component,this.path),component.load();let markdown=this.removeDataviewQueries(div.innerHTML);return isInsideCallout?this.surroundWithCalloutBlock(markdown):markdown}async inlineDQLDataview(query){let dataviewResult=this.dvApi.evaluateInline(query,this.path);return dataviewResult.successful?this.removeDataviewQueries(dataviewResult.value):this.removeDataviewQueries(this.dvApi.settings.renderNullAs)}async inlineDataviewJS(query){let evaluateQuery=`
				const query = ${query};
				dv.paragraph(query);
			`,div=createEl("div"),component=new import_obsidian4.Component;return await this.dvApi.executeJs(evaluateQuery,div,component,this.path),component.load(),this.removeDataviewQueries((0,import_obsidian4.htmlToMarkdown)(div.innerHTML))}};async function convertDataviewQueries(settings,path,text,plugin){let app=plugin.app,replacedText=text,dataViewRegex=/```dataview\s(.+?)```/gms;if(!app.plugins.plugins.dataview||!(0,import_obsidian_dataview.isPluginEnabled)(app)||!settings.convertDataview?.enable)return replacedText;let dvApi=(0,import_obsidian_dataview.getAPI)(app);if(!dvApi||dvApi===void 0)return replacedText;let matches=text.matchAll(dataViewRegex),compiler=new DataviewCompiler(settings,dvApi,text,path),{dataviewJsMatches,inlineMatches,inlineJsMatches}=compiler.matches();if(!matches&&!inlineMatches&&!dataviewJsMatches&&!inlineJsMatches)return console.warn("No dataview queries found"),replacedText;if(settings.convertDataview?.dql?.block)for(let queryBlock of matches)try{let block=queryBlock[0],markdown=await compiler.dataviewDQL(queryBlock[1]);replacedText=replacedText.replace(block,markdown)}catch(e){return console.error(e),queryBlock[0]}if(settings.convertDataview?.djs?.block)for(let queryBlock of dataviewJsMatches)try{let block=queryBlock[0],markdown=await compiler.dataviewJS(queryBlock[1]);replacedText=replacedText.replace(block,markdown)}catch(e){return console.error(e),queryBlock[0]}if(settings.convertDataview?.dql?.inline)for(let inlineQuery of inlineMatches)try{let code=inlineQuery[0],query=inlineQuery[1].trim(),markdown=await compiler.inlineDQLDataview(query);replacedText=replacedText.replace(code,markdown)}catch(e){return console.error(e),inlineQuery[0]}if(settings.convertDataview?.djs?.inline)for(let inlineJsQuery of inlineJsMatches)try{let code=inlineJsQuery[0],markdown=await compiler.inlineDataviewJS(inlineJsQuery[1].trim());replacedText=replacedText.replace(code,markdown)}catch(e){return console.error(e),inlineJsQuery[0]}return replacedText}function removeEmptyLineBeforeList(markdown){let lines=markdown.split(`
`),newLines=[];for(let i=0;i<lines.length;i++){let line=lines[i];line.trim().length===0&&i+1<lines.length&&lines[i+1].startsWith("-")||newLines.push(line)}return newLines.join(`
`)}function removeLinksBracketsInMarkdown(markdown,settings){let regexLinks=/!?\[([^\]]+)\]\(([^)]+)\)/g;return settings.links==="remove"?markdown=markdown.replaceAll(regexLinks,"$1"):settings.links==="external"&&(markdown=markdown.replaceAll(regexLinks,(match,p1,p2)=>p2.startsWith("http")?match:p1)),markdown.replaceAll("\u21A9\uFE0E","")}function convertWikiToMarkdown(markdown){let regexWikiLinks=/\[\[([^\]]+)\]\]/g;return markdown.replaceAll(regexWikiLinks,(_match,p1)=>{let parts=p1.split("|");return parts.length===1?`[${p1}](${p1})`:`[${parts[1]}](${parts[0]})`})}function fixFootNotes(markdown,settings){let regexFootNotes=/\[{2}(\w+)\]{2}\((.*)\)/g;return settings.footnotes==="remove"?markdown=markdown.replace(regexFootNotes,""):settings.footnotes==="format"&&(markdown=markdown.replace(regexFootNotes,"[^$1]")),fixFootnoteContents(markdown,settings)}function fixFootnoteContents(markdown,overrides){let regexFootNotes=/(.*)\[\]\(#fnref-(\d)-\w+\)/g;return overrides.footnotes==="remove"?markdown.replace(regexFootNotes,"$1"):overrides.footnotes==="format"?(markdown=markdown.replace(regexFootNotes,"[^$2]: $1"),markdown.replace(/(\[\^\w+\]): (\d+)\./gm,"$1:")):markdown}function removeMarkdownFootNotes(markdown,overrides){if(overrides.footnotes==="remove"){let regexFootNotes=/^\[\^(\w+)\]:/gm;return markdown=markdown.replace(regexFootNotes,"$1:"),markdown.replace(/\[\^\w+]/g,"")}return markdown}function removeHighlightMark(markdown,settings){return settings.highlight?markdown.replace(/==([^=]+)==/g,"$1"):markdown}function hardBreak(markdown,settings,plugin){return settings.hardBreak?(markdown=markdown.replace(/ *\n/g,`  
`),markdown+="  "):(plugin.devLog(instance.t("log.noHardBreaks")),markdown=markdown.replace(/ *\n/g,`
`)),markdown}function convertCallout(markdown,overrides,plugin){plugin.devLog(instance.t("log.callout.title"),overrides.callout);let calloutRegex=/^>* *\[!(\w+)\|?(.*)\] *(.*)$/gm;return overrides.callout==="removeKeepTitle"||overrides.callout==="remove"?(plugin.devLog(instance.t("log.callout.remove")),markdown=markdown.replace(calloutRegex,(_match,_p1,_p2,p3)=>p3===""?"undefined":overrides.callout==="removeKeepTitle"?`> **${p3}**`:"undefined"),markdown.replace(`undefined
>`,">")):overrides.callout==="strong"?markdown.replace(calloutRegex,"> **$1** $3"):markdown}function convertTabToSpace(markdown,settings){if(settings.tabToSpace){let spaces=" ".repeat(settings.tabSpaceSize??4);return markdown.replace(/\t/g,spaces)}return markdown}function convertSpaceSize(markdown,settings){let countSpace=markdown.match(/^ +/gm);return settings.spaceReadingSize&&settings.spaceReadingSize>=0&&countSpace&&countSpace.forEach(space=>{let newSpace=" ".repeat(space.length/4*(settings.spaceReadingSize??1));markdown=markdown.replace(space,newSpace)}),markdown}function textReplacement(markdown,settings){let replacement=settings.replaceText;for(let replace of replacement){let pattern=replace.pattern;if(pattern.match(/^\/.*\/([gmiyus]+)?$/)){let flags=pattern.replace(/^\/.*\/([gmiyus]+)?$/,"$1"),regex=pattern.replace(/^\/(.*)\/(.*)$/,"$1");pattern=new RegExp(regex,flags.length>0?flags:void 0)}markdown=markdown.replace(pattern,replace.replacement)}return markdown}function convertMarkdown(markdown,overrides,plugin){return removeEmptyLineBeforeList(convertSpaceSize(convertCallout(hardBreak(removeHighlightMark(fixFootNotes(removeLinksBracketsInMarkdown(textReplacement(markdown,overrides),overrides),overrides),overrides),overrides,plugin),overrides,plugin),overrides))}async function convertEditMarkdown(markdown,overrides,plugin,path){return markdown=textReplacement(markdown,overrides),path&&overrides.convertDataview&&plugin.app.plugins.enabledPlugins.has("dataview")&&(markdown=await convertDataviewQueries(overrides,path,markdown,plugin)),overrides.wikiToMarkdown&&(markdown=convertWikiToMarkdown(markdown),markdown=removeLinksBracketsInMarkdown(markdown,overrides)),markdown=convertTabToSpace(markdown,overrides),markdown=removeMarkdownFootNotes(markdown,overrides),markdown=convertCallout(markdown,overrides,plugin),markdown=removeHighlightMark(markdown,overrides),hardBreak(markdown,overrides,plugin)}function removeDataBasePluginRelationShip(){if(activeDocument.querySelector("div.database-plugin__container")){let div=document.createElement("div"),getSelection=activeWindow.getSelection();if(!getSelection)return"";let fragment=getSelection.getRangeAt(0).cloneContents();div.appendChild(fragment);let allSpan=div.querySelectorAll("span");for(let span of allSpan)span.classList[0]==="database-plugin__relationship"&&(span.innerHTML=`
`);return div.innerText}else{let getSelection=activeWindow.getSelection();return getSelection?getSelection.toString():""}}function fixMetaBindCopy(html){return html.replace(/<code class="mb-view mb-view-inline"><div class="mb-view-wrapper mb-view-text mb-view-type-math">(.*?)<\/div><\/code>/gim,"$1").replace(/<div class="block-language-meta-bind-embed-internal-1"><div class="block-language-meta-bind-js-view mb-view"><div class="mb-view-wrapper"><p dir="auto">(.*)<\/p>/gim,"$1").replace(/<pre class="frontmatter language-yaml cm-s-obsidian .*"/gim,"").replace(/<div class="block-language-meta-bind-embed-internal-1">(.*)/gim,"").replace(/<span class="cm-atom">.*<\/span><span class="cm-meta">(.*)/gim,"").replace(/<code class="language-yaml is-loaded" data-lang="yaml">(.*)/gim,"").replace(/<code class="mb-view mb-view-inline"><div class="mb-view-wrapper mb-view-text mb-view-type-math"><\/div><\/code>/gim,"").replace('<div class="block-language-meta-bind-js-view mb-view"><div class="mb-view-wrapper"></div></div>',"")}var import_obsidian5=require("obsidian");function reNumerateList(div,type){let allLi=div.querySelectorAll("li"),allHaveDataLine=!0;for(let li of allLi)if(!li.hasAttribute("data-line")){allHaveDataLine=!1;break}if(allHaveDataLine){let ol=document.createElement(type);for(let li of allLi)ol.appendChild(li);div.innerHTML="",div.appendChild(ol)}return div}function replaceAllDivCalloutToBlockquote(div,commonAncestor,settings){let allDivCallout=div.querySelectorAll("div[class*='callout']"),calloutTitle="";for(let divCallout of allDivCallout){if(settings.callout!=="remove"&&settings.callout!=="removeKeepTitle"&&divCallout.classList[0]==="callout-title"){let calloutType=commonAncestor.attributes.getNamedItem("data-callout")?.value??(divCallout.parentElement?divCallout.parentElement.attributes.getNamedItem("data-callout")?.value:"");calloutTitle=`[!${calloutType}] `,settings.callout==="strong"&&(calloutTitle=`<strong>${capitalize2(calloutType)}</strong> `);let titleInner=divCallout.querySelector(".callout-title-inner");titleInner&&!calloutTitle.contains(titleInner.innerHTML.toLowerCase())?titleInner?.replaceWith(calloutTitle+titleInner?.innerHTML):titleInner?.replaceWith(calloutTitle)}let blockquote=document.createElement("blockquote");blockquote.innerHTML=divCallout.innerHTML,divCallout.replaceWith(blockquote)}let allTitleInner=div.querySelectorAll("div.callout-title-inner");for(let titleInner of allTitleInner)titleInner&&settings.callout!=="remove"?titleInner.innerHTML=calloutTitle.toLowerCase().contains(titleInner.innerHTML.toLowerCase())?`<strong>${calloutTitle}</strong>`:`<strong>${calloutTitle}${titleInner.innerHTML}</strong>`:titleInner&&settings.callout==="remove"&&titleInner.remove();return simplifyBlockquote(div)}function simplifyBlockquote(div){return div.querySelectorAll("blockquote").forEach(blockquote=>{let modifiedDivElement=document.createElement("div"),calloutTitleInner=blockquote.querySelector(".callout-title-inner"),calloutContent=blockquote.querySelector(".callout-content");if(!calloutTitleInner&&!calloutContent)return;let calloutTitleInnerText=calloutTitleInner?.innerHTML?`${calloutTitleInner.innerHTML}<br>`:"",calloutContentHTML=calloutContent?.innerHTML??"";modifiedDivElement.innerHTML=`
      <blockquote>
        ${calloutTitleInnerText}
        ${calloutContentHTML.replace("<p>","<span>").replace("</p>","</span>")}
      </blockquote>
    `,blockquote.replaceWith(modifiedDivElement)}),div}function capitalize2(string){return string===void 0?"":string.charAt(0).toUpperCase()+string.slice(1)}function getSelectionAsHTML(settings){let getSelection=activeWindow.getSelection();if(getSelection===null)return"";let range=getSelection.getRangeAt(0);if(!range)return"";let fragment=range.cloneContents(),div=document.createElement("div");div.appendChild(fragment);let commonAncestor=range.commonAncestorContainer;if(commonAncestor.nodeName==="OL"||commonAncestor.nodeName==="UL"){let type=commonAncestor.nodeName.toLowerCase();div=reNumerateList(div,type)}if(div=replaceAllDivCalloutToBlockquote(div,range.commonAncestorContainer,settings),settings.copyAsHTML)return div.innerHTML;let allNoConvert=div.querySelectorAll("[data-type='html']"),markdown=(0,import_obsidian5.htmlToMarkdown)(fixMetaBindCopy(div.innerHTML.replace(COLLAPSE_INDICATOR,"")));for(let noConvert of allNoConvert){let converted=(0,import_obsidian5.htmlToMarkdown)(noConvert.outerHTML);markdown=markdown.replace(converted,noConvert.outerHTML.replace(/ ?data-type=["']html["']/,""))}return markdown}function getHead(head,anchor){return head.line===anchor.line?head.ch<anchor.ch?head:anchor:head.line<anchor.line?head:anchor}function getAnchor(head,anchor){return head.line===anchor.line?head.ch<anchor.ch?anchor:head:head.line<anchor.line?anchor:head}function copySelectionRange(editor,plugin){let selectedText="",selection=editor.listSelections(),inlineTitle=activeWindow.document.querySelector(".inline-title:focus"),viewHeader=activeWindow.document.querySelector(".view-header-title:focus");if(inlineTitle?.textContent&&inlineTitle.textContent!=="")return inlineTitle.textContent;if(viewHeader?.textContent&&viewHeader.textContent!=="")return viewHeader.textContent;for(let selected of selection){let head=getHead(selected.head,selected.anchor),anchor=getAnchor(selected.head,selected.anchor);selectedText+=`${editor.getRange(head,anchor)}
`}if(selectedText=selectedText.substring(0,selectedText.length-1),selectedText===""){let getSelection=activeWindow.getSelection();return plugin.devLog(instance.t("log.empty")),getSelection===null?"":getSelection.toString()}return selectedText}function canvasSelectionText(app,plugin){let{settings}=plugin,editor=app.workspace.activeEditor;if(editor){let editorMode=editor.editor;return copySelectionRange(editorMode,plugin)}else return getSelectionAsHTML(settings.reading)}var EnhancedCopy=class extends import_obsidian6.Plugin{settings=DEFAULT_SETTINGS;activeMonkeys={};checkByRules(rule,path,tags,frontmatter){return!!(rule.type==="path"&&path.match(rule.value)||rule.type==="tag"&&tags.find(tag=>tag.match(rule.value))||rule.type==="frontmatter"&&frontmatter?.find(fm=>fm.match(rule.value)))}getProfile(viewOfType){let activeFile=this.app.workspace.getActiveFile();if(!activeFile)return;let path=activeFile.path,cache=this.app.metadataCache.getFileCache(activeFile),cacheFrontmatterKeys=cache?.frontmatter?.enhanced_copy??void 0,enhancedCopyFrontmatter=cacheFrontmatterKeys&&typeof cacheFrontmatterKeys=="string"?[cacheFrontmatterKeys]:cacheFrontmatterKeys,tags=cache?(0,import_obsidian6.getAllTags)(cache)??[]:[],profiles=this.settings.profiles;for(let profile3 of profiles)if(!(viewOfType&&profile3.applyingTo!=="all"&&profile3.applyingTo!==viewOfType)&&profile3.autoRules){if(profile3.autoRules.find(rule=>rule.not&&this.checkByRules(rule,path,tags,enhancedCopyFrontmatter)))continue;for(let rule of profile3.autoRules)if(!rule.not&&this.checkByRules(rule,path,tags,enhancedCopyFrontmatter))return profile3}}async enhancedCopy(profile3){if(document.querySelector(".modal-container"))return activeWindow.getSelection()?.toString()??"";let activeView=this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView),file=this.app.workspace.getActiveFile(),viewIn,selectedText;if(activeView&&activeView.getMode()!=="source")this.devLog(instance.t("log.readingMode")),selectedText=getSelectionAsHTML(profile3??this.settings.reading),viewIn="reading";else if(activeView){this.devLog(instance.t("log.editMode"));let editor=activeView.editor;selectedText=copySelectionRange(editor,this),viewIn="edit"}else{let leafType=this.app.workspace.getActiveViewOfType(import_obsidian6.ItemView)?.getViewType();leafType==="canvas"?(selectedText=canvasSelectionText(this.app,this),viewIn=this.app.workspace.activeEditor?"edit":"reading"):(selectedText=leafType==="database-plugin"?removeDataBasePluginRelationShip():activeWindow.getSelection()?.toString()??"",viewIn="reading")}profile3||(profile3=this.getProfile(viewIn)),this.devLog("Profile: ",profile3);let exportAsHTML=profile3?profile3?.copyAsHTML??!1:this.settings.reading.copyAsHTML,applyingTo=profile3?.applyingTo??this.settings.applyingTo;return selectedText&&selectedText.trim().length>0?(!exportAsHTML&&(applyingTo==="all"||applyingTo===viewIn)&&(selectedText=viewIn==="edit"?await convertEditMarkdown(selectedText,profile3??this.settings.editing,this,file?.path):convertMarkdown(selectedText,profile3??this.settings.reading,this)),selectedText):(viewIn==="edit",selectedText)}async overrideNativeCopy(leaf){let activeView=this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);if(!(activeView&&activeView.getMode()!=="source"&&!this.settings.reading.overrideNativeCopy)&&!(activeView&&activeView.getMode()==="source"&&!this.settings.editing.overrideNativeCopy))try{return around(leaf.view,{handleCopy:()=>async event=>{try{let selectedText=await this.enhancedCopy();selectedText&&(event.preventDefault(),event.clipboardData?.setData("text/plain",selectedText))}catch(e){console.error(e)}}})}catch(e){console.error(e)}}async editorCopyHandler(event,_editor){let selectedText=await this.enhancedCopy();return event.preventDefault(),event.clipboardData?.setData("text/plain",selectedText),!0}async editorCutHandler(event,_editor){let selectedText=await this.enhancedCopy();event.clipboardData?.setData("text/plain",selectedText),event.preventDefault();let editorObs=this.app.workspace.activeEditor?.editor;editorObs&&editorObs.replaceSelection("")}async onload(){console.log(`Enhanced copy v.${this.manifest.version} loaded.`),await instance.init({lng:translationLanguage,fallbackLng:"en",resources,returnNull:!1,returnEmptyString:!1}),await this.loadSettings(),this.addSettingTab(new EnhancedCopySettingTab(this.app,this));for(let profile3 of this.settings.profiles)profile3.name&&this.addCommand({id:`copy-${profile3.name}-in-markdown`,name:profile3.name,checkCallback:async checking=>{let view3=this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView),readingMode=view3&&view3.getMode()!=="source";return profile3.applyingTo==="all"||profile3.applyingTo==="reading"&&readingMode||profile3.applyingTo==="edit"&&!readingMode?(checking||navigator.clipboard.writeText(await this.enhancedCopy(profile3)),!0):!1}});if(!this.settings.separateHotkey||this.settings.applyingTo!=="all"?this.addCommand({id:"copy-all-in-markdown",name:instance.t("commands.all"),callback:async()=>{navigator.clipboard.writeText(await this.enhancedCopy())}}):this.settings.separateHotkey&&((this.settings.applyingTo==="all"||this.settings.applyingTo==="edit")&&this.addCommand({id:"copy-editor-in-markdown",name:instance.t("commands.editor"),editorCallback:async editor=>{let file=this.app.workspace.getActiveFile(),selectedText=copySelectionRange(editor,this);if(selectedText&&selectedText.trim().length>0){let profile3=this.getProfile("edit")??this.settings.editing;selectedText=await convertEditMarkdown(selectedText,profile3,this,file?.path),navigator.clipboard.writeText(selectedText)}}}),(this.settings.applyingTo==="all"||this.settings.applyingTo==="reading")&&this.addCommand({id:"copy-reading-in-markdown",name:instance.t("commands.reading"),checkCallback:checking=>{let view3=this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);if(view3&&view3.getMode()!=="source"){if(!checking){let profile3=this.getProfile("reading")??this.settings.reading,selectedText=getSelectionAsHTML(profile3);this.settings.copyAsHTML||(selectedText=convertMarkdown(selectedText,profile3,this)),navigator.clipboard.writeText(selectedText)}return!0}return!1}}),this.addCommand({id:"copy-other-in-markdown",name:instance.t("commands.other"),checkCallback:async checking=>{let markdownView=this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);if(this.devLog(!markdownView,checking),!markdownView){if(!checking){let leafType=this.app.workspace.getActiveViewOfType(import_obsidian6.ItemView)?.getViewType(),selectedText,viewIn;if(leafType==="canvas"?(selectedText=canvasSelectionText(this.app,this),viewIn=this.app.workspace.activeEditor?"edit":"reading"):(selectedText=leafType==="database-plugin"?removeDataBasePluginRelationShip():activeWindow.getSelection()?.toString()??"",viewIn="reading"),selectedText&&selectedText.trim().length>0){let isProfile=this.getProfile(viewIn),profile3=isProfile??this.settings;!profile3.copyAsHTML&&(profile3.applyingTo==="all"||profile3.applyingTo===viewIn)&&(selectedText=viewIn==="edit"?await convertEditMarkdown(selectedText,isProfile??this.settings.editing,this,this.app.workspace.getActiveFile()?.path):convertMarkdown(selectedText,isProfile??this.settings.reading,this)),navigator.clipboard.writeText(selectedText)}}return!0}return!1}})),(this.settings.reading.overrideNativeCopy||this.settings.editing.overrideNativeCopy)&&(this.registerEvent(this.app.workspace.on("active-leaf-change",async leaf=>{if(!leaf){for(let monkey of Object.values(this.activeMonkeys))monkey();this.activeMonkeys={};return}this.activeMonkeys[leaf.id]=this.overrideNativeCopy(leaf),leaf.view instanceof import_obsidian6.ItemView&&leaf.view.getViewType()==="canvas"&&this.settings.reading.overrideNativeCopy&&(leaf.view.containerEl.addEventListener("copy",event=>{this.editorCopyHandler(event)}),leaf.view.containerEl.addEventListener("cut",event=>{this.editorCutHandler(event)}))})),this.settings.editing.overrideNativeCopy)){let copyExt=import_view.EditorView.domEventHandlers({copy:this.editorCopyHandler.bind(this)}),cutExt=import_view.EditorView.domEventHandlers({cut:this.editorCutHandler.bind(this)});this.registerEditorExtension(copyExt),this.registerEditorExtension(cutExt)}this.registerEvent(this.app.workspace.on("editor-menu",(menu,editor,_view)=>{menu.addItem(item=>{item.setTitle(instance.t("commands.brute")),item.setIcon("clipboard"),item.onClick(()=>{navigator.clipboard.writeText(copySelectionRange(editor,this))})})})),this.addCommand({id:"copy-brute",name:instance.t("commands.brute"),callback:()=>{let editor=this.app.workspace.activeEditor?.editor;editor?navigator.clipboard.writeText(copySelectionRange(editor,this)):navigator.clipboard.writeText(activeWindow.getSelection()?.toString()??"")}})}async onunload(){console.log(`CopyReadingInMarkdown v.${this.manifest.version} unloaded.`);for(let monkey of Object.values(this.activeMonkeys))await monkey.remove&&await monkey.remove()}async loadSettings(){let loadedData=await this.loadData();try{this.settings=esm_default(DEFAULT_SETTINGS,loadedData)}catch{console.warn("[Enhanced copy] Error while deep merging settings, using default loading method"),this.settings=Object.assign({},DEFAULT_SETTINGS,loadedData)}}async saveSettings(){await this.saveData(this.settings)}devLog(...args){if(!(import_obsidian6.Platform.isDesktop&&this.settings.devMode))return;let callFunction=new Error().stack?.split(`
`)[2].trim();callFunction=callFunction?.substring(callFunction.indexOf("at ")+3,callFunction.lastIndexOf(" (")),callFunction=callFunction.replace("Object.callback",""),callFunction=callFunction.length>0?callFunction:"main";let date=new Date().toISOString().slice(11,23);console.log(`[${date}](${callFunction}):
`,...args)}};

/* nosourcemap */