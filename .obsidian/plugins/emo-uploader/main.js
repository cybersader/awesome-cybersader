var Rt=Object.create;var X=Object.defineProperty;var kt=Object.getOwnPropertyDescriptor;var Dt=Object.getOwnPropertyNames;var Mt=Object.getPrototypeOf,Nt=Object.prototype.hasOwnProperty;var ke=l=>X(l,"__esModule",{value:!0});var Ot=(l,e)=>()=>(e||l((e={exports:{}}).exports,e),e.exports),Lt=(l,e)=>{ke(l);for(var t in e)X(l,t,{get:e[t],enumerable:!0})},Bt=(l,e,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Dt(e))!Nt.call(l,r)&&r!=="default"&&X(l,r,{get:()=>e[r],enumerable:!(t=kt(e,r))||t.enumerable});return l},F=l=>Bt(ke(X(l!=null?Rt(Mt(l)):{},"default",l&&l.__esModule&&"default"in l?{get:()=>l.default,enumerable:!0}:{value:l,enumerable:!0})),l);var _t=Ot((Jo,Q)=>{(function(){"use strict";var l="input is invalid type",e=typeof window=="object",t=e?window:{};t.JS_SHA256_NO_WINDOW&&(e=!1);var r=!e&&typeof self=="object",o=!t.JS_SHA256_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;o?t=global:r&&(t=self);var a=!t.JS_SHA256_NO_COMMON_JS&&typeof Q=="object"&&Q.exports,n=typeof define=="function"&&define.amd,x=!t.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer!="undefined",i="0123456789abcdef".split(""),S=[-2147483648,8388608,32768,128],g=[24,16,8,0],H=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Y=["hex","array","digest","arrayBuffer"],_=[];(t.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(s){return Object.prototype.toString.call(s)==="[object Array]"}),x&&(t.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(s){return typeof s=="object"&&s.buffer&&s.buffer.constructor===ArrayBuffer});var ve=function(s,h){return function(c){return new v(h,!0).update(c)[s]()}},Ue=function(s){var h=ve("hex",s);o&&(h=It(h,s)),h.create=function(){return new v(s)},h.update=function(f){return h.create().update(f)};for(var c=0;c<Y.length;++c){var d=Y[c];h[d]=ve(d,s)}return h},It=function(s,h){var c=require("crypto"),d=require("buffer").Buffer,f=h?"sha224":"sha256",p;d.from&&!t.JS_SHA256_NO_BUFFER_FROM?p=d.from:p=function(m){return new d(m)};var b=function(m){if(typeof m=="string")return c.createHash(f).update(m,"utf8").digest("hex");if(m==null)throw new Error(l);return m.constructor===ArrayBuffer&&(m=new Uint8Array(m)),Array.isArray(m)||ArrayBuffer.isView(m)||m.constructor===d?c.createHash(f).update(p(m)).digest("hex"):s(m)};return b},Ie=function(s,h){return function(c,d){return new K(c,h,!0).update(d)[s]()}},Re=function(s){var h=Ie("hex",s);h.create=function(f){return new K(f,s)},h.update=function(f,p){return h.create(f).update(p)};for(var c=0;c<Y.length;++c){var d=Y[c];h[d]=Ie(d,s)}return h};function v(s,h){h?(_[0]=_[16]=_[1]=_[2]=_[3]=_[4]=_[5]=_[6]=_[7]=_[8]=_[9]=_[10]=_[11]=_[12]=_[13]=_[14]=_[15]=0,this.blocks=_):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],s?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=s}v.prototype.update=function(s){if(!this.finalized){var h,c=typeof s;if(c!=="string"){if(c==="object"){if(s===null)throw new Error(l);if(x&&s.constructor===ArrayBuffer)s=new Uint8Array(s);else if(!Array.isArray(s)&&(!x||!ArrayBuffer.isView(s)))throw new Error(l)}else throw new Error(l);h=!0}for(var d,f=0,p,b=s.length,m=this.blocks;f<b;){if(this.hashed&&(this.hashed=!1,m[0]=this.block,m[16]=m[1]=m[2]=m[3]=m[4]=m[5]=m[6]=m[7]=m[8]=m[9]=m[10]=m[11]=m[12]=m[13]=m[14]=m[15]=0),h)for(p=this.start;f<b&&p<64;++f)m[p>>2]|=s[f]<<g[p++&3];else for(p=this.start;f<b&&p<64;++f)d=s.charCodeAt(f),d<128?m[p>>2]|=d<<g[p++&3]:d<2048?(m[p>>2]|=(192|d>>6)<<g[p++&3],m[p>>2]|=(128|d&63)<<g[p++&3]):d<55296||d>=57344?(m[p>>2]|=(224|d>>12)<<g[p++&3],m[p>>2]|=(128|d>>6&63)<<g[p++&3],m[p>>2]|=(128|d&63)<<g[p++&3]):(d=65536+((d&1023)<<10|s.charCodeAt(++f)&1023),m[p>>2]|=(240|d>>18)<<g[p++&3],m[p>>2]|=(128|d>>12&63)<<g[p++&3],m[p>>2]|=(128|d>>6&63)<<g[p++&3],m[p>>2]|=(128|d&63)<<g[p++&3]);this.lastByteIndex=p,this.bytes+=p-this.start,p>=64?(this.block=m[16],this.start=p-64,this.hash(),this.hashed=!0):this.start=p}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},v.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var s=this.blocks,h=this.lastByteIndex;s[16]=this.block,s[h>>2]|=S[h&3],this.block=s[16],h>=56&&(this.hashed||this.hash(),s[0]=this.block,s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),s[14]=this.hBytes<<3|this.bytes>>>29,s[15]=this.bytes<<3,this.hash()}},v.prototype.hash=function(){var s=this.h0,h=this.h1,c=this.h2,d=this.h3,f=this.h4,p=this.h5,b=this.h6,m=this.h7,w=this.blocks,P,U,I,N,E,O,L,j,ee,te,W;for(P=16;P<64;++P)E=w[P-15],U=(E>>>7|E<<25)^(E>>>18|E<<14)^E>>>3,E=w[P-2],I=(E>>>17|E<<15)^(E>>>19|E<<13)^E>>>10,w[P]=w[P-16]+U+w[P-7]+I<<0;for(W=h&c,P=0;P<64;P+=4)this.first?(this.is224?(j=300032,E=w[0]-1413257819,m=E-150054599<<0,d=E+24177077<<0):(j=704751109,E=w[0]-210244248,m=E-1521486534<<0,d=E+143694565<<0),this.first=!1):(U=(s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10),I=(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7),j=s&h,N=j^s&c^W,L=f&p^~f&b,E=m+I+L+H[P]+w[P],O=U+N,m=d+E<<0,d=E+O<<0),U=(d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),I=(m>>>6|m<<26)^(m>>>11|m<<21)^(m>>>25|m<<7),ee=d&s,N=ee^d&h^j,L=m&f^~m&p,E=b+I+L+H[P+1]+w[P+1],O=U+N,b=c+E<<0,c=E+O<<0,U=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),I=(b>>>6|b<<26)^(b>>>11|b<<21)^(b>>>25|b<<7),te=c&d,N=te^c&s^ee,L=b&m^~b&f,E=p+I+L+H[P+2]+w[P+2],O=U+N,p=h+E<<0,h=E+O<<0,U=(h>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10),I=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),W=h&c,N=W^h&d^te,L=p&b^~p&m,E=f+I+L+H[P+3]+w[P+3],O=U+N,f=s+E<<0,s=E+O<<0,this.chromeBugWorkAround=!0;this.h0=this.h0+s<<0,this.h1=this.h1+h<<0,this.h2=this.h2+c<<0,this.h3=this.h3+d<<0,this.h4=this.h4+f<<0,this.h5=this.h5+p<<0,this.h6=this.h6+b<<0,this.h7=this.h7+m<<0},v.prototype.hex=function(){this.finalize();var s=this.h0,h=this.h1,c=this.h2,d=this.h3,f=this.h4,p=this.h5,b=this.h6,m=this.h7,w=i[s>>28&15]+i[s>>24&15]+i[s>>20&15]+i[s>>16&15]+i[s>>12&15]+i[s>>8&15]+i[s>>4&15]+i[s&15]+i[h>>28&15]+i[h>>24&15]+i[h>>20&15]+i[h>>16&15]+i[h>>12&15]+i[h>>8&15]+i[h>>4&15]+i[h&15]+i[c>>28&15]+i[c>>24&15]+i[c>>20&15]+i[c>>16&15]+i[c>>12&15]+i[c>>8&15]+i[c>>4&15]+i[c&15]+i[d>>28&15]+i[d>>24&15]+i[d>>20&15]+i[d>>16&15]+i[d>>12&15]+i[d>>8&15]+i[d>>4&15]+i[d&15]+i[f>>28&15]+i[f>>24&15]+i[f>>20&15]+i[f>>16&15]+i[f>>12&15]+i[f>>8&15]+i[f>>4&15]+i[f&15]+i[p>>28&15]+i[p>>24&15]+i[p>>20&15]+i[p>>16&15]+i[p>>12&15]+i[p>>8&15]+i[p>>4&15]+i[p&15]+i[b>>28&15]+i[b>>24&15]+i[b>>20&15]+i[b>>16&15]+i[b>>12&15]+i[b>>8&15]+i[b>>4&15]+i[b&15];return this.is224||(w+=i[m>>28&15]+i[m>>24&15]+i[m>>20&15]+i[m>>16&15]+i[m>>12&15]+i[m>>8&15]+i[m>>4&15]+i[m&15]),w},v.prototype.toString=v.prototype.hex,v.prototype.digest=function(){this.finalize();var s=this.h0,h=this.h1,c=this.h2,d=this.h3,f=this.h4,p=this.h5,b=this.h6,m=this.h7,w=[s>>24&255,s>>16&255,s>>8&255,s&255,h>>24&255,h>>16&255,h>>8&255,h&255,c>>24&255,c>>16&255,c>>8&255,c&255,d>>24&255,d>>16&255,d>>8&255,d&255,f>>24&255,f>>16&255,f>>8&255,f&255,p>>24&255,p>>16&255,p>>8&255,p&255,b>>24&255,b>>16&255,b>>8&255,b&255];return this.is224||w.push(m>>24&255,m>>16&255,m>>8&255,m&255),w},v.prototype.array=v.prototype.digest,v.prototype.arrayBuffer=function(){this.finalize();var s=new ArrayBuffer(this.is224?28:32),h=new DataView(s);return h.setUint32(0,this.h0),h.setUint32(4,this.h1),h.setUint32(8,this.h2),h.setUint32(12,this.h3),h.setUint32(16,this.h4),h.setUint32(20,this.h5),h.setUint32(24,this.h6),this.is224||h.setUint32(28,this.h7),s};function K(s,h,c){var d,f=typeof s;if(f==="string"){var p=[],b=s.length,m=0,w;for(d=0;d<b;++d)w=s.charCodeAt(d),w<128?p[m++]=w:w<2048?(p[m++]=192|w>>6,p[m++]=128|w&63):w<55296||w>=57344?(p[m++]=224|w>>12,p[m++]=128|w>>6&63,p[m++]=128|w&63):(w=65536+((w&1023)<<10|s.charCodeAt(++d)&1023),p[m++]=240|w>>18,p[m++]=128|w>>12&63,p[m++]=128|w>>6&63,p[m++]=128|w&63);s=p}else if(f==="object"){if(s===null)throw new Error(l);if(x&&s.constructor===ArrayBuffer)s=new Uint8Array(s);else if(!Array.isArray(s)&&(!x||!ArrayBuffer.isView(s)))throw new Error(l)}else throw new Error(l);s.length>64&&(s=new v(h,!0).update(s).array());var P=[],U=[];for(d=0;d<64;++d){var I=s[d]||0;P[d]=92^I,U[d]=54^I}v.call(this,h,c),this.update(U),this.oKeyPad=P,this.inner=!0,this.sharedMemory=c}K.prototype=new v,K.prototype.finalize=function(){if(v.prototype.finalize.call(this),this.inner){this.inner=!1;var s=this.array();v.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(s),v.prototype.finalize.call(this)}};var D=Ue();D.sha256=D,D.sha224=Ue(!0),D.sha256.hmac=Re(),D.sha224.hmac=Re(!0),a?Q.exports=D:(t.sha256=D.sha256,t.sha224=D.sha224,n&&define(function(){return D}))})()});Lt(exports,{default:()=>_e});var J=F(require("obsidian"));var at=F(require("obsidian"));var De={};var Me={};var Ne={};var Oe={};var re={domain:"dmain","no sign in":"Imgur no sign in!","not required":"not required",broken:"Emo broken. Check your target","upload error":" upload error","parms error":"Emo need more prams","target hosting":"target hosting","target hosting desc":"Choose your target. Before uploading, make sure you have completely filled in the necessary parameters of the selected platform.","Cloudinary Settings":"Cloudinary Settings","Upload Folder desc":"Folder name to use in Cloudinary. Note, this will be ignored if you have a folder set in your Cloudinary Upload Preset. Not required.","Github Settings":"Github Settings",owner:"owner",repo:"repo",branch:"branch",token:"token",message:"message",path:"path",cdn:"CDN","random filename":"random filename","random filename desc":"Random file names will greatly avoid duplicate file names. If you are sure that you need to use the original file name during this upload, make sure that no duplicate naming will occur under the path you choose.","imgbb Settings":"imgbb Settings",tips:"Tips","tips text":"Imgur anonymous upload will produce the link in this format: ![deletehash](url). [deletehash] is used to delete the image you just uploaded. If your note will be used for publicity, please remember to delete it in time. Authentication upload can be deleted on Imgur.","Imgur Settings":"Imgur Settings","Anonymous Upload":"Anonymous Upload","Anonymous Upload desc":"Files uploaded anonymously will not show in your Imgur account.",imgurid:"ID","built-in id desc":"The built-in ID has a daily usage limit, if it is temporarily invalid, you can use your own client ID here to upload and delete. Not required.",delete:"delete","delete desc":"If you want to delete the image on Imgur, delete it here with the deletehash.","delete btn":"Delete","delete done":"delete done","delete fail":"delete fail",authenticate:"authenticate","auth desc":"Re-auth is required for the change ID to take effect.","imgur account":"Authenticated as: ","auth error":"Authentication failed with error: ","sign in":"sign in","Sign Out":"Sign Out","ImgURL Settings":"ImgURL Settings","SM.MS Settings":"SM.MS Settings","Catbox Settings":"Catbox Settings","Chevereto Settings":"Chevereto Settings","AList Settings":"Alist Settings",username:"username",password:"password",uploadPath:"uploadPath"};var Le={};var Be={};var $e={};var He={};var Ge={};var je={};var Ve={};var ze={};var Je={};var Ye={};var Ke={};var We={};var Xe={};var Ze={};var Qe={};var et={};var tt={domain:"\u57DF\u540D","no sign in":"Imgur\u672A\u767B\u5F55\uFF01","not required":"\u53EF\u4E0D\u586B",broken:"Emo\u5DE5\u4F5C\u5F02\u5E38\uFF0C\u68C0\u89C6\u4F60\u7684\u76EE\u6807\u5E73\u53F0\u9009\u62E9","upload error":"\u4E0A\u4F20\u5931\u8D25","parms error":"\u5F53\u524D\u5E73\u53F0\u6240\u9700\u5FC5\u8981\u53C2\u6570\u672A\u586B\u5199\u5B8C\u5168","target hosting":"\u6258\u7BA1\u5E73\u53F0","target hosting desc":"\u9009\u62E9\u76EE\u6807\u3002\u4E0A\u4F20\u4E4B\u524D\uFF0C\u8BF7\u786E\u4FDD\u6240\u9009\u5E73\u53F0\u7684\u5FC5\u8981\u53C2\u6570\u5DF2\u586B\u5199\u5B8C\u6210\u3002","Cloudinary Settings":"Cloudinary\u914D\u7F6E","Upload Folder desc":"\u8981\u5728Cloudinary\u4E2D\u4F7F\u7528\u7684\u6587\u4EF6\u5939\u540D\u79F0\u3002\u6CE8\u610F\uFF0C\u5982\u679C\u5728Cloudinary\u9884\u8BBE\u4E86\u6587\u4EF6\u5939\uFF0C\u5219\u4F1A\u5FFD\u7565\u6B64\u9879\u3002\u53EF\u4E0D\u586B\u3002","Github Settings":"Github\u914D\u7F6E",owner:"\u7528\u6237\u540D",repo:"\u4ED3\u5E93",branch:"\u5206\u652F",token:"\u4EE4\u724C",message:"\u63D0\u4EA4\u4FE1\u606F",path:"\u8DEF\u5F84",cdn:"CDN","random filename":"\u968F\u673A\u6587\u4EF6\u540D","random filename desc":"\u91C7\u7528\u968F\u673A\u6587\u4EF6\u540D\u5C06\u6781\u5927\u907F\u514D\u91CD\u540D\u3002\u5982\u679C\u786E\u5B9A\u5728\u4E0A\u4F20\u8FC7\u7A0B\u4E2D\u9700\u8981\u4F7F\u7528\u539F\u6587\u4EF6\u540D\uFF0C\u8BF7\u786E\u4FDD\u6240\u9009\u8DEF\u5F84\u4E0B\u4E0D\u4F1A\u51FA\u73B0\u91CD\u540D\u95EE\u9898\u3002","imgbb Settings":"imgbb\u914D\u7F6E",tips:"\u8D34\u58EB","tips text":"Imgur\u533F\u540D\u4E0A\u4F20\u5C06\u751F\u6210\u4EE5\u4E0B\u683C\u5F0F\u7684\u94FE\u63A5\uFF1A![deletehash](url)\u3002[deletehash]\u7528\u4E8E\u5220\u9664\u521A\u521A\u4E0A\u4F20\u7684\u56FE\u50CF\u3002\u5982\u679C\u60A8\u7684\u7B14\u8BB0\u4F1A\u88AB\u516C\u5F00\uFF0C\u8BF7\u53CA\u65F6\u5728\u7B14\u8BB0\u4E2D\u5220\u9664deletehash\u3002\u8BA4\u8BC1\u4E0A\u4F20\u53EF\u5728Imgur\u4E0A\u5220\u9664\u3002","Imgur Settings":"Imgur\u914D\u7F6E","Anonymous Upload":"\u533F\u540D\u4E0A\u4F20","Anonymous Upload desc":"\u533F\u540D\u4E0A\u4F20\u7684\u6587\u4EF6\u4E0D\u4F1A\u663E\u793A\u5728Imgur\u5E10\u6237\u4E2D\u3002",imgurid:"\u5BA2\u6237\u7AEFID","built-in id desc":"\u5185\u7F6EID\u6709\u6BCF\u65E5\u4F7F\u7528\u9650\u5236\uFF0C\u5982\u679C\u6682\u65F6\u5931\u6548\uFF0C\u53EF\u4EE5\u4F7F\u7528\u81EA\u5DF1\u7684\u5BA2\u6237\u7AEFID\u4EE5\u8FDB\u884C\u4E0A\u4F20\u548C\u5220\u9664\u3002\u53EF\u4E0D\u586B\u3002",delete:"\u5220\u9664","delete desc":"\u5982\u679C\u9700\u8981\u5220\u9664Imgur\u4E0A\u7684\u56FE\u50CF\uFF0C\u8BF7\u5728\u6B64\u5904\u4F7F\u7528deletehash\u5C06\u5176\u5220\u9664\u3002","delete btn":"\u5220\u9664","delete done":"\u5220\u9664\u6210\u529F","delete fail":"\u5220\u9664\u5931\u8D25",authenticate:"\u8BA4\u8BC1","auth desc":"\u66F4\u6539ID\u9700\u8981\u91CD\u65B0\u8BA4\u8BC1\u624D\u80FD\u751F\u6548\u3002","imgur account":"\u5F53\u524D\u7528\u6237\uFF1A ","auth error":"\u8BA4\u8BC1\u9519\u8BEF: ","sign in":"\u767B\u5F55","Sign Out":"\u6CE8\u9500","ImgURL Settings":"ImgURL\u914D\u7F6E","SM.MS Settings":"SM.MS\u914D\u7F6E","Catbox Settings":"Catbox\u914D\u7F6E","Chevereto Settings":"Chevereto\u914D\u7F6E","AList Settings":"Alist\u914D\u7F6E",username:"\u7528\u6237\u540D",password:"\u5BC6\u7801",uploadPath:"\u4E0A\u4F20\u8DEF\u5F84"};var rt={domain:"\u57DF\u540D","no sign in":"Imgur\u672A\u767B\u9304\uFF01","not required":"\u53EF\u4E0D\u586B",broken:"Emo\u5DE5\u4F5C\u7570\u5E38\uFF0C\u6AA2\u8996\u4F60\u7684\u76EE\u6A19\u5E73\u53F0\u9078\u64C7","upload error":"\u4E0A\u50B3\u5931\u6557","parms error":"\u76EE\u524D\u5E73\u53F0\u6240\u9700\u5FC5\u8981\u53C3\u6578\u672A\u586B\u5BEB\u5B8C\u5168","target hosting":"\u8A17\u7BA1\u5E73\u53F0","target hosting desc":"\u9078\u64C7\u76EE\u6A19\u3002\u4E0A\u50B3\u4E4B\u524D\uFF0C\u8ACB\u78BA\u4FDD\u6240\u9078\u5E73\u53F0\u7684\u5FC5\u8981\u53C3\u6578\u5DF2\u586B\u5BEB\u5B8C\u6210\u3002","Cloudinary Settings":"Cloudinary\u914D\u7F6E","Upload Folder desc":"\u8981\u5728Cloudinary\u4E2D\u4F7F\u7528\u7684\u8CC7\u6599\u593E\u540D\u7A31\u3002\u6CE8\u610F\uFF0C\u5982\u679C\u5728Cloudinary\u9810\u8A2D\u4E86\u8CC7\u6599\u593E\uFF0C\u5247\u6703\u5FFD\u7565\u6B64\u9805\u3002\u53EF\u4E0D\u586B\u3002","Github Settings":"Github\u914D\u7F6E",owner:"\u4F7F\u7528\u8005\u540D\u7A31",repo:"\u5132\u5B58\u5EAB",branch:"\u5206\u652F",token:"\u4EE4\u724C",message:"\u63D0\u4EA4\u8CC7\u8A0A",path:"\u8DEF\u5F91",cdn:"CDN","random filename":"\u96A8\u6A5F\u6A94\u540D","random filename desc":"\u63A1\u7528\u96A8\u6A5F\u6A94\u540D\u5C07\u6975\u5927\u907F\u514D\u91CD\u540D\u3002\u5982\u679C\u78BA\u5B9A\u5728\u4E0A\u50B3\u904E\u7A0B\u4E2D\u9700\u8981\u4F7F\u7528\u539F\u6A94\u540D\uFF0C\u8ACB\u78BA\u4FDD\u6240\u9078\u8DEF\u5F91\u4E0B\u4E0D\u6703\u51FA\u73FE\u91CD\u540D\u554F\u984C\u3002","imgbb Settings":"imgbb\u914D\u7F6E",tips:"\u5C0F\u6280\u5DE7","tips text":"Imgur\u533F\u540D\u4E0A\u50B3\u5C07\u7522\u751F\u4EE5\u4E0B\u683C\u5F0F\u7684\u93C8\u63A5\uFF1A![deletehash](url)\u3002[deletehash]\u7528\u65BC\u522A\u9664\u525B\u525B\u4E0A\u50B3\u7684\u5F71\u50CF\u3002\u5982\u679C\u60A8\u7684\u7B46\u8A18\u6703\u88AB\u516C\u958B\uFF0C\u8ACB\u53CA\u6642\u5728\u7B46\u8A18\u4E2D\u522A\u9664deletehash\u3002\u8A8D\u8B49\u4E0A\u50B3\u53EF\u5728Imgur\u4E0A\u522A\u9664\u3002","Imgur Settings":"Imgur\u914D\u7F6E","Anonymous Upload":"\u533F\u540D\u4E0A\u50B3","Anonymous Upload desc":"\u533F\u540D\u4E0A\u50B3\u7684\u6A94\u6848\u4E0D\u6703\u986F\u793A\u5728Imgur\u5E33\u6236\u4E2D\u3002",imgurid:"\u5BA2\u6236\u7AEFID","built-in id desc":"\u5167\u5EFAID\u6709\u6BCF\u65E5\u4F7F\u7528\u9650\u5236\uFF0C\u5982\u679C\u66AB\u6642\u5931\u6548\uFF0C\u53EF\u4EE5\u4F7F\u7528\u81EA\u5DF1\u7684\u5BA2\u6236\u7AEFID\u4EE5\u9032\u884C\u4E0A\u50B3\u548C\u522A\u9664\u3002\u53EF\u4E0D\u586B\u3002",delete:"\u522A\u9664","delete desc":"\u5982\u679C\u9700\u8981\u522A\u9664Imgur\u4E0A\u7684\u5F71\u50CF\uFF0C\u8ACB\u5728\u6B64\u8655\u4F7F\u7528deletehash\u5C07\u5176\u522A\u9664\u3002","delete btn":"\u522A\u9664","delete done":"\u522A\u9664\u6210\u529F","delete fail":"\u522A\u9664\u5931\u6557",authenticate:"\u8A8D\u8B49","auth desc":"\u66F4\u6539ID\u9700\u8981\u91CD\u65B0\u8A8D\u8B49\u624D\u80FD\u751F\u6548\u3002","imgur account":"\u76EE\u524D\u4F7F\u7528\u8005\uFF1A ","auth error":"\u8A8D\u8B49\u932F\u8AA4: ","sign in":"\u767B\u9304","Sign Out":"\u8A3B\u92B7","ImgURL Settings":"ImgURL\u914D\u7F6E","SM.MS Settings":"SM.MS\u914D\u7F6E","Catbox Settings":"Catbox\u914D\u7F6E","Chevereto Settings":"Chevereto\u914D\u7F6E","AList Settings":"Alist\u914D\u7F6E",username:"\u7528\u6236\u540D",password:"\u5BC6\u78BC",uploadPath:"\u4E0A\u50B3\u8DEF\u5F91"};var $t={ar:De,cs:Me,da:Ne,de:Oe,en:re,"en-gb":Le,es:Be,fr:$e,hi:He,id:Ge,it:je,ja:Ve,ko:ze,nl:Je,nn:Ye,pl:Ke,pt:We,"pt-br":Xe,ro:Ze,ru:Qe,tr:et,"zh-cn":tt,"zh-tw":rt},ae=$t[at.moment.locale()];function u(l){var e;return(e=ae==null?void 0:ae[l])!=null?e:re[l]}var G=F(require("obsidian"));var ot={required:{userhash:""}};var st={required:{domain:"",token:""}};var it={required:{name:"",present:""},folder:""};var R;(function(r){r.jsdelivr="jsdelivr",r.statically="statically",r.raw="raw"})(R||(R={}));var nt={required:{owner:"",repo:"",branch:"main",token:"",message:"from emo-uploader\xB7Github"},path:"",random:!0,cdn:R.raw};var mt={required:{key:""}};var pt={required:{emoid:"4547d4aee97ce8f"},clientid:"",anonymous:!0};var dt={required:{uid:"",token:""}};var ht={required:{token:""}};var ut={required:{domain:"",username:"",password:"",uploadPath:""}};var lt={required:{domain:"",token:""}};var y;(function(g){g.Github="Github",g.Cloudinary="Cloudinary",g.Catbox="Catbox",g.Imgur="Imgur",g.Smms="SM.MS",g.ImgURL="ImgURL",g.Imgbb="imgbb",g.Chevereto="chevereto",g.Alist="AList",g.EasgyImage="EasyImage"})(y||(y={}));var ct={choice:y.Github,github_parms:nt,imgur_parms:pt,cloudinary_parms:it,smms_parms:ht,imgurl_parms:dt,imgbb_parms:mt,catbox_parms:ot,chevereto_parms:st,alist_parms:ut,easyimage_parms:lt};var Z=F(require("obsidian"));var T=class{constructor(e,t,r){this.kind=e,this.element=t.createDiv(e),this.display(this.element,r),this.element.hide()}update(e){this.kind===e?this.element.show():this.element.hide()}};var oe=class extends T{constructor(e,t){super(y.Cloudinary,e,t)}display(e,t){let r=t.config.cloudinary_parms;e.createEl("h3",{text:u("Cloudinary Settings")}),new Z.Setting(e).setName("Cloud Name").addText(o=>{o.setValue(r.required.name).onChange(async a=>{r.required.name=a,await t.saveSettings()})}),new Z.Setting(e).setName("Upload Presets").addText(o=>{o.setValue(r.required.present).onChange(async a=>{r.required.present=a,await t.saveSettings()})}),new Z.Setting(e).setName("Upload Folder").setDesc(u("Upload Folder desc")).addText(o=>{o.setPlaceholder("obsidian -> obsidian/pic.png").setValue(r.folder).onChange(async a=>{r.folder=a,await t.saveSettings()})})}};var M=F(require("obsidian"));var se=class extends T{constructor(e,t){super(y.Github,e,t)}display(e,t){let r=t.config.github_parms;e.createEl("h3",{text:u("Github Settings")}),new M.Setting(e).setName(u("owner")).addText(a=>{a.setValue(r.required.owner).onChange(async n=>{r.required.owner=n,await t.saveSettings()})}),new M.Setting(e).setName(u("repo")).addText(a=>{a.setValue(r.required.repo).onChange(async n=>{r.required.repo=n,await t.saveSettings()})}),new M.Setting(e).setName(u("branch")).addText(a=>{a.setValue(r.required.branch).onChange(async n=>{r.required.branch=n,await t.saveSettings()})}),new M.Setting(e).setName(u("token")).addText(a=>{a.setValue(r.required.token).onChange(async n=>{r.required.token=n,await t.saveSettings()})}),new M.Setting(e).setName(u("message")).addText(a=>{a.setValue(r.required.message).onChange(async n=>{r.required.message=n,await t.saveSettings()})}),new M.Setting(e).setName(u("path")).setDesc(u("not required")).addText(a=>{a.setPlaceholder("obsidian/ -> obsidian/pic.png").setValue(r.path).onChange(async n=>{r.path=n,await t.saveSettings()})}),new M.Setting(e).setName(u("random filename")).setDesc(u("random filename desc")).addToggle(a=>{a.setValue(r.random),a.onChange(async n=>{r.random=n,await t.saveSettings()})});let o=[];for(let a in R)o.push(R[a]);new M.Setting(e).setName(u("cdn")).addDropdown(a=>{o.forEach(n=>{a.addOption(n,n)}),a.setValue(r.cdn).onChange(async n=>{r.cdn=n,await t.saveSettings()})})}};var ft=F(require("obsidian"));var ie=class extends T{constructor(e,t){super(y.Imgbb,e,t)}display(e,t){let r=t.config.imgbb_parms;e.createEl("h3",{text:u("imgbb Settings")}),new ft.Setting(e).setName("key").addText(o=>{o.setValue(r.required.key).onChange(async a=>{r.required.key=a,await t.saveSettings()})})}};var ne=F(require("obsidian"));var me=class extends T{constructor(e,t){super(y.ImgURL,e,t)}display(e,t){let r=t.config.imgurl_parms;e.createEl("h3",{text:u("ImgURL Settings")}),new ne.Setting(e).setName("uid").addText(o=>{o.setValue(r.required.uid).onChange(async a=>{r.required.uid=a,await t.saveSettings()})}),new ne.Setting(e).setName("token").addText(o=>{o.setValue(r.required.token).onChange(async a=>{r.required.token=a,await t.saveSettings()})})}};var gt=F(require("obsidian"));var pe=class extends T{constructor(e,t){super(y.Smms,e,t)}display(e,t){let r=t.config.smms_parms;e.createEl("h3",{text:u("SM.MS Settings")}),new gt.Setting(e).setName("token").addText(o=>{o.setValue(r.required.token).onChange(async a=>{r.required.token=a,await t.saveSettings()})})}};var k=F(require("obsidian"));var $="imgur-access_token",V="4547d4aee97ce8f",de="loveaimeainixucheng",q="multipart/form-data;boundary="+de;var he=class extends T{constructor(e,t){super(y.Imgur,e,t);this.imgurStateText=u("authenticate");this.imgurBtnText=u("sign in");this.authenticated=!1}async display(e,t){let r=t.config.imgur_parms;e.createEl("h3",{text:u("tips")}),e.createDiv().setText(u("tips text")),e.createEl("h3",{text:u("Imgur Settings")}),new k.Setting(e).setName(u("Anonymous Upload")).setDesc(u("Anonymous Upload desc")).addToggle(a=>{a.setValue(r.anonymous),a.onChange(async n=>{r.anonymous=n,await t.saveSettings()})}),new k.Setting(e).setName(u("imgurid")).setDesc(u("built-in id desc")).addText(a=>{a.setValue(r.clientid).onChange(async n=>{r.clientid=n,await t.saveSettings()})});let o="";new k.Setting(e).setName(u("delete")).setDesc(u("delete desc")).addText(a=>{a.setPlaceholder("deletehash").onChange(async n=>{o=n})}).addButton(a=>{a.setCta().setButtonText(u("delete btn")).onClick(()=>{let n="Client-ID ";r.clientid!==""?n+=r.clientid:n+=V;let x={url:"https://api.imgur.com/3/image/"+o,method:"DELETE",headers:{Authorization:n}};(0,k.request)(x).then(()=>{console.log(new k.Notice(u("delete done"),2e3))}).catch(()=>{console.log(new k.Notice(u("delete fail"),2e3))})})}),await this.checkState(),this.loginState=new k.Setting(e),this.loginState.setName(this.imgurStateText).setDesc(u("auth desc")).addButton(a=>{this.loginBtn=a,this.loginBtn.setCta().setButtonText(this.imgurBtnText).onClick(async()=>{if(this.authenticated)localStorage.removeItem($),this.authenticated=this.drawLogin();else{let n="";r.clientid!==""?n+=r.clientid:n+=V,window.open(`https://api.imgur.com/oauth2/authorize?client_id=${n}&response_type=token`)}})})}async checkState(){try{let e=await this.getAccountName();e!==u("no sign in")&&(this.imgurStateText=u("imgur account")+`${e} \u2705`,this.imgurBtnText=u("Sign Out"),this.authenticated=!0)}catch(e){console.log(e)}}async getAccountName(){let e=localStorage.getItem($);if(e===null)return u("no sign in");let t=await fetch("https://api.imgur.com/3/account/me",{headers:new Headers({Authorization:`Bearer ${e}`})});if(!t.ok)throw new Error("Imgur account error");return(await t.json()).data.url}drawLogin(){return this.imgurStateText=u("authenticate"),this.imgurBtnText=u("sign in"),this.loginState.setName(this.imgurStateText),this.loginBtn.setButtonText(this.imgurBtnText),!1}};var xt=F(require("obsidian"));var ue=class extends T{constructor(e,t){super(y.Catbox,e,t)}display(e,t){let r=t.config.catbox_parms;e.createEl("h3",{text:u("Catbox Settings")}),new xt.Setting(e).setName("userhash").addText(o=>{o.setValue(r.required.userhash).onChange(async a=>{r.required.userhash=a,await t.saveSettings()})})}};var le=F(require("obsidian"));var ce=class extends T{constructor(e,t){super(y.Chevereto,e,t)}display(e,t){let r=t.config.chevereto_parms;e.createEl("h3",{text:u("Chevereto Settings")}),new le.Setting(e).setName(u("domain")).addText(o=>{o.setValue(r.required.domain).onChange(async a=>{r.required.domain=a,await t.saveSettings()})}),new le.Setting(e).setName("token").addText(o=>{o.setValue(r.required.token).onChange(async a=>{r.required.token=a,await t.saveSettings()})})}};var z=F(require("obsidian"));var fe=class extends T{constructor(e,t){super(y.Alist,e,t)}display(e,t){let r=t.config.alist_parms;e.createEl("h3",{text:u("AList Settings")}),new z.Setting(e).setName(u("domain")).addText(o=>{o.setPlaceholder("https://alist.example.com").setValue(r.required.domain).onChange(async a=>{r.required.domain=a,await t.saveSettings()})}),new z.Setting(e).setName(u("username")).addText(o=>{o.setValue(r.required.username).onChange(async a=>{r.required.username=a,await t.saveSettings()})}),new z.Setting(e).setName(u("password")).addText(o=>{o.setValue(r.required.password).onChange(async a=>{r.required.password=a,await t.saveSettings()})}),new z.Setting(e).setName(u("uploadPath")).addText(o=>{o.setValue(r.required.uploadPath).onChange(async a=>{r.required.uploadPath=a,await t.saveSettings()})})}};var ge=F(require("obsidian"));var xe=class extends T{constructor(e,t){super(y.EasgyImage,e,t)}display(e,t){let r=t.config.easyimage_parms;e.createEl("h3",{text:u("EasyImage Settings")}),new ge.Setting(e).setName(u("domain")).addText(o=>{o.setValue(r.required.domain).onChange(async a=>{r.required.domain=a,await t.saveSettings()})}),new ge.Setting(e).setName("token").addText(o=>{o.setValue(r.required.token).onChange(async a=>{r.required.token=a,await t.saveSettings()})})}};var ye=class extends G.PluginSettingTab{constructor(e,t){super(e,t);this.plugin=t,this.setUpHandler()}display(){let{containerEl:e}=this;e.empty();let t=e.createDiv("cola");t.addClass("emo-cola-div");let o=t.createEl("a",{href:"https://lestua.eu.org/donate"}).createEl("img");o.outerHTML='<?xml version="1.0" encoding="UTF-8"?><svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><line x1="10" y1="16" x2="38" y2="16" stroke="currentcolor" stroke-width="4" stroke-linecap="round"/><path d="M14.153 18.1425C14.0703 16.9848 14.9873 16 16.148 16H31.852C33.0127 16 33.9297 16.9848 33.847 18.1425L32.1327 42.1425C32.0579 43.1891 31.187 44 30.1378 44H17.8622C16.813 44 15.9421 43.1891 15.8673 42.1425L14.153 18.1425Z" stroke="currentcolor" stroke-width="4"/><path d="M24 10V6C24 4.89543 24.8954 4 26 4H29" stroke="currentcolor" stroke-width="4" stroke-linecap="round"/><path d="M14.7215 11.6712C14.8822 10.7068 15.7166 10 16.6943 10H31.3057C32.2834 10 33.1178 10.7068 33.2785 11.6712L34 16H14L14.7215 11.6712Z" fill="none" stroke="currentcolor" stroke-width="4"/></svg>',e.createEl("h2",{text:"Emo"});let a=new G.Setting(e).setName(u("target hosting")).setDesc(u("target hosting desc")),n=[];n.push(new se(e,this.plugin)),n.push(new he(e,this.plugin)),n.push(new oe(e,this.plugin)),n.push(new pe(e,this.plugin)),n.push(new me(e,this.plugin)),n.push(new ie(e,this.plugin)),n.push(new ue(e,this.plugin)),n.push(new ce(e,this.plugin)),n.push(new fe(e,this.plugin)),n.push(new xe(e,this.plugin)),n.forEach(i=>{i.update(this.plugin.config.choice)});let x=[];for(let i in y)x.push(y[i]);a.addDropdown(i=>{x.forEach(S=>{i.addOption(S,S)}),i.setValue(this.plugin.config.choice).onChange(async S=>{this.plugin.config.choice=S,await this.plugin.saveSettings(),n.forEach(g=>{g.update(this.plugin.config.choice)})})})}setUpHandler(){this.plugin.registerObsidianProtocolHandler("emo-imgur-oauth",async e=>{if(e.error!==void 0){console.log(new G.Notice(u("auth error")+`${e.error}`));return}let t=e.hash.split("&").map(o=>{let a=o.split("=");return[a[0],a[1]]}),r=new Map(t);localStorage.setItem($,r.get("access_token")),this.display()})}};var Et=F(require("obsidian"));async function yt(l){return await new Promise((e,t)=>{let r=new FileReader,o;r.readAsArrayBuffer(l),r.onload=()=>{o=r.result},r.onerror=a=>{t(a)},r.onloadend=()=>{e(o)}})}async function bt(l){return await new Promise((e,t)=>{let r=new FileReader,o;r.readAsDataURL(l),r.onload=()=>{o=r.result,o=o.slice(o.indexOf(",")+1)},r.onerror=a=>{t(a)},r.onloadend=()=>{e(o)}})}function wt(){return Date.parse(new Date().toString()).toString()+(Math.random()*10086).toString(36).slice(-6)}var A=class{isValid(){let e=!0;for(let t in this.parms.required)if(e&&(e=Ht(this.parms.required[t])),!e)return!1;return!0}};function Ht(l){return l.length>0}var be=class extends A{constructor(e){super();this.parms=e}async upload(e){let t="";if(this.parms.random){let n=e.name.lastIndexOf(".");t=this.parms.path+wt(),t+=n>0?e.name.substring(n):""}else t=this.parms.path+e.name;let r={owner:this.parms.required.owner,repo:this.parms.required.repo,branch:this.parms.required.branch,path:t,message:this.parms.required.message,content:await bt(e)},o=JSON.stringify(r),a={url:`https://api.github.com/repos/${this.parms.required.owner}/${this.parms.required.repo}/contents/${t}`,method:"PUT",headers:{Authorization:`token ${this.parms.required.token}`},body:o};return await new Promise((n,x)=>{(0,Et.request)(a).then(()=>{let i;switch(console.log(this.parms.cdn),this.parms.cdn){case R.jsdelivr:i=`![gh](https://cdn.jsdelivr.net/gh/${this.parms.required.owner}/${this.parms.required.repo}@${this.parms.required.branch}/${t})`;break;case R.statically:i=`![gh](https://cdn.statically.io/gh/${this.parms.required.owner}/${this.parms.required.repo}/${this.parms.required.branch}/${t})`;break;case R.raw:i=`![gh](https://raw.githubusercontent.com/${this.parms.required.owner}/${this.parms.required.repo}/${this.parms.required.branch}/${t})`;break;default:i=`![gh](https://raw.githubusercontent.com/${this.parms.required.owner}/${this.parms.required.repo}/${this.parms.required.branch}/${t})`;break}n(i)}).catch(i=>{x(i)})})}};var St=F(require("obsidian"));var C=class{constructor(){this.randomBoundary=de;this.body=[],this.boundary="--"+this.randomBoundary,this.endBoundary=this.boundary+"--"}async add(e,t){let r=this.boundary+`\r
`;if(typeof t=="string"){r+='Content-Disposition: form-data; name="'+e+`"\r
\r
`,r+=t+`\r
`;for(let o=0;o<r.length;o++)this.body.push(r.charCodeAt(o))}else if(t instanceof File){r+='Content-Disposition: form-data; name="'+e+'"; filename="'+encodeURIComponent(t.name)+`"\r
`,r+="Content-Type: "+t.type+`\r
\r
`;for(let a=0;a<r.length;a++)this.body.push(r.charCodeAt(a));await yt(t).then(a=>{let n=new Uint8Array(a);this.body=this.body.concat(Array.prototype.slice.call(n))});let o=`\r
`;for(let a=0;a<o.length;a++)this.body.push(o.charCodeAt(a))}}getContentType(){return"multipart/form-data; boundary="+this.randomBoundary}getBody(){let e=[];for(let t=0;t<this.endBoundary.length;t++)e.push(this.endBoundary.charCodeAt(t));return this.body=this.body.concat(e),new Uint8Array(this.body).buffer}};var we=class extends A{constructor(e){super();this.parms=e}async upload(e){let t=new C;await t.add("uid",this.parms.required.uid),await t.add("token",this.parms.required.token),await t.add("file",e);let r={url:"https://www.imgurl.org/api/v2/upload",method:"POST",headers:{"Content-Type":q},body:t.getBody()};return await new Promise((o,a)=>{(0,St.request)(r).then(n=>{let i=`![ImgURL](${JSON.parse(n).data.url})`;o(i)}).catch(n=>{a(n)})})}};var Ft=F(require("obsidian"));var Ee=class extends A{constructor(e){super();this.parms=e}async upload(e){let t=new C;await t.add("upload_preset",this.parms.required.present),await t.add("folder",this.parms.folder),await t.add("file",e);let r={url:`https://api.cloudinary.com/v1_1/${this.parms.required.name}/auto/upload`,method:"POST",headers:{"Content-Type":q},body:t.getBody()};return await new Promise((o,a)=>{(0,Ft.request)(r).then(n=>{let i=`![Cloudinary](${JSON.parse(n).secure_url})`;o(i)}).catch(n=>{a(n)})})}};var Pt=F(require("obsidian"));var Se=class extends A{constructor(e){super();this.parms=e}async upload(e){let t=new C;await t.add("format","json"),await t.add("smfile",e);let r={url:"https://sm.ms/api/v2/upload",method:"POST",headers:{"Content-Type":q,Authorization:this.parms.required.token},body:t.getBody()};return await new Promise((o,a)=>{(0,Pt.request)(r).then(n=>{let x=JSON.parse(n),i="";try{i=x.data.url}catch(g){i=x.images}let S=`![SMMS](${i})`;o(S)}).catch(n=>{a(n)})})}};var Tt=F(require("obsidian"));var Fe=class extends A{constructor(e){super();this.parms=e}async upload(e){let t=new C;await t.add("key",this.parms.required.key),await t.add("image",e);let r={url:"https://api.imgbb.com/1/upload",method:"POST",headers:{"Content-Type":q},body:t.getBody()};return await new Promise((o,a)=>{(0,Tt.request)(r).then(n=>{let S=`![imgbb](${JSON.parse(n).data.url})`;o(S)}).catch(n=>{a(n)})})}};var At=F(require("obsidian"));var Pe=class extends A{constructor(e){super();this.parms=e}async upload(e){let t=new C;await t.add("image",e);let r;if(this.parms.anonymous){let o="Client-ID ";this.parms.clientid!==""?o+=this.parms.clientid:o+=V,r={url:"https://api.imgur.com/3/upload",method:"POST",headers:{"Content-Type":q,Authorization:o},body:t.getBody()}}else{let o=localStorage.getItem($);if(o!==null)r={url:"https://api.imgur.com/3/image",method:"POST",headers:{"Content-Type":q,Authorization:`Bearer ${o}`},body:t.getBody()};else return u("no sign in")}return await new Promise((o,a)=>{(0,At.request)(r).then(n=>{let x=JSON.parse(n),i=x.data.deletehash,S=x.data.link,g;this.parms.anonymous?g=`![${i}](${S})`:g=`![Imgur](${S})`,o(g)}).catch(n=>{a(n)})})}};var qt=F(require("obsidian"));var Te=class extends A{constructor(e){super();this.parms=e}async upload(e){let t=new C;await t.add("reqtype","fileupload"),await t.add("userhash",this.parms.required.userhash),await t.add("fileToUpload",e);let r={url:"https://catbox.moe/user/api.php",method:"POST",headers:{"Content-Type":q},body:t.getBody()};return await new Promise((o,a)=>{(0,qt.request)(r).then(n=>{let x=`![Catbox](${n})`;o(x)}).catch(n=>{a(n)})})}};var Ct=F(require("obsidian"));var Ae=class extends A{constructor(e){super();this.parms=e}formatUrl(e){return!e.startsWith("https://")&&!e.startsWith("http://")&&(e="https://"+e),e.endsWith("/")&&(e=e.slice(0,-1)),e}async upload(e){let t=this.formatUrl(this.parms.required.domain),r=new C;await r.add("source",e),await r.add("key",this.parms.required.token);let o={url:t,method:"POST",headers:{"X-API-Key":this.parms.required.token,"Content-Type":q},body:r.getBody()};return await new Promise((a,n)=>{(0,Ct.request)(o).then(x=>{let i=JSON.parse(x),S="";S=i.image.url;let g=`![Chevereto](${S})`;a(g)}).catch(x=>{n(x)})})}};var B=F(require("obsidian"));var vt=F(_t()),qe=class extends A{constructor(e){super();this.parms=e}async upload(e){let t=await this.getToken();await this.determine(e)!=="success"&&await this.mkdirFile(e),await this.putFile(e),await this.refreshDir(e);let o=e.name;e.name==="image.png"&&(o=await this.renameFile(e));let a=await this.getFileExtension(e),n={url:`${this.parms.required.domain}/api/fs/get`,method:"POST",headers:{Authorization:t,"Content-Type":"application/json"},body:JSON.stringify({path:`/${this.parms.required.uploadPath}/${a}/${o}`})};return await new Promise((x,i)=>{(0,B.request)(n).then(async S=>{let g=JSON.parse(S),H=`![${o}](${g.data.raw_url})`;x(H)}).catch(S=>{i(S)})})}async getToken(){let e={url:`${this.parms.required.domain}/api/auth/login/hash`,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.parms.required.username,password:(0,vt.sha256)(this.parms.required.password+"-https://github.com/alist-org/alist")})};return await new Promise((t,r)=>{(0,B.request)(e).then(o=>{let a=JSON.parse(o);t(a.data.token)}).catch(o=>{r(o)})})}async getFileExtension(e){let r=e.name.match(/\.([^.]+)$/);return r!=null?r[1]:""}async determine(e){let t=await this.getFileExtension(e),r={url:`${this.parms.required.domain}/api/fs/get`,method:"POST",headers:{Authorization:await this.getToken(),"Content-Type":"application/json"},body:JSON.stringify({path:`/${this.parms.required.uploadPath}/${t}`})};return await new Promise((o,a)=>{(0,B.request)(r).then(n=>{let x=JSON.parse(n);o(x.message)}).catch(n=>{a(n)})})}async mkdirFile(e){let t=await this.getFileExtension(e),r={url:`${this.parms.required.domain}/api/fs/mkdir`,method:"POST",headers:{Authorization:await this.getToken(),"Content-Type":"application/json"},body:JSON.stringify({path:`/${this.parms.required.uploadPath}/${t}`})};await(0,B.request)(r)}async putFile(e){let t=await this.getFileExtension(e),r=new C;await r.add("file",e);let o={url:`${this.parms.required.domain}/api/fs/form`,method:"PUT",headers:{Authorization:await this.getToken(),"Content-Type":q,"File-Path":encodeURIComponent(`/${this.parms.required.uploadPath}/${t}/${e.name}`),"As-Task":"true"},body:r.getBody()};await(0,B.request)(o)}async refreshDir(e){let t=await this.getFileExtension(e),r={url:`${this.parms.required.domain}/api/fs/list`,method:"POST",headers:{Authorization:await this.getToken(),"Content-Type":"application/json"},body:JSON.stringify({path:`/${this.parms.required.uploadPath}/${t}`,page:1,password:"",per_page:0,refresh:!0})};await(0,B.request)(r)}async renameFile(e){let t=await this.getFileExtension(e),r=new Date,o=x=>x.toString().padStart(2,"0"),a=`${r.getFullYear()}${o(r.getMonth()+1)}${o(r.getDate())}-${o(r.getHours())}:${o(r.getMinutes())}:${o(r.getSeconds())}.${t}`,n={url:`${this.parms.required.domain}/api/fs/rename`,method:"POST",headers:{Authorization:await this.getToken(),"Content-Type":"application/json"},body:JSON.stringify({name:a,path:`/${this.parms.required.uploadPath}/${t}/${e.name}`})};return await(0,B.request)(n),a}};var Ut=F(require("obsidian"));var Ce=class extends A{constructor(e){super();this.parms=e}async upload(e){let t=this.parms.required.domain,r=new C;await r.add("image",e),await r.add("token",this.parms.required.token);let o={url:t,method:"POST",headers:{"Content-Type":q},body:r.getBody()};return await new Promise((a,n)=>{(0,Ut.request)(o).then(x=>{let i=JSON.parse(x),S="";S=i.url;let g=`![EasyImage](${S})`;a(g)}).catch(x=>{n(x)})})}};var _e=class extends J.Plugin{async onload(){console.log("loading  Emo uploader"),await this.loadSettings(),this.setupPasteHandler(),this.addSettingTab(new ye(this.app,this))}onunload(){console.log("unloading Emo uploader")}async loadSettings(){this.config=Object.assign({},ct,await this.loadData())}async saveSettings(){await this.saveData(this.config)}setupPasteHandler(){this.registerEvent(this.app.workspace.on("editor-drop",async(e,t)=>{let{files:r}=e.dataTransfer;this.startUpload(r,e,t)})),this.registerEvent(this.app.workspace.on("editor-paste",async(e,t)=>{let{files:r}=e.clipboardData;this.startUpload(r,e,t)}))}startUpload(e,t,r){let o;if(e.length>0)if(o={[y.Github]:()=>new be(this.config.github_parms),[y.ImgURL]:()=>new we(this.config.imgurl_parms),[y.Cloudinary]:()=>new Ee(this.config.cloudinary_parms),[y.Smms]:()=>new Se(this.config.smms_parms),[y.Imgbb]:()=>new Fe(this.config.imgbb_parms),[y.Imgur]:()=>new Pe(this.config.imgur_parms),[y.Catbox]:()=>new Te(this.config.catbox_parms),[y.Chevereto]:()=>new Ae(this.config.chevereto_parms),[y.Alist]:()=>new qe(this.config.alist_parms),[y.EasgyImage]:()=>new Ce(this.config.easyimage_parms)}[this.config.choice](),o.isValid()){t.preventDefault();for(let n of e){let i=`![uploading...](${(Math.random()*10086).toString(36).slice(-6)})
`;r.replaceSelection(i),o.upload(n).then(S=>{let g=n.type.startsWith("image")?0:1;this.replaceText(r,i,S.slice(g))}).catch(S=>{this.replaceText(r,i,`[${this.config.choice} upload error]()`),console.log(new J.Notice(this.config.choice+u("upload error"),2e3)),console.log(S)})}}else console.log(new J.Notice(u("parms error"),2e3)),console.log(o)}replaceText(e,t,r){t=t.trim();let o=[];for(let a=0;a<e.lineCount();a++)o.push(e.getLine(a));for(let a=0;a<o.length;a++){let n=o[a].indexOf(t);if(n!==-1){let x={line:a,ch:n},i={line:a,ch:n+t.length};e.replaceRange(r,x,i);break}}}};0&&(module.exports={});
/**
 * [js-sha256]{@link https://github.com/emn178/js-sha256}
 *
 * @version 0.10.1
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2023
 * @license MIT
 */

/* nosourcemap */