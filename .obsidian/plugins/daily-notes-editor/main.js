"use strict";var pe=Object.defineProperty;var ge=(e,t,n)=>t in e?pe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var wt=(e,t,n)=>ge(e,typeof t!="symbol"?t+"":t,n);Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const g=require("obsidian");function W(){}function jt(e){return e()}function xt(){return Object.create(null)}function O(e){e.forEach(jt)}function ht(e){return typeof e=="function"}function qt(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function we(e){return Object.keys(e).length===0}function Vt(e){return e&&ht(e.destroy)?e.destroy:W}function C(e,t){e.appendChild(t)}function I(e,t,n){e.insertBefore(t,n||null)}function A(e){e.parentNode&&e.parentNode.removeChild(e)}function M(e){return document.createElement(e)}function Lt(e){return document.createTextNode(e)}function H(){return Lt(" ")}function me(){return Lt("")}function q(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function _(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function ye(e){return Array.from(e.childNodes)}function ve(e,t){t=""+t,e.data!==t&&(e.data=t)}let Z;function Q(e){Z=e}function ke(){if(!Z)throw new Error("Function called outside component initialization");return Z}function be(e){ke().$$.on_mount.push(e)}const R=[],ft=[];let V=[];const Pt=[],Ee=Promise.resolve();let vt=!1;function Se(){vt||(vt=!0,Ee.then(Ut))}function kt(e){V.push(e)}const mt=new Set;let Y=0;function Ut(){if(Y!==0)return;const e=Z;do{try{for(;Y<R.length;){const t=R[Y];Y++,Q(t),Le(t.$$)}}catch(t){throw R.length=0,Y=0,t}for(Q(null),R.length=0,Y=0;ft.length;)ft.pop()();for(let t=0;t<V.length;t+=1){const n=V[t];mt.has(n)||(mt.add(n),n())}V.length=0}while(R.length);for(;Pt.length;)Pt.pop()();vt=!1,mt.clear(),Q(e)}function Le(e){if(e.fragment!==null){e.update(),O(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(kt)}}function _e(e){const t=[],n=[];V.forEach(i=>e.indexOf(i)===-1?t.push(i):n.push(i)),n.forEach(i=>i()),V=t}const dt=new Set;let B;function $e(){B={r:0,c:[],p:B}}function Ce(){B.r||O(B.c),B=B.p}function pt(e,t){e&&e.i&&(dt.delete(e),e.i(t))}function _t(e,t,n,i){if(e&&e.o){if(dt.has(e))return;dt.add(e),B.c.push(()=>{dt.delete(e),i&&(n&&e.d(1),i())}),e.o(t)}else i&&i()}function Ft(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function xe(e,t){_t(e,1,1,()=>{t.delete(e.key)})}function Pe(e,t,n,i,o,s,r,a,l,d,u,c){let f=e.length,h=s.length,p=f;const m={};for(;p--;)m[e[p].key]=p;const y=[],w=new Map,v=new Map,b=[];for(p=h;p--;){const L=c(o,s,p),P=n(L);let F=r.get(P);F?b.push(()=>F.p(L,t)):(F=d(P,L),F.c()),w.set(P,y[p]=F),P in m&&v.set(P,Math.abs(p-m[P]))}const x=new Set,ot=new Set;function T(L){pt(L,1),L.m(a,u),r.set(L.key,L),u=L.first,h--}for(;f&&h;){const L=y[h-1],P=e[f-1],F=L.key,E=P.key;L===P?(u=L.first,f--,h--):w.has(E)?!r.has(F)||x.has(F)?T(L):ot.has(E)?f--:v.get(F)>v.get(E)?(ot.add(F),T(L)):(x.add(E),f--):(l(P,r),f--)}for(;f--;){const L=e[f];w.has(L.key)||l(L,r)}for(;h;)T(y[h-1]);return O(b),y}function Fe(e){e&&e.c()}function zt(e,t,n){const{fragment:i,after_update:o}=e.$$;i&&i.m(t,n),kt(()=>{const s=e.$$.on_mount.map(jt).filter(ht);e.$$.on_destroy?e.$$.on_destroy.push(...s):O(s),e.$$.on_mount=[]}),o.forEach(kt)}function Qt(e,t){const n=e.$$;n.fragment!==null&&(_e(n.after_update),O(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Me(e,t){e.$$.dirty[0]===-1&&(R.push(e),Se(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Zt(e,t,n,i,o,s,r=null,a=[-1]){const l=Z;Q(e);const d=e.$$={fragment:null,ctx:[],props:s,update:W,not_equal:o,bound:xt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(l?l.$$.context:[])),callbacks:xt(),dirty:a,skip_bound:!1,root:t.target||l.$$.root};r&&r(d.root);let u=!1;if(d.ctx=n?n(e,t.props||{},(c,f,...h)=>{const p=h.length?h[0]:f;return d.ctx&&o(d.ctx[c],d.ctx[c]=p)&&(!d.skip_bound&&d.bound[c]&&d.bound[c](p),u&&Me(e,c)),f}):[],d.update(),u=!0,O(d.before_update),d.fragment=i?i(d.ctx):!1,t.target){if(t.hydrate){const c=ye(t.target);d.fragment&&d.fragment.l(c),c.forEach(A)}else d.fragment&&d.fragment.c();t.intro&&pt(e.$$.fragment),zt(e,t.target,t.anchor),Ut()}Q(l)}class Gt{constructor(){wt(this,"$$");wt(this,"$$set")}$destroy(){Qt(this,1),this.$destroy=W}$on(t,n){if(!ht(n))return W;const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(n),()=>{const o=i.indexOf(n);o!==-1&&i.splice(o,1)}}$set(t){this.$$set&&!we(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const De="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(De);function Te(e,t,n,i){function o(s){return s instanceof n?s:new n(function(r){r(s)})}return new(n||(n=Promise))(function(s,r){function a(u){try{d(i.next(u))}catch(c){r(c)}}function l(u){try{d(i.throw(u))}catch(c){r(c)}}function d(u){u.done?s(u.value):o(u.value).then(a,l)}d((i=i.apply(e,[])).next())})}function Kt(e){const t=[];for(let n=0;n<e;n++)t.push((16*Math.random()|0).toString(16));return t.join("")}const rt=new WeakMap;function Mt(e){return e.containerEl.matches(".dn-editor.dn-leaf-view .workspace-leaf")}function Ne(e){const t=function(){return Object.setPrototypeOf(new g.Component,new.target.prototype)};return t.prototype=e.prototype,Object.setPrototypeOf(t,e)}const Oe=(e,t,n,i)=>{let o=e.app.workspace.activeLeaf;o||(o=n),t||(t=o==null?void 0:o.containerEl);const s=new G(o,t,e,void 0,i);return[s.attachLeaf(),s]};class G extends Ne(g.HoverPopover){constructor(t,n,i,o,s){var a,l;super(),this.targetEl=n,this.plugin=i,this.onShowCallback=s,this.abortController=this.addChild(new g.Component),this.detaching=!1,this.opening=!1,this.rootSplit=new g.WorkspaceSplit(window.app.workspace,"vertical"),this.isPinned=!0,this.oldPopover=(a=this.parent)==null?void 0:a.DailyNoteEditor,this.id=Kt(8),o===void 0&&(o=300),this.onTarget=!0,this.parent=t,this.waitTime=o,this.state=g.PopoverState.Showing,this.document=((l=this.targetEl)==null?void 0:l.ownerDocument)??window.activeDocument??window.document,this.hoverEl=this.document.defaultView.createDiv({cls:"dn-editor dn-leaf-view",attr:{id:"dn-"+this.id}});const{hoverEl:r}=this;this.abortController.load(),this.timer=window.setTimeout(this.show.bind(this),o),this.setActive=this._setActive.bind(this),r&&r.addEventListener("mousedown",this.setActive),rt.set(this.hoverEl,this),this.hoverEl.addClass("dn-editor"),this.containerEl=this.hoverEl.createDiv("dn-content"),this.buildWindowControls(),this.setInitialDimensions()}static activeWindows(){const t=[window],{floatingSplit:n}=app.workspace;if(n)for(const i of n.children)i.win&&t.push(i.win);return t}static containerForDocument(t,n){if(n!==document&&t.app.workspace.floatingSplit){for(const i of t.app.workspace.floatingSplit.children)if(i.doc===n)return i}return t.app.workspace.rootSplit}static activePopovers(){return this.activeWindows().flatMap(this.popoversForWindow)}static popoversForWindow(t){var n;return Array.prototype.slice.call(((n=t==null?void 0:t.document)==null?void 0:n.body.querySelectorAll(".dn-leaf-view"))??[]).map(i=>rt.get(i)).filter(i=>i)}static forLeaf(t){const n=t&&document.body.matchParent.call(t.containerEl,".dn-leaf-view");return n?rt.get(n):void 0}static iteratePopoverLeaves(t,n){for(const i of this.activePopovers())if(i.rootSplit&&t.iterateLeaves(n,i.rootSplit))return!0;return!1}_setActive(t){t.preventDefault(),t.stopPropagation(),this.plugin.app.workspace.setActiveLeaf(this.leaves()[0],{focus:!0})}getDefaultMode(){return"source"}updateLeaves(){this.onTarget&&this.targetEl&&!this.document.contains(this.targetEl)&&(this.onTarget=!1,this.transition());let t=0;this.plugin.app.workspace.iterateLeaves(n=>{t++},this.rootSplit),t===0&&this.hide(),this.hoverEl.setAttribute("data-leaf-count",t.toString())}leaves(){const t=[];return this.plugin.app.workspace.iterateLeaves(n=>{t.push(n)},this.rootSplit),t}setInitialDimensions(){this.hoverEl.style.height="auto",this.hoverEl.style.width="100%"}transition(){this.shouldShow()?this.state===g.PopoverState.Hiding&&(this.state=g.PopoverState.Shown,clearTimeout(this.timer)):this.state===g.PopoverState.Showing?this.hide():this.state===g.PopoverState.Shown&&(this.state=g.PopoverState.Hiding,this.timer=window.setTimeout(()=>{this.shouldShow()?this.transition():this.hide()},this.waitTime))}buildWindowControls(){this.titleEl=this.document.defaultView.createDiv("popover-titlebar"),this.titleEl.createDiv("popover-title"),this.containerEl.prepend(this.titleEl)}attachLeaf(){this.rootSplit.getRoot=()=>this.plugin.app.workspace[this.document===document?"rootSplit":"floatingSplit"],this.rootSplit.getContainer=()=>G.containerForDocument(this.plugin,this.document),this.titleEl.insertAdjacentElement("afterend",this.rootSplit.containerEl);const t=this.plugin.app.workspace.createLeafInParent(this.rootSplit,0);return this.updateLeaves(),t}onload(){super.onload(),this.registerEvent(this.plugin.app.workspace.on("layout-change",this.updateLeaves,this)),this.registerEvent(app.workspace.on("layout-change",()=>{this.rootSplit.children.forEach((t,n)=>{t instanceof g.WorkspaceTabs&&this.rootSplit.replaceChild(n,t.children[0])})}))}onShow(){var s,r;setTimeout(()=>this.waitTime=600,600),(s=this.oldPopover)==null||s.hide(),this.oldPopover=null,this.hoverEl.toggleClass("is-new",!0),this.document.body.addEventListener("click",()=>{this.hoverEl.toggleClass("is-new",!1)},{once:!0,capture:!0}),this.parent&&(this.parent.DailyNoteEditor=this);const n=this.hoverEl.querySelector(".view-header");n==null||n.remove();const i=this.hoverEl.querySelector(".workspace-leaf");i&&this.hoverEl.appendChild(i);const o=this.hoverEl.querySelector(".inline-title");o&&o.remove(),(r=this.onShowCallback)==null||r.call(this),this.onShowCallback=void 0}detect(t){const{targetEl:n}=this;n&&(this.onTarget=t===n||n.contains(t))}shouldShow(){return this.shouldShowSelf()||this.shouldShowChild()}shouldShowChild(){return G.activePopovers().some(t=>t!==this&&t.targetEl&&this.hoverEl.contains(t.targetEl)?t.shouldShow():!1)}shouldShowSelf(){return!this.detaching&&!!(this.onTarget||this.state==g.PopoverState.Shown||this.document.querySelector(`body>.modal-container, body > #he${this.id} ~ .menu, body > #he${this.id} ~ .suggestion-container`))}show(){!this.targetEl||this.document.body.contains(this.targetEl)?(this.state=g.PopoverState.Shown,this.timer=0,this.targetEl.appendChild(this.hoverEl),this.onShow(),app.workspace.onLayoutChange(),this.load()):this.hide(),this.hoverEl.dataset.imgHeight&&this.hoverEl.dataset.imgWidth&&(this.hoverEl.style.height=parseFloat(this.hoverEl.dataset.imgHeight)+this.titleEl.offsetHeight+"px",this.hoverEl.style.width=parseFloat(this.hoverEl.dataset.imgWidth)+"px")}onHide(){var t;this.oldPopover=null,((t=this.parent)==null?void 0:t.DailyNoteEditor)===this&&(this.parent.DailyNoteEditor=null)}hide(){var n;if(this.onTarget=!1,this.detaching=!0,this.timer&&(clearTimeout(this.timer),this.timer=0),this.hoverEl.hide(),this.opening)return;const t=this.leaves();if(t.length)t[0].detach();else return this.parent=null,(n=this.abortController)==null||n.unload(),this.abortController=void 0,this.nativeHide()}nativeHide(){var i;const{hoverEl:t,targetEl:n}=this;if(this.state=g.PopoverState.Hidden,t.detach(),n){const o=n.matchParent(".dn-leaf-view");o&&((i=rt.get(o))==null||i.transition())}this.onHide(),this.unload()}resolveLink(t,n){const i=g.parseLinktext(t);return i?this.plugin.app.metadataCache.getFirstLinkpathDest(i.path,n):null}async openLink(t,n,i,o){var h,p,m;let s=this.resolveLink(t,n);const r=g.parseLinktext(t);if(!s&&o){const y=this.plugin.app.fileManager.getNewFileParent(n);s=await this.plugin.app.fileManager.createNewMarkdownFile(y,r.path)}if(!s)return;const{viewRegistry:a}=this.plugin.app,l=a.typeByExtension[s.extension];if(!l||!a.viewByType[l])return;i=Object.assign(this.buildEphemeralState(s,r),i);const d=this.getDefaultMode(),u=this.buildState(d,i),c=await this.openFile(s,u,o),f=(h=c==null?void 0:c.view)==null?void 0:h.getViewType();if(f==="image"){(p=this.parent)!=null&&p.hasOwnProperty("editorEl")&&this.parent.editorEl.hasClass("is-live-preview")&&(this.waitTime=3e3);const y=c.view.contentEl.querySelector("img");this.hoverEl.dataset.imgHeight=String(y.naturalHeight),this.hoverEl.dataset.imgWidth=String(y.naturalWidth),this.hoverEl.dataset.imgRatio=String(y.naturalWidth/y.naturalHeight)}else f==="pdf"&&(this.hoverEl.style.height="800px",this.hoverEl.style.width="600px");((m=u.state)==null?void 0:m.mode)==="source"&&this.whenShown(()=>{var y,w,v,b;g.requireApiVersion("1.0")&&((v=(w=(y=c==null?void 0:c.view)==null?void 0:y.editMode)==null?void 0:w.reinit)==null||v.call(w)),(b=c==null?void 0:c.view)==null||b.setEphemeralState(u.eState)})}whenShown(t){if(this.detaching)return;const n=this.onShowCallback;this.onShowCallback=()=>{this.detaching||(t(),typeof n=="function"&&n())},this.state===g.PopoverState.Shown&&(this.onShowCallback(),this.onShowCallback=void 0)}async openFile(t,n,i){if(this.detaching)return;const o=i??this.attachLeaf();this.opening=!0;try{await o.openFile(t,n)}catch(s){console.error(s)}finally{this.opening=!1,this.detaching&&this.hide()}return this.plugin.app.workspace.setActiveLeaf(o),o}buildState(t,n){return{active:!1,state:{mode:"source"},eState:n}}buildEphemeralState(t,n){const i=this.plugin.app.metadataCache.getFileCache(t),o=i?g.resolveSubpath(i,(n==null?void 0:n.subpath)||""):void 0,s={subpath:n==null?void 0:n.subpath};return o&&(s.line=o.start.line,s.startLoc=o.start,s.endLoc=o.end||void 0),s}}function Ae(e){return e()}function He(e){e.forEach(Ae)}const at=[],Dt=[],ut=[],Tt=[],Jt=Promise.resolve();let bt=!1;function Be(){bt||(bt=!0,Jt.then(Ye))}function We(){return Be(),Jt}function Ie(e){ut.push(e)}const yt=new Set;let lt=0;function Ye(){do{for(;lt<at.length;){const e=at[lt];lt++,Re(e.$$)}for(at.length=0,lt=0;Dt.length;)Dt.pop()();for(let e=0;e<ut.length;e+=1){const t=ut[e];yt.has(t)||(yt.add(t),t())}ut.length=0}while(at.length);for(;Tt.length;)Tt.pop()();bt=!1,yt.clear()}function Re(e){if(e.fragment!==null){e.update(),He(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Ie)}}const je={root:null,rootMargin:"0px",threshold:0,unobserveOnEnter:!1},N=(e,t)=>new CustomEvent(e,{detail:t});function Xt(e,t={}){const{root:n,rootMargin:i,threshold:o,unobserveOnEnter:s}=Object.assign(Object.assign({},je),t);let r={x:void 0,y:void 0},a={vertical:void 0,horizontal:void 0};if(typeof IntersectionObserver<"u"&&e){const l=new IntersectionObserver((d,u)=>{d.forEach(c=>{r.y>c.boundingClientRect.y?a.vertical="up":a.vertical="down",r.x>c.boundingClientRect.x?a.horizontal="left":a.horizontal="right",r={y:c.boundingClientRect.y,x:c.boundingClientRect.x};const f={inView:c.isIntersecting,entry:c,scrollDirection:a,node:e,observer:u};e.dispatchEvent(N("inview_change",f)),e.dispatchEvent(N("change",f)),c.isIntersecting?(e.dispatchEvent(N("inview_enter",f)),e.dispatchEvent(N("enter",f)),s&&u.unobserve(e)):(e.dispatchEvent(N("inview_leave",f)),e.dispatchEvent(N("leave",f)))})},{root:n,rootMargin:i,threshold:o});return We().then(()=>{e.dispatchEvent(N("inview_init",{observer:l,node:e})),e.dispatchEvent(N("init",{observer:l,node:e}))}),l.observe(e),{destroy(){l.unobserve(e)}}}}function Nt(e){let t,n,i,o,s,r;return{c(){t=M("div"),n=Lt(e[1]),i=H(),o=M("div"),o.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-symlink"><path d="m10 18 3-3-3-3"></path><path d="M14 2v4a2 2 0 0 0 2 2h4"></path><path d="M4 11V4a2 2 0 0 1 2-2h9l5 5v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h7"></path></svg>',_(o,"class","daily-node-icon clickable-icon svelte-18gimyz"),_(o,"aria-hidden","true"),_(t,"class","daily-note-title inline-title svelte-18gimyz")},m(a,l){I(a,t,l),C(t,n),C(t,i),C(t,o),s||(r=q(o,"click",e[3]),s=!0)},p(a,l){l&2&&ve(n,a[1])},d(a){a&&A(t),s=!1,r()}}}function qe(e){let t,n,i,o,s,r,a,l,d,u=e[1]&&Nt(e);return{c(){t=M("div"),n=M("div"),u&&u.c(),i=H(),o=M("div"),s=H(),r=M("div"),_(o,"class","daily-note-editor"),_(o,"aria-label",e[1]),_(n,"class","daily-note svelte-18gimyz"),_(t,"class","daily-note-container"),_(t,"aria-label",a="dn-editor-"+e[2])},m(c,f){I(c,t,f),C(t,n),u&&u.m(n,null),C(n,i),C(n,o),e[8](o),C(t,s),C(t,r),l||(d=[Vt(Xt.call(null,r,{rootMargin:"20%"})),q(r,"inview_enter",e[4])],l=!0)},p(c,[f]){c[1]?u?u.p(c,f):(u=Nt(c),u.c(),u.m(n,i)):u&&(u.d(1),u=null),f&2&&_(o,"aria-label",c[1]),f&4&&a!==(a="dn-editor-"+c[2])&&_(t,"aria-label",a)},i:W,o:W,d(c){c&&A(t),u&&u.d(),e[8](null),l=!1,O(d)}}}function Ve(e,t,n){let{file:i}=t,{plugin:o}=t,{leaf:s}=t,r,a,l=!1,d,u;function c(){i instanceof g.TFile&&(l||(n(1,a=i.basename),[u]=Oe(o,r,s),u.setPinned(!0),u.openFile(i,{active:!1,state:{mode:"source",backlinks:!o.settings.hideBacklinks}}),u.parentLeaf=s,l=!0))}function f(){i instanceof g.TFile&&(s?s.openFile(i):o.app.workspace.getLeaf(!1).openFile(i))}function h(m){const{scrollDirection:y}=m.detail;y.vertical==="down"&&c()}function p(m){ft[m?"unshift":"push"](()=>{r=m,n(0,r)})}return e.$$set=m=>{"file"in m&&n(5,i=m.file),"plugin"in m&&n(6,o=m.plugin),"leaf"in m&&n(7,s=m.leaf)},e.$$.update=()=>{e.$$.dirty&1&&r&&(c(),n(2,d=Kt(8)))},[r,a,d,f,h,i,o,s,p]}class Ue extends Gt{constructor(t){super(),Zt(this,t,Ve,qe,qt,{file:5,plugin:6,leaf:7})}}var k={};Object.defineProperty(k,"__esModule",{value:!0});var S=g;const Et="YYYY-MM-DD",St="gggg-[W]ww",te="YYYY-MM",ee="YYYY-[Q]Q",ne="YYYY";function K(e){var n,i;const t=window.app.plugins.getPlugin("periodic-notes");return t&&((i=(n=t.settings)==null?void 0:n[e])==null?void 0:i.enabled)}function J(){var e,t,n,i;try{const{internalPlugins:o,plugins:s}=window.app;if(K("daily")){const{format:d,folder:u,template:c}=((t=(e=s.getPlugin("periodic-notes"))==null?void 0:e.settings)==null?void 0:t.daily)||{};return{format:d||Et,folder:(u==null?void 0:u.trim())||"",template:(c==null?void 0:c.trim())||""}}const{folder:r,format:a,template:l}=((i=(n=o.getPluginById("daily-notes"))==null?void 0:n.instance)==null?void 0:i.options)||{};return{format:a||Et,folder:(r==null?void 0:r.trim())||"",template:(l==null?void 0:l.trim())||""}}catch{}}function X(){var e,t,n,i,o,s,r;try{const a=window.app.plugins,l=(e=a.getPlugin("calendar"))==null?void 0:e.options,d=(n=(t=a.getPlugin("periodic-notes"))==null?void 0:t.settings)==null?void 0:n.weekly;if(K("weekly"))return{format:d.format||St,folder:((i=d.folder)==null?void 0:i.trim())||"",template:((o=d.template)==null?void 0:o.trim())||""};const u=l||{};return{format:u.weeklyNoteFormat||St,folder:((s=u.weeklyNoteFolder)==null?void 0:s.trim())||"",template:((r=u.weeklyNoteTemplate)==null?void 0:r.trim())||""}}catch{}}function tt(){var t,n,i,o;const e=window.app.plugins;try{const s=K("monthly")&&((n=(t=e.getPlugin("periodic-notes"))==null?void 0:t.settings)==null?void 0:n.monthly)||{};return{format:s.format||te,folder:((i=s.folder)==null?void 0:i.trim())||"",template:((o=s.template)==null?void 0:o.trim())||""}}catch{}}function et(){var t,n,i,o;const e=window.app.plugins;try{const s=K("quarterly")&&((n=(t=e.getPlugin("periodic-notes"))==null?void 0:t.settings)==null?void 0:n.quarterly)||{};return{format:s.format||ee,folder:((i=s.folder)==null?void 0:i.trim())||"",template:((o=s.template)==null?void 0:o.trim())||""}}catch{}}function nt(){var t,n,i,o;const e=window.app.plugins;try{const s=K("yearly")&&((n=(t=e.getPlugin("periodic-notes"))==null?void 0:t.settings)==null?void 0:n.yearly)||{};return{format:s.format||ne,folder:((i=s.folder)==null?void 0:i.trim())||"",template:((o=s.template)==null?void 0:o.trim())||""}}catch{}}function ie(...e){let t=[];for(let i=0,o=e.length;i<o;i++)t=t.concat(e[i].split("/"));const n=[];for(let i=0,o=t.length;i<o;i++){const s=t[i];!s||s==="."||n.push(s)}return t[0]===""&&n.unshift(""),n.join("/")}function ze(e){let t=e.substring(e.lastIndexOf("/")+1);return t.lastIndexOf(".")!=-1&&(t=t.substring(0,t.lastIndexOf("."))),t}async function Qe(e){const t=e.replace(/\\/g,"/").split("/");if(t.pop(),t.length){const n=ie(...t);window.app.vault.getAbstractFileByPath(n)||await window.app.vault.createFolder(n)}}async function it(e,t){t.endsWith(".md")||(t+=".md");const n=S.normalizePath(ie(e,t));return await Qe(n),n}async function U(e){const{metadataCache:t,vault:n}=window.app,i=S.normalizePath(e);if(i==="/")return Promise.resolve(["",null]);try{const o=t.getFirstLinkpathDest(i,""),s=await n.cachedRead(o),r=window.app.foldManager.load(o);return[s,r]}catch(o){return console.error(`Failed to read the daily note template '${i}'`,o),new S.Notice("Failed to read the daily note template"),["",null]}}function D(e,t="day"){const n=e.clone().startOf(t).format();return`${t}-${n}`}function oe(e){return e.replace(/\[[^\]]*\]/g,"")}function Ze(e,t){if(t==="week"){const n=oe(e);return/w{1,2}/i.test(n)&&(/M{1,4}/.test(n)||/D{1,4}/.test(n))}return!1}function z(e,t){return se(e.basename,t)}function Ge(e,t){return se(ze(e),t)}function se(e,t){const i={day:J,week:X,month:tt,quarter:et,year:nt}[t]().format.split("/").pop(),o=window.moment(e,i,!0);if(!o.isValid())return null;if(Ze(i,t)&&t==="week"){const s=oe(i);if(/w{1,2}/i.test(s))return window.moment(e,i.replace(/M{1,4}/g,"").replace(/D{1,4}/g,""),!1)}return o}class Ke extends Error{}async function re(e){const t=window.app,{vault:n}=t,i=window.moment,{template:o,format:s,folder:r}=J(),[a,l]=await U(o),d=e.format(s),u=await it(r,d);try{const c=await n.create(u,a.replace(/{{\s*date\s*}}/gi,d).replace(/{{\s*time\s*}}/gi,i().format("HH:mm")).replace(/{{\s*title\s*}}/gi,d).replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(f,h,p,m,y,w)=>{const v=i(),b=e.clone().set({hour:v.get("hour"),minute:v.get("minute"),second:v.get("second")});return p&&b.add(parseInt(m,10),y),w?b.format(w.substring(1).trim()):b.format(s)}).replace(/{{\s*yesterday\s*}}/gi,e.clone().subtract(1,"day").format(s)).replace(/{{\s*tomorrow\s*}}/gi,e.clone().add(1,"d").format(s)));return t.foldManager.save(c,l),c}catch(c){console.error(`Failed to create file: '${u}'`,c),new S.Notice("Unable to create new file.")}}function Je(e,t){return t[D(e,"day")]??null}function Xe(){const{vault:e}=window.app,{folder:t}=J(),n=e.getAbstractFileByPath(S.normalizePath(t));if(!n)throw new Ke("Failed to find daily notes folder");const i={};return S.Vault.recurseChildren(n,o=>{if(o instanceof S.TFile){const s=z(o,"day");if(s){const r=D(s,"day");i[r]=o}}}),i}class tn extends Error{}function en(){const{moment:e}=window;let t=e.localeData()._week.dow;const n=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];for(;t;)n.push(n.shift()),t--;return n}function nn(e){return en().indexOf(e.toLowerCase())}async function ae(e){const{vault:t}=window.app,{template:n,format:i,folder:o}=X(),[s,r]=await U(n),a=e.format(i),l=await it(o,a);try{const d=await t.create(l,s.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(u,c,f,h,p,m)=>{const y=window.moment(),w=e.clone().set({hour:y.get("hour"),minute:y.get("minute"),second:y.get("second")});return f&&w.add(parseInt(h,10),p),m?w.format(m.substring(1).trim()):w.format(i)}).replace(/{{\s*title\s*}}/gi,a).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*(sunday|monday|tuesday|wednesday|thursday|friday|saturday)\s*:(.*?)}}/gi,(u,c,f)=>{const h=nn(c);return e.weekday(h).format(f.trim())}));return window.app.foldManager.save(d,r),d}catch(d){console.error(`Failed to create file: '${l}'`,d),new S.Notice("Unable to create new file.")}}function on(e,t){return t[D(e,"week")]??null}function sn(){const e={};if(!ce())return e;const{vault:t}=window.app,{folder:n}=X(),i=t.getAbstractFileByPath(S.normalizePath(n));if(!i)throw new tn("Failed to find weekly notes folder");return S.Vault.recurseChildren(i,o=>{if(o instanceof S.TFile){const s=z(o,"week");if(s){const r=D(s,"week");e[r]=o}}}),e}class rn extends Error{}async function le(e){const{vault:t}=window.app,{template:n,format:i,folder:o}=tt(),[s,r]=await U(n),a=e.format(i),l=await it(o,a);try{const d=await t.create(l,s.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(u,c,f,h,p,m)=>{const y=window.moment(),w=e.clone().set({hour:y.get("hour"),minute:y.get("minute"),second:y.get("second")});return f&&w.add(parseInt(h,10),p),m?w.format(m.substring(1).trim()):w.format(i)}).replace(/{{\s*date\s*}}/gi,a).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,a));return window.app.foldManager.save(d,r),d}catch(d){console.error(`Failed to create file: '${l}'`,d),new S.Notice("Unable to create new file.")}}function an(e,t){return t[D(e,"month")]??null}function ln(){const e={};if(!de())return e;const{vault:t}=window.app,{folder:n}=tt(),i=t.getAbstractFileByPath(S.normalizePath(n));if(!i)throw new rn("Failed to find monthly notes folder");return S.Vault.recurseChildren(i,o=>{if(o instanceof S.TFile){const s=z(o,"month");if(s){const r=D(s,"month");e[r]=o}}}),e}class cn extends Error{}async function dn(e){const{vault:t}=window.app,{template:n,format:i,folder:o}=et(),[s,r]=await U(n),a=e.format(i),l=await it(o,a);try{const d=await t.create(l,s.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(u,c,f,h,p,m)=>{const y=window.moment(),w=e.clone().set({hour:y.get("hour"),minute:y.get("minute"),second:y.get("second")});return f&&w.add(parseInt(h,10),p),m?w.format(m.substring(1).trim()):w.format(i)}).replace(/{{\s*date\s*}}/gi,a).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,a));return window.app.foldManager.save(d,r),d}catch(d){console.error(`Failed to create file: '${l}'`,d),new S.Notice("Unable to create new file.")}}function un(e,t){return t[D(e,"quarter")]??null}function fn(){const e={};if(!ue())return e;const{vault:t}=window.app,{folder:n}=et(),i=t.getAbstractFileByPath(S.normalizePath(n));if(!i)throw new cn("Failed to find quarterly notes folder");return S.Vault.recurseChildren(i,o=>{if(o instanceof S.TFile){const s=z(o,"quarter");if(s){const r=D(s,"quarter");e[r]=o}}}),e}class hn extends Error{}async function pn(e){const{vault:t}=window.app,{template:n,format:i,folder:o}=nt(),[s,r]=await U(n),a=e.format(i),l=await it(o,a);try{const d=await t.create(l,s.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(u,c,f,h,p,m)=>{const y=window.moment(),w=e.clone().set({hour:y.get("hour"),minute:y.get("minute"),second:y.get("second")});return f&&w.add(parseInt(h,10),p),m?w.format(m.substring(1).trim()):w.format(i)}).replace(/{{\s*date\s*}}/gi,a).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,a));return window.app.foldManager.save(d,r),d}catch(d){console.error(`Failed to create file: '${l}'`,d),new S.Notice("Unable to create new file.")}}function gn(e,t){return t[D(e,"year")]??null}function wn(){const e={};if(!fe())return e;const{vault:t}=window.app,{folder:n}=nt(),i=t.getAbstractFileByPath(S.normalizePath(n));if(!i)throw new hn("Failed to find yearly notes folder");return S.Vault.recurseChildren(i,o=>{if(o instanceof S.TFile){const s=z(o,"year");if(s){const r=D(s,"year");e[r]=o}}}),e}function mn(){var i,o;const{app:e}=window,t=e.internalPlugins.plugins["daily-notes"];if(t&&t.enabled)return!0;const n=e.plugins.getPlugin("periodic-notes");return n&&((o=(i=n.settings)==null?void 0:i.daily)==null?void 0:o.enabled)}function ce(){var n,i;const{app:e}=window;if(e.plugins.getPlugin("calendar"))return!0;const t=e.plugins.getPlugin("periodic-notes");return t&&((i=(n=t.settings)==null?void 0:n.weekly)==null?void 0:i.enabled)}function de(){var n,i;const{app:e}=window,t=e.plugins.getPlugin("periodic-notes");return t&&((i=(n=t.settings)==null?void 0:n.monthly)==null?void 0:i.enabled)}function ue(){var n,i;const{app:e}=window,t=e.plugins.getPlugin("periodic-notes");return t&&((i=(n=t.settings)==null?void 0:n.quarterly)==null?void 0:i.enabled)}function fe(){var n,i;const{app:e}=window,t=e.plugins.getPlugin("periodic-notes");return t&&((i=(n=t.settings)==null?void 0:n.yearly)==null?void 0:i.enabled)}function yn(e){const t={day:J,week:X,month:tt,quarter:et,year:nt}[e];return t()}function vn(e,t){return{day:re,month:le,week:ae}[e](t)}var Ot=k.DEFAULT_DAILY_NOTE_FORMAT=Et;k.DEFAULT_MONTHLY_NOTE_FORMAT=te;k.DEFAULT_QUARTERLY_NOTE_FORMAT=ee;k.DEFAULT_WEEKLY_NOTE_FORMAT=St;k.DEFAULT_YEARLY_NOTE_FORMAT=ne;k.appHasDailyNotesPluginLoaded=mn;k.appHasMonthlyNotesPluginLoaded=de;k.appHasQuarterlyNotesPluginLoaded=ue;k.appHasWeeklyNotesPluginLoaded=ce;k.appHasYearlyNotesPluginLoaded=fe;var kn=k.createDailyNote=re;k.createMonthlyNote=le;k.createPeriodicNote=vn;k.createQuarterlyNote=dn;k.createWeeklyNote=ae;k.createYearlyNote=pn;var bn=k.getAllDailyNotes=Xe;k.getAllMonthlyNotes=ln;k.getAllQuarterlyNotes=fn;k.getAllWeeklyNotes=sn;k.getAllYearlyNotes=wn;var En=k.getDailyNote=Je,At=k.getDailyNoteSettings=J,Ht=k.getDateFromFile=z;k.getDateFromPath=Ge;k.getDateUID=D;k.getMonthlyNote=an;k.getMonthlyNoteSettings=tt;k.getPeriodicNoteSettings=yn;k.getQuarterlyNote=un;k.getQuarterlyNoteSettings=et;k.getTemplateInfo=U;k.getWeeklyNote=on;k.getWeeklyNoteSettings=X;k.getYearlyNote=gn;k.getYearlyNoteSettings=nt;function Bt(e,t,n){const i=e.slice();return i[23]=t[n],i}function Wt(e){let t;return{c(){t=M("div"),_(t,"class","dn-stock svelte-16g9gs")},m(n,i){I(n,t,i)},d(n){n&&A(t)}}}function It(e){let t,n,i;return{c(){t=M("div"),t.innerHTML='<div class="dn-blank-day-text svelte-16g9gs">Create a daily note for today ✍</div>',_(t,"class","dn-blank-day svelte-16g9gs"),_(t,"aria-hidden","true")},m(o,s){I(o,t,s),n||(i=q(t,"click",e[6]),n=!0)},p:W,d(o){o&&A(t),n=!1,i()}}}function Yt(e,t){let n,i,o;return i=new Ue({props:{file:t[23],plugin:t[0],leaf:t[1]}}),{key:e,first:null,c(){n=me(),Fe(i.$$.fragment),this.first=n},m(s,r){I(s,n,r),zt(i,s,r),o=!0},p(s,r){t=s;const a={};r&8&&(a.file=t[23]),r&1&&(a.plugin=t[0]),r&2&&(a.leaf=t[1]),i.$set(a)},i(s){o||(pt(i.$$.fragment,s),o=!0)},o(s){_t(i.$$.fragment,s),o=!1},d(s){s&&A(n),Qt(i,s)}}}function Rt(e){let t;return{c(){t=M("div"),t.textContent="—— No more of results ——",_(t,"class","no-more-text svelte-16g9gs")},m(n,i){I(n,t,i)},d(n){n&&A(t)}}}function Sn(e){let t,n,i,o=[],s=new Map,r,a,l,d,u,c,f,h=e[3].length===0&&Wt(),p=!e[4]&&It(e),m=Ft(e[3]);const y=v=>v[23];for(let v=0;v<m.length;v+=1){let b=Bt(e,m,v),x=y(b);s.set(x,o[v]=Yt(x,b))}let w=!e[2]&&Rt();return{c(){t=M("div"),h&&h.c(),n=H(),p&&p.c(),i=H();for(let v=0;v<o.length;v+=1)o[v].c();r=H(),a=M("div"),d=H(),w&&w.c(),_(a,"class","dn-view-loader"),_(t,"class","daily-note-view")},m(v,b){I(v,t,b),h&&h.m(t,null),C(t,n),p&&p.m(t,null),C(t,i);for(let x=0;x<o.length;x+=1)o[x]&&o[x].m(t,null);C(t,r),C(t,a),e[17](a),C(t,d),w&&w.m(t,null),u=!0,c||(f=[Vt(l=Xt.call(null,a,{root:e[1].view.containerEl})),q(a,"inview_init",e[7]),q(a,"inview_change",e[9]),q(a,"inview_leave",e[8])],c=!0)},p(v,[b]){v[3].length===0?h||(h=Wt(),h.c(),h.m(t,n)):h&&(h.d(1),h=null),v[4]?p&&(p.d(1),p=null):p?p.p(v,b):(p=It(v),p.c(),p.m(t,i)),b&11&&(m=Ft(v[3]),$e(),o=Pe(o,b,y,1,v,m,s,t,xe,Yt,r,Bt),Ce()),l&&ht(l.update)&&b&2&&l.update.call(null,{root:v[1].view.containerEl}),v[2]?w&&(w.d(1),w=null):w||(w=Rt(),w.c(),w.m(t,null))},i(v){if(!u){for(let b=0;b<m.length;b+=1)pt(o[b]);u=!0}},o(v){for(let b=0;b<o.length;b+=1)_t(o[b]);u=!1},d(v){v&&A(t),h&&h.d(),p&&p.d();for(let b=0;b<o.length;b+=1)o[b].d();e[17](null),w&&w.d(),c=!1,O(f)}}}const Ln=1;function _n(e,t,n){let{plugin:i}=t,{leaf:o}=t,s,r,a=[],l=[],d=!0,u=!1,c=!0,f=!0,h;be(()=>{p(),y()});function p(){const E=g.moment();En(E,r)||n(4,c=!1)}function m(){return Te(this,void 0,void 0,function*(){const E=g.moment();if(!c){const $=yield kn(E);l.push($),n(3,l=T(l)),n(4,c=!0)}})}function y(){s||(s=setInterval(v,1))}function w(){clearInterval(s),s=null}function v(){!u||!d||(a.length===0&&u?n(2,d=!1):(n(3,l=[...l,...a.splice(0,Ln)]),f&&window.setTimeout(()=>{b(),f=!1},100)))}function b(){h&&h.getBoundingClientRect().top<o.view.contentEl.innerHeight&&v()}function x(){n(3,l)}function ot(){p()}function T(E){const $=At().format||Ot;return E.sort((st,gt)=>g.moment(gt.basename,$).valueOf()-g.moment(st.basename,$).valueOf())}function L(E){const $=Ht(E,"day"),st=At().format||Ot;if(!$)return;if(l.length===0){a.push(E),n(15,a=T(a));return}const gt=l[l.length-1],he=l[0],$t=g.moment(gt.basename,st),Ct=g.moment(he.basename,st);$.isBetween($t,Ct)?(l.push(E),n(3,l=T(l))):$.isBefore($t)?(a.push(E),n(15,a=T(a))):$.isAfter(Ct)&&(l.push(E),n(3,l=T(l))),$.isSame(g.moment(),"day")&&n(4,c=!0)}function P(E){Ht(E,"day")&&(n(3,l=l.filter($=>$.basename!==E.basename)),n(15,a=a.filter($=>$.basename!==E.basename)),p())}function F(E){ft[E?"unshift":"push"](()=>{h=E,n(5,h)})}return e.$$set=E=>{"plugin"in E&&n(0,i=E.plugin),"leaf"in E&&n(1,o=E.leaf)},e.$$.update=()=>{if(e.$$.dirty&114692&&d&&!u){n(14,r=bn());for(const E of Object.keys(r).sort().reverse())a.push(r[E]);n(16,u=!0),p()}},[i,o,d,l,c,h,m,y,w,v,x,ot,L,P,r,a,u,F]}class $n extends Gt{constructor(t){super(),Zt(this,t,_n,Sn,qt,{plugin:0,leaf:1,tick:10,check:11,fileCreate:12,fileDelete:13})}get tick(){return this.$$.ctx[10]}get check(){return this.$$.ctx[11]}get fileCreate(){return this.$$.ctx[12]}get fileDelete(){return this.$$.ctx[13]}}function ct(e,t){const n=Object.keys(t).map(i=>Cn(e,i,t[i]));return n.length===1?n[0]:function(){n.forEach(i=>i())}}function Cn(e,t,n){const i=e[t],o=e.hasOwnProperty(t);let s=n(i);return i&&Object.setPrototypeOf(s,i),Object.setPrototypeOf(r,s),e[t]=r,a;function r(...l){return s===i&&e[t]===r&&a(),s.apply(this,l)}function a(){e[t]===r&&(o?e[t]=i:delete e[t]),s!==i&&(s=i,Object.setPrototypeOf(r,i||Function))}}const xn=()=>{g.addIcon("daily-note",'<svg width="103" height="134" viewBox="0 0 103 134" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M60.3446 21.848H22.5577C19.5764 21.848 17.1595 24.2648 17.1595 27.2462V65.0331C17.1595 68.0144 19.5764 70.4312 22.5577 70.4312H60.3446C63.3259 70.4312 65.7428 68.0144 65.7428 65.0331V27.2462C65.7428 24.2648 63.3259 21.848 60.3446 21.848Z" stroke="#5C1111" stroke-width="4.81618" stroke-linecap="round" stroke-linejoin="round"/><path d="M52.2476 16.4498V27.2461" stroke="#5C1111" stroke-width="4.81618" stroke-linecap="round" stroke-linejoin="round"/><path d="M30.655 16.4498V27.2461" stroke="#5C1111" stroke-width="4.81618" stroke-linecap="round" stroke-linejoin="round"/><path d="M17.1595 38.0424H65.7428" stroke="#5C1111" stroke-width="4.81618" stroke-linecap="round" stroke-linejoin="round"/><path d="M33.3541 54.2366L38.7523 59.6348L49.5485 48.8385" stroke="#5C1111" stroke-width="4.81618" stroke-linecap="round" stroke-linejoin="round"/><g filter="url(#filter0_ddddd_104_2)"><path d="M12.181 103.617L9.21851 95.8213L27.9292 87.0896L66.754 71.4973L93.1049 88.8047L91.3898 103.617H12.181Z" fill="#AC4DD9" stroke="black" stroke-width="0.963236"/><path d="M12.181 103.617L9.21851 95.9771L27.9292 87.0895L32.6069 103.461L12.181 103.617Z" fill="#540D75" stroke="black" stroke-width="0.963236"/><path d="M9.0625 95.6652L25.7894 67.212L27.9291 87.0894L9.21842 95.977L9.0625 95.6652Z" fill="#470068" stroke="black" stroke-width="0.481618"/><path d="M27.9291 87.0896L25.9021 66.8197L67.5335 56.2169L66.5979 71.4973L27.9291 87.0896Z" fill="#732E94" stroke="black" stroke-width="0.963236"/><path d="M66.598 71.4971L67.9466 56.3527L93.1049 88.8045L66.598 71.4971Z" fill="#C279E4" stroke="black" stroke-width="0.481618"/><path d="M9.0625 95.6652L25.7462 66.8195L67.9465 56.0808L93.1049 88.8046L66.598 71.4972L27.9291 87.0895L9.21842 95.9771L9.0625 95.6652Z" stroke="black" stroke-width="0.963236"/><path d="M26.0579 103.617L27.9289 87.0895L32.7625 103.617H26.0579Z" fill="#61018E" stroke="black" stroke-width="0.963236"/></g><defs><filter id="filter0_ddddd_104_2" x="0.0874329" y="53.8502" width="101.958" height="79.8707" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset/><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"/><feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_104_2"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset dy="1.20405"/><feGaussianBlur stdDeviation="1.44485"/><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"/><feBlend mode="normal" in2="effect1_dropShadow_104_2" result="effect2_dropShadow_104_2"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset dy="5.2978"/><feGaussianBlur stdDeviation="2.6489"/><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.09 0"/><feBlend mode="normal" in2="effect2_dropShadow_104_2" result="effect3_dropShadow_104_2"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset dy="11.7996"/><feGaussianBlur stdDeviation="3.61213"/><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.05 0"/><feBlend mode="normal" in2="effect3_dropShadow_104_2" result="effect4_dropShadow_104_2"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset dy="21.1912"/><feGaussianBlur stdDeviation="4.21416"/><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.01 0"/><feBlend mode="normal" in2="effect4_dropShadow_104_2" result="effect5_dropShadow_104_2"/><feBlend mode="normal" in="SourceGraphic" in2="effect5_dropShadow_104_2" result="shape"/></filter></defs></svg>')},Pn={hideFrontmatter:!1,hideBacklinks:!1};class Fn extends g.PluginSettingTab{constructor(t,n){super(t,n),this.debounceApplySettingsUpdate=g.debounce(async()=>{await this.plugin.saveSettings()},200,!0),this.debounceDisplay=g.debounce(async()=>{await this.display()},400,!0),this.plugin=n}applySettingsUpdate(){this.debounceApplySettingsUpdate()}async display(){await this.plugin.loadSettings();const{containerEl:t}=this,n=this.plugin.settings;t.toggleClass("daily-note-settings-container",!0),t.empty(),new g.Setting(t).setName("Hide frontmatter").setDesc("Hide frontmatter in daily notes").addToggle(i=>i.setValue(n.hideFrontmatter).onChange(async o=>{this.plugin.settings.hideFrontmatter=o,document.body.classList.toggle("daily-notes-hide-frontmatter",o),this.applySettingsUpdate()})),new g.Setting(t).setName("Hide backlinks").setDesc("Hide backlinks in daily notes").addToggle(i=>i.setValue(n.hideBacklinks).onChange(async o=>{this.plugin.settings.hideBacklinks=o,document.body.classList.toggle("daily-notes-hide-backlinks",o),this.applySettingsUpdate()}))}}const j="daily-note-editor-view";function Mn(e){return e.containerEl.matches(".dn-leaf-view")}class Dn extends g.ItemView{constructor(t,n){super(t),this.onFileCreate=i=>{i instanceof g.TFile&&this.view.fileCreate(i)},this.onFileDelete=i=>{i instanceof g.TFile&&this.view.fileDelete(i)},this.plugin=n,this.scope=new g.Scope(n.app.scope)}getViewType(){return j}getDisplayText(){return"Daily Note"}getIcon(){return"daily-note"}async onOpen(){this.scope.register(["Mod"],"f",t=>{}),this.view=new $n({target:this.contentEl,props:{plugin:this.plugin,leaf:this.leaf}}),this.app.vault.on("create",this.onFileCreate),this.app.vault.on("delete",this.onFileDelete),this.app.workspace.onLayoutReady(this.view.tick.bind(this)),this.registerInterval(window.setInterval(async()=>{this.view.check()},1e3*60*60))}}class Tn extends g.Plugin{async onload(){this.addSettingTab(new Fn(this.app,this)),await this.loadSettings(),this.patchWorkspace(),this.patchWorkspaceLeaf(),xn(),this.registerView(j,t=>this.view=new Dn(t,this)),this.addRibbonIcon("calendar-range","Open Daily Note Editor",t=>this.openDailyNoteEditor()),this.addCommand({id:"open-daily-note-editor",name:"Open Daily Note Editor",callback:()=>this.openDailyNoteEditor()}),this.initCssRules()}onunload(){this.app.workspace.detachLeavesOfType(j),document.body.toggleClass("daily-notes-hide-frontmatter",!1),document.body.toggleClass("daily-notes-hide-backlinks",!1)}async openDailyNoteEditor(){const t=this.app.workspace;t.detachLeavesOfType(j);const n=t.getLeaf(!0);await n.setViewState({type:j}),t.revealLeaf(n)}initCssRules(){document.body.toggleClass("daily-notes-hide-frontmatter",this.settings.hideFrontmatter),document.body.toggleClass("daily-notes-hide-backlinks",this.settings.hideBacklinks)}patchWorkspace(){let t=!1;const n=ct(g.Workspace.prototype,{changeLayout(i){return async function(o){t=!0;try{await i.call(this,o)}finally{t=!1}}},iterateLeaves(i){return function(o,s){if(i.call(this,o,s))return!0;const r=typeof o=="function"?o:s,a=typeof o=="function"?s:o;if(!a||t)return!1;if(a===app.workspace.rootSplit||g.WorkspaceContainer&&a instanceof g.WorkspaceContainer){for(const l of G.popoversForWindow(a.win))if(i.call(this,r,l.rootSplit))return!0}return!1}},setActiveLeaf:i=>function(o,s){if(o.parentLeaf){o.parentLeaf.activeTime=17e11,i.call(this,o.parentLeaf,s),o.view.editMode&&(this.activeEditor=o.view);return}i.call(this,o,s)},onDragLeaf(i){return function(o,s){return i.call(this,o,s)}}});this.register(n)}patchWorkspaceLeaf(){this.register(ct(g.WorkspaceLeaf.prototype,{getRoot(t){return function(){const n=t.call(this);return(n==null?void 0:n.getRoot)===this.getRoot?n:n==null?void 0:n.getRoot()}},setPinned(t){return function(n){t.call(this,n),Mt(this)&&!n&&this.setPinned(!0)}},openFile(t){return function(n,i){if(Mt(this)){setTimeout(ct(g.Workspace.prototype,{recordMostRecentOpenedFile(s){return function(r){if(r!==n)return s.call(this,r)}}}),1);const o=this.app.plugins.plugins["recent-files-obsidian"];o&&setTimeout(ct(o,{shouldAddFile(s){return function(r){return r!==n&&s.call(this,r)}}}),1)}return t.call(this,n,i)}}}))}async loadSettings(){this.settings=Object.assign({},Pn,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}}exports.DAILY_NOTE_VIEW_TYPE=j;exports.default=Tn;exports.isEmebeddedLeaf=Mn;

/* nosourcemap */